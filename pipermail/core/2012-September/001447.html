<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> opam 'remove' not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20opam%20%27remove%27%20not%20working&In-Reply-To=%3CD39C31F4-935D-4B07-AA0E-82063E16B2FC%40ocamlpro.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001446.html">
   <LINK REL="Next"  HREF="001448.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>opam 'remove' not working</H1>
    <B>Thomas Gazagnaire</B> 
    <A HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20opam%20%27remove%27%20not%20working&In-Reply-To=%3CD39C31F4-935D-4B07-AA0E-82063E16B2FC%40ocamlpro.com%3E"
       TITLE="opam 'remove' not working">thomas.gazagnaire at gmail.com
       </A><BR>
    <I>Mon Sep 17 21:47:44 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001446.html">opam 'remove' not working
</A></li>
        <LI>Next message: <A HREF="001448.html">opam 'remove' not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1447">[ date ]</a>
              <a href="thread.html#1447">[ thread ]</a>
              <a href="subject.html#1447">[ subject ]</a>
              <a href="author.html#1447">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> Alas, if for any reason OPAM gets out of sync with OCamlfind, you need to manually rectify it.
</I>&gt;<i> 
</I>&gt;<i> Ocamlfind refuses to install over an existing installation...
</I>&gt;<i> 
</I>&gt;<i> This shouldn't happen in normal practise, but of course, packaging bugs happen.
</I>
exactly. One way to solve your problem is to tell ocamlfind that indeed core needs to be uninstalled (ie. ocamlfind remove core). But I guess opam should double-check that a package files are properly indeed really removed when you try to run 'opam remove &lt;foo&gt;'.  I'm tracking this issue in <A HREF="https://github.com/OCamlPro/opam/issues/162,">https://github.com/OCamlPro/opam/issues/162,</A> feel free to comment if you have any idea.

--
Thomas


&gt;<i> 
</I>&gt;<i> -anil
</I>&gt;<i> 
</I>&gt;<i> On 17 Sep 2012, at 14:43, Sean McLaughlin &lt;<A HREF="http://lists.ocaml.org/listinfo/core">seanmcl at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> PS: I know it's 'opam remove' that is not working, because even after doing 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>   opam remove core
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I can do
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> $ ocaml
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i> # #require &quot;core&quot;;;
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> and it loads the old cma file.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On Mon, Sep 17, 2012 at 2:40 PM, Sean McLaughlin &lt;<A HREF="http://lists.ocaml.org/listinfo/core">seanmcl at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I'm trying to work on core, and am having some trouble with opam.  I downloaded the latest tarball 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>   ocaml-core-108.07.00
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> and everything compiled fine.  Then I edited some code in 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>   ocaml-core-108.07.00/core-108.07.00/lib
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> and ran 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>   /usr/local/src/ocaml-core-108.07.00/core-108.07.00
</I>&gt;&gt;<i>   $ ocaml setup.ml -build
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> which completed fine. Then I tried to install, but got the following error
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> $ ocaml setup.ml -install
</I>&gt;&gt;<i> ocamlfind: Package core is already installed
</I>&gt;&gt;<i>  - (file /Users/seanmcl/.opam/4.00.0/lib/core/META already exists)
</I>&gt;&gt;<i> E: Failure(&quot;Command ''/Users/seanmcl/.opam/4.00.0/bin/ocamlfind' install core lib/META _build/top/core_install_printers.cmx _build/top/core_install_printers.cmi _build/top/core_top.cmxs _build/top/core_top.a _build/top/core_top.cmxa _build/top/core_top.cma top/core_install_printers.ml _build/lib/core.cmxs _build/lib/core.a _build/lib/core.cmxa _build/lib/core.cma _build/lib/core.cmi _build/lib/dllcore_stubs.so _build/lib/libcore_stubs.a lib/zone.mli lib/word_size.mli lib/with_return.mli lib/weekday.mli lib/unpack_buffer.mli lib/univ_map.mli lib/univ.mli lib/unit.mli lib/unique_id_intf.ml lib/unique_id.mli lib/union_find.mli lib/tuple.mli lib/timer.mli lib/time_internal.ml lib/time.mli lib/thread_safe_queue.mli lib/t.ml lib/sys_open_patch.mli lib/substring_intf.ml lib/substring.mli lib/string_id.mli lib/stringable.ml lib/std_internal.ml lib/std.ml lib/staged.mli lib/stable_unit_test_intf.ml lib/stable_unit_test.mli lib/stable_internal.ml lib/stable_containers.mli lib/stable.ml lib/squeue.mli lib/span.mli lib/space_safe_tuple.mli lib/source_code_position.mli lib/signal.mli lib/sexpable.ml lib/set_once.mli lib/robustly_comparable.ml lib/result.mli lib/ref.mli lib/quickcheck.mli lib/pretty_printer.mli lib/polymorphic_compare_intf.ml lib/polymorphic_compare.mli lib/piecewise_linear.mli lib/pid.mli lib/out_channel.mli lib/or_error.mli lib/ordered_collection_common.mli lib/option.mli lib/only_in_test.mli lib/ofday_unit_tests_v1.mli lib/ofday.mli lib/no_polymorphic_compare.mli lib/nano_mutex.mli lib/mutex0.ml lib/month.mli lib/monad.ml lib/memo.mli lib/make_substring.ml lib/lock_file.mli lib/linux_ext.mli lib/int_set.mli lib/int_replace_polymorphic_compare.mli lib/int_intf.ml lib/interval_intf.ml lib/interval.mli lib/interfaces.ml lib/int_conversions.ml lib/intable.ml lib/inline_tests.ml lib/info.mli lib/in_channel.mli lib/identifiable.mli lib/host_and_port.mli lib/heap.mli lib/hash_set_intf.ml lib/hash_set.mli lib/hash_queue.ml lib/hash_heap.ml lib/hashable.ml lib/fqueue.mli lib/force_once.mli lib/fn.mli lib/float_robust_compare.mli lib/float_intf.ml lib/floatable.ml lib/float.mli lib/exn.mli lib/error.mli lib/doubly_linked.mli lib/dequeue.mli lib/date.mli lib/daemon.mli lib/crc.mli lib/core_unix.mli lib/core_thread.mli lib/core_sys.mli lib/core_string.mli lib/core_stack.mli lib/core_sexp.mli lib/core_set_unit_tests.mli lib/core_set_intf.ml lib/core_set.mli lib/core_random.mli lib/core_queue.mli lib/core_printf.mli lib/core_printexc.mli lib/core_nativeint.mli lib/core_mutex.mli lib/core_map_unit_tests.mli lib/core_map_intf.ml lib/core_map.mli lib/core_list.mli lib/core_lazy.mli lib/core_int64.mli lib/core_int63.mli lib/core_int32.mli lib/core_int.mli lib/core_hashtbl_intf.ml lib/core_hashtbl.mli lib/core_gc.mli lib/core_filename.mli lib/core_field.ml lib/core_condition.mli lib/core_char.mli lib/core_bin_prot.ml lib/core_array.mli lib/core_arg.mli lib/container.ml lib/constrained_float.ml lib/comparator.mli lib/comparable.ml lib/commutative_group.ml lib/common0.ml lib/common.mli lib/command.mli lib/caml.ml lib/byte_units.mli lib/bucket.ml lib/bounded_int_table.mli lib/bool.mli lib/blang.mli lib/binary_packing.mli lib/binable0.ml lib/binable.mli lib/bigsubstring.mli lib/bigstring_marshal.mli lib/bigstring.mli lib/bigbuffer.mli lib/bag.mli lib/backtrace.mli lib/avltree.mli lib/array_permute.ml' terminated with error code 2&quot;)
</I>&gt;&gt;<i> EXIT STATUS 1
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I tried doing 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>   opam remove core 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> which completed without error.  But the files are not removed from 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>   .opam/4.00.0/lib/core
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> and the -install step still complains that there's an existing META file and refuses to install itself.  
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Please let me know what I'm doing wrong.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Sean
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Is there an opam mailing list yet so I don't spam the wrong ocamlpro guys?
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001446.html">opam 'remove' not working
</A></li>
	<LI>Next message: <A HREF="001448.html">opam 'remove' not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1447">[ date ]</a>
              <a href="thread.html#1447">[ thread ]</a>
              <a href="subject.html#1447">[ subject ]</a>
              <a href="author.html#1447">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/core">More information about the core
mailing list</a><br>
</body></html>
