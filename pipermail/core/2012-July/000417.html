<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Erlang-like Gen server using Async
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20Erlang-like%20Gen%20server%20using%20Async&In-Reply-To=%3CCAAHaHtniNpwQX%3DsEvEaQ96pWWbf2W%3D_t-%3DyCLp5uyXiaMKCm%3DQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001316.html">
   <LINK REL="Next"  HREF="001305.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Erlang-like Gen server using Async</H1>
    <B>orbitz</B> 
    <A HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20Erlang-like%20Gen%20server%20using%20Async&In-Reply-To=%3CCAAHaHtniNpwQX%3DsEvEaQ96pWWbf2W%3D_t-%3DyCLp5uyXiaMKCm%3DQ%40mail.gmail.com%3E"
       TITLE="Erlang-like Gen server using Async">orbitz at gmail.com
       </A><BR>
    <I>Mon Jul  2 21:05:09 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001316.html">[was: [Caml-list] [ANN] oasis v0.3.0: Architecture for building OCaml libraries and applications] Pb with type_conv
</A></li>
        <LI>Next message: <A HREF="001305.html">Erlang-like Gen server using Async
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#417">[ date ]</a>
              <a href="thread.html#417">[ thread ]</a>
              <a href="subject.html#417">[ subject ]</a>
              <a href="author.html#417">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello!

I implemented an Erlang-like gen server in Async and was hoping someone
familiar with Core might provide some feedback.  Is the code good?  Is the
idea good?

The code is here:
<A HREF="https://github.com/orbitz/web_typed/blob/master/libs/ort_async/gen_server.ml">https://github.com/orbitz/web_typed/blob/master/libs/ort_async/gen_server.ml</A>

And an example is here:
<A HREF="https://github.com/orbitz/web_typed/blob/master/libs/ort_async/gen_server_test.ml">https://github.com/orbitz/web_typed/blob/master/libs/ort_async/gen_server_test.ml</A>

One thing that I do not like about this is the init function.  The problem
is:
I want the init function to get a reference to itself so it can create
other services and give itself to that service.  The problem is, the type
that represents the server doesn't exist when the init function is defined
so I can't pass it a value.  Instead I pass it the server stream and exited
Ivar, but that is rather ugly since it really breaks the abstraction.  Any
suggestions?

Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ocaml.org/pipermail/core/attachments/20120702/e715a233/attachment.html">http://lists.ocaml.org/pipermail/core/attachments/20120702/e715a233/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001316.html">[was: [Caml-list] [ANN] oasis v0.3.0: Architecture for building OCaml libraries and applications] Pb with type_conv
</A></li>
	<LI>Next message: <A HREF="001305.html">Erlang-like Gen server using Async
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#417">[ date ]</a>
              <a href="thread.html#417">[ thread ]</a>
              <a href="subject.html#417">[ subject ]</a>
              <a href="author.html#417">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/core">More information about the core
mailing list</a><br>
</body></html>
