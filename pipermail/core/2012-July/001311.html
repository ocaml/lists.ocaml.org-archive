<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Erlang-like Gen server using Async
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20Erlang-like%20Gen%20server%20using%20Async&In-Reply-To=%3Cff0cf05c-33ec-442d-aeef-c21ecffd35d8%40googlegroups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001310.html">
   <LINK REL="Next"  HREF="000424.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Erlang-like Gen server using Async</H1>
    <B>Sam</B> 
    <A HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20Erlang-like%20Gen%20server%20using%20Async&In-Reply-To=%3Cff0cf05c-33ec-442d-aeef-c21ecffd35d8%40googlegroups.com%3E"
       TITLE="Erlang-like Gen server using Async">sdefabbiakane at gmail.com
       </A><BR>
    <I>Thu Jul  5 04:22:42 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001310.html">Erlang-like Gen server using Async
</A></li>
        <LI>Next message: <A HREF="000424.html">type_conv/ocaml4 release
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1311">[ date ]</a>
              <a href="thread.html#1311">[ thread ]</a>
              <a href="subject.html#1311">[ subject ]</a>
              <a href="author.html#1311">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>That's true for the upon in 'start', but not for the other two in 'loop'. 
You do wait on those deferreds to continue, you're just using upon to get 
the unit type you want. I think what you really want to be doing is calling 
&quot;whenever (Stream.iter' ...)&quot; in 'start', since you're basically 
implementing Stream.iter yourself with 'loop' anyway. Whenever is like the 
standard ignore function, except it only takes things if type unit deferred.

You also definitely want a map instead of bind in 'start'.

As I was saying before (or maybe as I meant to say before), using upon and 
things like raw ivars a lot isn't necessarily wrong, but it does suggest 
that you're working at a lower level of abstraction than is usually 
necessary.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ocaml.org/pipermail/core/attachments/20120704/80aa99ff/attachment-0001.html">http://lists.ocaml.org/pipermail/core/attachments/20120704/80aa99ff/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001310.html">Erlang-like Gen server using Async
</A></li>
	<LI>Next message: <A HREF="000424.html">type_conv/ocaml4 release
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1311">[ date ]</a>
              <a href="thread.html#1311">[ thread ]</a>
              <a href="subject.html#1311">[ subject ]</a>
              <a href="author.html#1311">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/core">More information about the core
mailing list</a><br>
</body></html>
