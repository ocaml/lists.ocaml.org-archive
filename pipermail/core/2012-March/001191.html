<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> sexp_default
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20sexp_default&In-Reply-To=%3CCAP_800pGD29uE%3DkASrekTCXSq%2Buhm5USZwEgO-aVVEo0DPA9UA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001189.html">
   <LINK REL="Next"  HREF="001190.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>sexp_default</H1>
    <B>Markus Mottl</B> 
    <A HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20sexp_default&In-Reply-To=%3CCAP_800pGD29uE%3DkASrekTCXSq%2Buhm5USZwEgO-aVVEo0DPA9UA%40mail.gmail.com%3E"
       TITLE="sexp_default">markus.mottl at gmail.com
       </A><BR>
    <I>Sat Mar 31 20:35:21 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001189.html">sexp_default
</A></li>
        <LI>Next message: <A HREF="001190.html">sexp_default
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1191">[ date ]</a>
              <a href="thread.html#1191">[ thread ]</a>
              <a href="subject.html#1191">[ subject ]</a>
              <a href="author.html#1191">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Sat, Mar 31, 2012 at 15:16, Jim Clune &lt;<A HREF="http://lists.ocaml.org/listinfo/core">jim.clune at gmail.com</A>&gt; wrote:
&gt;<i> Perhaps I shouldn't have used the word &quot;semantics&quot;. Here is an example
</I>&gt;<i> of what I mean:
</I>&gt;<i>
</I>&gt;<i> module A = struct
</I>&gt;<i> &#160;type t = {
</I>&gt;<i> &#160; &#160;guest : string;
</I>&gt;<i> &#160; &#160;food : string sexp_default(&quot;steak&quot;)!;
</I>&gt;<i> &#160;} with sexp
</I>&gt;<i> end
</I>&gt;<i>
</I>&gt;<i> module B = struct
</I>&gt;<i> &#160;type t = A.t = {
</I>&gt;<i> &#160; &#160;guest : string;
</I>&gt;<i> &#160; &#160;food : string sexp_default(&quot;fish&quot;);
</I>&gt;<i> &#160;} with sexp
</I>&gt;<i> end
</I>&gt;<i>
</I>&gt;<i> &#160;let () =
</I>&gt;<i> &#160; &#160;let original = { A.
</I>&gt;<i> &#160; &#160; &#160;guest = &quot;Bob&quot;;
</I>&gt;<i> &#160; &#160; &#160;food = &quot;steak&quot;;
</I>&gt;<i> &#160; &#160;} in
</I>&gt;<i> &#160; &#160;let x = B.t_of_sexp (A.sexp_of_t original) in
</I>&gt;<i> &#160; &#160;printf &quot;%s ordered %s\n&quot; x.A.guest x.A.food
</I>&gt;<i>
</I>&gt;<i> If I understand the proposal correctly, this will say that Bob ordered
</I>&gt;<i> fish even though he originally ordered steak. Obviously, one can write
</I>&gt;<i> custom sexp converters to get this behavior already. I'm just
</I>&gt;<i> questioning the desirability of having this be easy.
</I>
There is no reasonable way for me to prevent users from shooting
themselves in the foot.  Manifest types need to be supported,
otherwise you wouldn't be able to e.g. automatically generate
S-expression converters for concrete types in external libraries that
don't use sexplib.  I cannot easily test whether anybody uses this
feature to generate incompatible defaults in equivalent types.  In
fact, one can imagine scenarios where different defaults are even
intentional.

-- 
Markus Mottl&#160; &#160; &#160; &#160; <A HREF="http://www.ocaml.info&#160;">http://www.ocaml.info&#160;</A> &#160; &#160; &#160; <A HREF="http://lists.ocaml.org/listinfo/core">markus.mottl at gmail.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001189.html">sexp_default
</A></li>
	<LI>Next message: <A HREF="001190.html">sexp_default
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1191">[ date ]</a>
              <a href="thread.html#1191">[ thread ]</a>
              <a href="subject.html#1191">[ subject ]</a>
              <a href="author.html#1191">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/core">More information about the core
mailing list</a><br>
</body></html>
