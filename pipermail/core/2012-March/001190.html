<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> sexp_default
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20sexp_default&In-Reply-To=%3CCAP_800qRswhg2R7RqX-uMS2EDcXiCxKAUamZzQNaAk-szaQ_uw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001191.html">
   <LINK REL="Next"  HREF="001187.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>sexp_default</H1>
    <B>Markus Mottl</B> 
    <A HREF="mailto:core%40lists.ocaml.org?Subject=Re%3A%20sexp_default&In-Reply-To=%3CCAP_800qRswhg2R7RqX-uMS2EDcXiCxKAUamZzQNaAk-szaQ_uw%40mail.gmail.com%3E"
       TITLE="sexp_default">markus.mottl at gmail.com
       </A><BR>
    <I>Sat Mar 31 20:25:38 BST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001191.html">sexp_default
</A></li>
        <LI>Next message: <A HREF="001187.html">sexp_default
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1190">[ date ]</a>
              <a href="thread.html#1190">[ thread ]</a>
              <a href="subject.html#1190">[ subject ]</a>
              <a href="author.html#1190">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Sat, Mar 31, 2012 at 05:31, Jim Clune &lt;<A HREF="http://lists.ocaml.org/listinfo/core">jim.clune at gmail.com</A>&gt; wrote:
&gt;<i> Hi, Markus. Your proposal is interesting, but I'm a little concerned
</I>&gt;<i> about this part:
</I>&gt;<i>
</I>&gt;&gt;<i> Using manifest types, developers can easily generate equivalent
</I>&gt;&gt;<i> instantiations of a record type with different conversion behavior.
</I>&gt;&gt;<i> E.g.:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160;type drop_foo_default = t = { foo : int sexp_default(foo)! } with sexp
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This way different &quot;default views&quot; could be emitted for a given record.
</I>&gt;<i>
</I>&gt;<i> It is not clear to me whether this is best construed as a feature or a
</I>&gt;<i> bug. It seems to encourage people to make type-equivalences that have
</I>&gt;<i> sexp representations that can be generated by one type and parsed by
</I>&gt;<i> an &quot;equivalent&quot; type that has silently incompatible semantics. This,
</I>&gt;<i> combined with the fact that sexp representations do not embed the name
</I>&gt;<i> of the types or modules that generated them, looks to me to like a
</I>&gt;<i> recipe for bugs.
</I>
S-expressions are generally just structural.  There is no type
associated with any of them.  Nothing will prevent you from converting
an S-expression to a different type than the one it originated from as
long as the value is compatible in structure.  The same is true of the
binary protocol and the OCaml marshaling module btw.  If you need
guarantees about the originating type of such a value, you as a
developer need to take care of that.  E.g. by &quot;nominal typing&quot;, i.e.
you annotate the value with an unambiguous identifier of its
originating type.  Or by more advanced structural matching that
requires that the originating type can be unified with the destination
type.  This would require storing the type-specification along with
the value.

The above discussion of &quot;views&quot; is somewhat unrelated to this.  All
views should really be equivalent.  It's more about what kind of
information should be revealed.  E.g. if a program raises an exception
and needs to show its user-supplied configuration for debugging
purposes, you may want to emit all record fields, because sometimes
the bug may be that the user had incorrect assumptions of what the
default is.  In other cases you might want to ask a process to
generate a minimal configuration file that reflects its current state.
 Leaving out default values would then make these configurations much
shorter and readable.  That's what I mean by &quot;views&quot;.

&gt;<i> Do you consider this facilitation of different &quot;default views&quot; to be
</I>&gt;<i> an important aspect of the proposal? Or is there a milder version of
</I>&gt;<i> the proposal that does not have this feature?
</I>
There is no facilitation of &quot;default views&quot; in my proposal.  The macro
merely allows you to define defaults for record fields.  There is
nothing I can do to prevent users from using (or abusing) it by
combining it with features of the type and module system.  The
examples (e.g. views) I mentioned merely show potential use cases
where this feature can be creatively employed.

-- 
Markus Mottl&#160; &#160; &#160; &#160; <A HREF="http://www.ocaml.info&#160;">http://www.ocaml.info&#160;</A> &#160; &#160; &#160; <A HREF="http://lists.ocaml.org/listinfo/core">markus.mottl at gmail.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001191.html">sexp_default
</A></li>
	<LI>Next message: <A HREF="001187.html">sexp_default
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1190">[ date ]</a>
              <a href="thread.html#1190">[ thread ]</a>
              <a href="subject.html#1190">[ subject ]</a>
              <a href="author.html#1190">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/core">More information about the core
mailing list</a><br>
</body></html>
