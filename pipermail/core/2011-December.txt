From ben.mailist at gmail.com  Fri Dec  2 11:03:02 2011
From: ben.mailist at gmail.com (ben mailist)
Date: Fri, 2 Dec 2011 03:03:02 -0800 (PST)
Subject: build error with ocaml-core on mac os x
Message-ID: <17292518.156.1322823782584.JavaMail.geo-discussion-forums@vbmh5>

hi

I successfully installed all the primary dependencies mentioned in INSTALL. 
Same goes for the secondary dependencies like type-conv on which some o the 
primary ones depend on.

My setup:
- core-107.01
- mac os x 10.6.8
- ocaml  3-12.1

Error message:
$ cd core-1.7.01
$ ocaml setup.ml -configure
$ ocaml setup.ml -build
[....]
ocamlfind: Package `type-conv.syntax' not found - required by 
`sexplib.syntax' Command exited with code 2. E: Command 
'/homes/ben/local/bin/ocamlbuild lib/libcore.a lib/dllcore.so lib/core.cma 
lib/core.cmxa lib/core.a lib_test/test_runner.byte -tag debug' terminated 
with error code 10
[....]


Obviously there is a problem with type-conv.syntax not beeing installed:
$ ocamlfind list | grep sexp 
sexplib (version: 6.1.1) 
sexplib.syntax (version: 6.1.1) 
sexplib.top (version: 6.1.1)

$ ocamlfind list | grep conv
type-conv (version: 2.3.0) 

But is this really the problem on type-conv? Sexplib built without any 
errors in this regard.

thanks 
ben


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111202/7b6e24f1/attachment.html>

From ben.mailist at gmail.com  Fri Dec  2 11:18:45 2011
From: ben.mailist at gmail.com (ben mailist)
Date: Fri, 2 Dec 2011 03:18:45 -0800 (PST)
Subject: build error with ocaml-core on mac os x
In-Reply-To: <4ED8B302.8080100@glondu.net>
References: <17292518.156.1322823782584.JavaMail.geo-discussion-forums@vbmh5>
 <4ED8B302.8080100@glondu.net>
Message-ID: <4668457.135.1322824725898.JavaMail.geo-discussion-forums@vbjs5>

wow that was quick, thank you.

Right after my post I did what are you suggesting now. I've reinstalled 
sexplib, since the problem stemmed from an outdated directive in the 
META file of sexplib.

After installing the latest sexplib package, ocaml-core built without any 
problems.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111202/c4619546/attachment.html>

From steph at glondu.net  Fri Dec  2 11:14:10 2011
From: steph at glondu.net (=?UTF-8?B?U3TDqXBoYW5lIEdsb25kdQ==?=)
Date: Fri, 02 Dec 2011 12:14:10 +0100
Subject: build error with ocaml-core on mac os x
In-Reply-To: <17292518.156.1322823782584.JavaMail.geo-discussion-forums@vbmh5>
References: <17292518.156.1322823782584.JavaMail.geo-discussion-forums@vbmh5>
Message-ID: <4ED8B302.8080100@glondu.net>


On 12/02/2011 12:03 PM, ben mailist wrote:
> Obviously there is a problem with type-conv.syntax not beeing installed:
> $ ocamlfind list | grep sexp
> sexplib (version: 6.1.1)
> sexplib.syntax (version: 6.1.1)
> sexplib.top (version: 6.1.1)
> 
> $ ocamlfind list | grep conv
> type-conv (version: 2.3.0)

Try upgrading sexplib and type-conv. I don't know exactly what are the
minimal requirements, but it should compile at least with sexplib 7.0.4
and type-conv 3.0.4).


Cheers,

-- 
St?phane


From yminsky at janestreet.com  Fri Dec  2 23:16:52 2011
From: yminsky at janestreet.com (Yaron Minsky)
Date: Fri, 2 Dec 2011 18:16:52 -0500
Subject: hg <-> git madness
Message-ID: <20111202231652.GB3061@janestreet.com>


We've done most of the work of bridging from internal to external
repos for Core and the related repositories, but we're having a hell
of a time converting from hg to git in a clean way.  We're about to
give up and just host the repos on bitbucket --- we basically like hg
better internally anyway.

Does anyone on the list care that much?  And if you _really_ care, you
can help us build a converter from hg to git....

y

-- 
Yaron Minsky


From yminsky at janestreet.com  Fri Dec  2 23:59:46 2011
From: yminsky at janestreet.com (Yaron Minsky)
Date: Fri, 2 Dec 2011 18:59:46 -0500
Subject: Making Async play better with others
In-Reply-To: <CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
References: <20111031142540.GZ26614@janestreet.com>
 <531e4eac-1d50-4432-8073-7b78ad7d80b0@o9g2000vbc.googlegroups.com>
 <20111122004427.GU7522@janestreet.com>
 <CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
Message-ID: <20111202235946.GH3061@janestreet.com>


Hey Markus.  One thing I wanted to bounce off of you is how you feel
about the idea of us integrating the type-conv suite into the Core
repo.  We'd still release separate tarballs so people could download
just the bits they want.  But we were thinking it would be easier to
manage the coordination with our internal tree if we kept them
together in the repo.

We've basically given up on Git and Github, though Yury is going to
give it one more try.  We've done a preliminary export (the build
isn't set up quite right yet, but the code is all there) on bitbucket.

   https://bitbucket.org/yminsky/ocaml-core

This is cut from trunk and has Stephen's new refactor of Async.  We'll
probably get this through code review in January or February.

We might blow this one away and recreate it on Monday, but I wanted to
give you an early look.

y

On 21/11/11 20:05, Markus Mottl wrote:
> On Mon, Nov 21, 2011 at 19:44, Yaron Minsky <yminsky at janestreet.com> wrote:
> > Yury is hoping to get a proper bridging system for ferrying patches
> > back and forth to github done very soon, say, in another week. ?If we
> > can't get it done, we'll try something simpler as an intermediate
> > step.
> 
> Sounds good, my kids will keep me busy enough in the meanwhile.
> 
> > In any case, we'd be very happy to accept portability patches!
> > Stephen, what do you think about Markus' proposal for how to organize
> > it? ?It's worth noting that this patch might conflict with a patch
> > that Stephen has done internally that reorganizes much of Async's
> > internals to separate out a small core that is independent of all
> > OS-specific code.
> 
> I'd surely prefer using that version.  In case it would take too long
> to wait for the integration, I could apply the trivial changes.  I
> managed to build async on Mac OS X using the preprocessor with them.
> Merging a few lines later doesn't sound like too much of a challenge.
> 
> Regards,
> Markus
> 
> -- 
> Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com

-- 
Yaron Minsky


From yminsky at gmail.com  Sat Dec  3 00:34:41 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Fri, 2 Dec 2011 19:34:41 -0500
Subject: Making Async play better with others
In-Reply-To: <20111202235946.GH3061@janestreet.com>
References: <20111031142540.GZ26614@janestreet.com>
	<531e4eac-1d50-4432-8073-7b78ad7d80b0@o9g2000vbc.googlegroups.com>
	<20111122004427.GU7522@janestreet.com>
	<CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
	<20111202235946.GH3061@janestreet.com>
Message-ID: <CADKNfhKTxKHFYJu4tL490PmYs+mDwvDWnKtiyxoWMGSyh=PWpQ@mail.gmail.com>

Whoops.  Meant to include Markus explicitly in the to-address.
On Dec 2, 2011 6:59 PM, "Yaron Minsky" <yminsky at janestreet.com> wrote:

> Hey Markus.  One thing I wanted to bounce off of you is how you feel
> about the idea of us integrating the type-conv suite into the Core
> repo.  We'd still release separate tarballs so people could download
> just the bits they want.  But we were thinking it would be easier to
> manage the coordination with our internal tree if we kept them
> together in the repo.
>
> We've basically given up on Git and Github, though Yury is going to
> give it one more try.  We've done a preliminary export (the build
> isn't set up quite right yet, but the code is all there) on bitbucket.
>
>   https://bitbucket.org/yminsky/ocaml-core
>
> This is cut from trunk and has Stephen's new refactor of Async.  We'll
> probably get this through code review in January or February.
>
> We might blow this one away and recreate it on Monday, but I wanted to
> give you an early look.
>
> y
>
> On 21/11/11 20:05, Markus Mottl wrote:
> > On Mon, Nov 21, 2011 at 19:44, Yaron Minsky <yminsky at janestreet.com>
> wrote:
> > > Yury is hoping to get a proper bridging system for ferrying patches
> > > back and forth to github done very soon, say, in another week.  If we
> > > can't get it done, we'll try something simpler as an intermediate
> > > step.
> >
> > Sounds good, my kids will keep me busy enough in the meanwhile.
> >
> > > In any case, we'd be very happy to accept portability patches!
> > > Stephen, what do you think about Markus' proposal for how to organize
> > > it?  It's worth noting that this patch might conflict with a patch
> > > that Stephen has done internally that reorganizes much of Async's
> > > internals to separate out a small core that is independent of all
> > > OS-specific code.
> >
> > I'd surely prefer using that version.  In case it would take too long
> > to wait for the integration, I could apply the trivial changes.  I
> > managed to build async on Mac OS X using the preprocessor with them.
> > Merging a few lines later doesn't sound like too much of a challenge.
> >
> > Regards,
> > Markus
> >
> > --
> > Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>
> --
> Yaron Minsky
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111202/47e65228/attachment.html>

From thomas at ocamlpro.com  Sat Dec  3 10:17:03 2011
From: thomas at ocamlpro.com (Thomas Gazagnaire)
Date: Sat, 3 Dec 2011 11:17:03 +0100
Subject: hg <-> git madness
In-Reply-To: <20111202231652.GB3061@janestreet.com>
References: <20111202231652.GB3061@janestreet.com>
Message-ID: <656F4468-4CC9-435A-A111-30A0C66E8A89@ocamlpro.com>

> We've done most of the work of bridging from internal to external
> repos for Core and the related repositories, but we're having a hell
> of a time converting from hg to git in a clean way.  We're about to
> give up and just host the repos on bitbucket --- we basically like hg
> better internally anyway.

What problem are you facing ? I guess you've already tried http://hg-git.github.com/

--
Thomas

> 
> Does anyone on the list care that much?  And if you _really_ care, you
> can help us build a converter from hg to git....
> 
> y
> 
> -- 
> Yaron Minsky

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111203/7356804a/attachment.html>

From yminsky at gmail.com  Sat Dec  3 17:19:53 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sat, 3 Dec 2011 12:19:53 -0500
Subject: hg <-> git madness
In-Reply-To: <20111203161115.GA9686@dark.recoil.org>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
Message-ID: <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>

On Sat, Dec 3, 2011 at 11:11 AM, Anil Madhavapeddy <anil at recoil.org> wrote:

> On Fri, Dec 02, 2011 at 06:16:52PM -0500, Yaron Minsky wrote:
> > We've done most of the work of bridging from internal to external
> > repos for Core and the related repositories, but we're having a hell
> > of a time converting from hg to git in a clean way.  We're about to
> > give up and just host the repos on bitbucket --- we basically like hg
> > better internally anyway.
>
> Going one way from hg->git is pretty trivial, so I presume you mean
> two-way? This can be tricky if you're using branches, as they are quite
> different models between hg/git.


We have no intent on using branches at present (although my understanding
is that hg bookmarks and git branches are pretty damn similar to git
branches.)

Yury was able to get the changes pushed out to git, but hg-git seemed
pretty flaky.  That said, maybe Yury can describe some of the specific
issues he ran into.  We definitely want a two-way bridging process, and the
flakiness of the tool did not give us much confidence.

Do you think it would be worthwhile doing a purely one-way bridge from
bitbucket to github, just to make it easier for more people to follow
along, but to keep serious collaboration to bitbucket?


> > Does anyone on the list care that much?  And if you _really_ care, you
> > can help us build a converter from hg to git....
>
> It would be good to understand what your desired workflow is first, that
> makes it hard.
>

Here's the rough idea.  We have a very big internal repo that has lots of
code that we don't want to export.  But we do want to share some of that
code, and make it possible to integrate work from others into our internal
tree.

We have a piece of software we call a convert daemon, built on top of the
"hg convert" command, that exports our tree after applying some
transformations (mostly dropping files.)  That is used to create the
repository we just put on bitbucket.  The convert daemon can also pull
changesets back over from that repo.  We hope to be able to coordinate with
people using this tool; pulling patches in from the external repo, and
occasionally choosing an internal snapshot to export.

We'd like to be able to do the same thing while peering with github as
well, but for that, we basically need to be able to pull patches back and
forth between github and hg cleanly.  Perhaps with a bit more hacking we
can get hg-git to work properly, and that will provide an adequate solution.


> However, I'm far more interested in seeing code published and outside
> patches being applied, and less with precisely which VCS is being used. If
> Bitbucket makes your workflow easier, put it up there!


I agree getting it out there is the most important thing.  That's why we
got the current version out (although I wouldn't start forking it just yet.
 I think we're going to strip it clean and regenerate it in the next few
days to fix a few problems that showed up.)

y
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111203/5a461d1d/attachment.html>

From ysulsky at gmail.com  Sat Dec  3 18:57:09 2011
From: ysulsky at gmail.com (Yury Sulsky)
Date: Sat, 3 Dec 2011 13:57:09 -0500
Subject: hg <-> git madness
In-Reply-To: <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
Message-ID: <CAEDxudyNPajjjzSLtR31g0zj75Oq4fSsaHgMCxXd1g-5kQYxVg@mail.gmail.com>


On Sat, Dec 3, 2011 at 12:19 PM, Yaron Minsky <yminsky at gmail.com> wrote:
> Yury was able to get the changes pushed out to git, but hg-git seemed pretty
> flaky. ?That said, maybe Yury can describe some of the specific issues he
> ran into. ?We definitely want a two-way bridging process, and the flakiness
> of the tool did not give us much confidence.

Actually, it looks like fast-export
(http://repo.or.cz/w/fast-export.git) works for converting from
mercurial to git with the tools I have installed at home. I haven't
had much success with hg-git, however. Sometimes "hg gexport" creates
a .git folder without any objects, and when it does work, sometimes
the resulting repo isn't cloneable by git.

So if we want to maintain a git version of the tree, it looks like we
have at least three options. If we debug hg-git, we'll have a pretty
seamless bridge between the two. We can also add a git backend to
mercurial's convert extension, and in that case the conversion process
is nice and symmetric. We can also use fast-export to go from
mercurial to git and "hg convert" to go the other way, but there would
be an additional step to make sure that the round trip is idempotent.

If we're okay with just hosting on on Bitbucket, of course all of this
nonsense just goes away :-).

Yury


From yminsky at gmail.com  Sat Dec  3 20:27:17 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sat, 3 Dec 2011 15:27:17 -0500
Subject: hg <-> git madness
In-Reply-To: <CAEDxudyNPajjjzSLtR31g0zj75Oq4fSsaHgMCxXd1g-5kQYxVg@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
	<CAEDxudyNPajjjzSLtR31g0zj75Oq4fSsaHgMCxXd1g-5kQYxVg@mail.gmail.com>
Message-ID: <CADKNfhLx-Nnd2eKc7-gXPofTs=eaHQxqHJ1J11oaymVYT8DwQA@mail.gmail.com>

On Sat, Dec 3, 2011 at 1:57 PM, Yury Sulsky <ysulsky at gmail.com> wrote:

> On Sat, Dec 3, 2011 at 12:19 PM, Yaron Minsky <yminsky at gmail.com> wrote:
> > Yury was able to get the changes pushed out to git, but hg-git seemed
> pretty
> > flaky.  That said, maybe Yury can describe some of the specific issues he
> > ran into.  We definitely want a two-way bridging process, and the
> flakiness
> > of the tool did not give us much confidence.
>
> Actually, it looks like fast-export
> (http://repo.or.cz/w/fast-export.git) works for converting from
> mercurial to git with the tools I have installed at home. I haven't
> had much success with hg-git, however. Sometimes "hg gexport" creates
> a .git folder without any objects, and when it does work, sometimes
> the resulting repo isn't cloneable by git.
>
> So if we want to maintain a git version of the tree, it looks like we
> have at least three options. If we debug hg-git, we'll have a pretty
> seamless bridge between the two. We can also add a git backend to
> mercurial's convert extension, and in that case the conversion process
> is nice and symmetric. We can also use fast-export to go from
> mercurial to git and "hg convert" to go the other way, but there would
> be an additional step to make sure that the round trip is idempotent.
>
> If we're okay with just hosting on on Bitbucket, of course all of this
> nonsense just goes away :-).


Let's focus on getting the repo up at bitbucket in any case.  Then we can
consider adding github to the merge-flow if we can get that part working
cleanly.  But getting it up and available seems like the first step.  And
anyway, leaving it in hg will make 90% of the Jane Street employees
happier, since that's the tool we're all used to.

y
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111203/6989e59a/attachment.html>

From anil at recoil.org  Sat Dec  3 16:11:15 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Sat, 3 Dec 2011 16:11:15 +0000
Subject: hg <-> git madness
In-Reply-To: <20111202231652.GB3061@janestreet.com>
References: <20111202231652.GB3061@janestreet.com>
Message-ID: <20111203161115.GA9686@dark.recoil.org>


On Fri, Dec 02, 2011 at 06:16:52PM -0500, Yaron Minsky wrote:
> We've done most of the work of bridging from internal to external
> repos for Core and the related repositories, but we're having a hell
> of a time converting from hg to git in a clean way.  We're about to
> give up and just host the repos on bitbucket --- we basically like hg
> better internally anyway.

Going one way from hg->git is pretty trivial, so I presume you mean
two-way? This can be tricky if you're using branches, as they are quite
different models between hg/git.

> Does anyone on the list care that much?  And if you _really_ care, you
> can help us build a converter from hg to git....

It would be good to understand what your desired workflow is first, that
makes it hard.

However, I'm far more interested in seeing code published and outside
patches being applied, and less with precisely which VCS is being used. If
Bitbucket makes your workflow easier, put it up there!

-- 
Anil Madhavapeddy                                 http://anil.recoil.org


From yminsky at gmail.com  Sun Dec  4 13:04:29 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sun, 4 Dec 2011 08:04:29 -0500
Subject: hg <-> git madness
In-Reply-To: <20111204100505.GA30045@dark.recoil.org>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
	<20111204100505.GA30045@dark.recoil.org>
Message-ID: <CADKNfhJxrvf5AnpLAeOmp=H+1T_goa278AS=bDeDozLnNFU57w@mail.gmail.com>

On Sun, Dec 4, 2011 at 5:05 AM, Anil Madhavapeddy <anil at recoil.org> wrote:

> On Sat, Dec 03, 2011 at 12:19:53PM -0500, Yaron Minsky wrote:
> > Here's the rough idea.  We have a very big internal repo that has lots of
> > code that we don't want to export.  But we do want to share some of that
> > code, and make it possible to integrate work from others into our
> internal
> > tree.
>
> This is the real source of my concern.  A public release needs real users
> in order to get it off the ground. If Jane Street is keeping an internal
> tree, then that means they aren't using the public release, and feeling
> the pain of bugs or a lack of documentation.
>

It's a fair concern, but I think that our internal development cycle is
going to be quite hard to change in this way.

As for users, it's worth noting that we'll all be users at home!  One of
the big drivers of the public release is to allow people to use Core and
Async for their own personal projects, so we'll have a set of internal
users almost immediately.

As for bugs and documentation, the public release will get the same code
and the same documentation that we get internally (for what that's worth;
the documentation could be better...).  And we'll cut major releases from
the point in history where we have completed a full code-review cycle, so
the quality should be good.

There's no doubt that we'll have to work hard to make sure that externally
developed patches are integrated reasonably.  And I think we'll have to
find a modus vivendi on that, in particular finding a set of external
people who we trust to propose changes before we spend serious time
evaluating those changes.


> Is there any reason not to split out your use of Core into a separate
> repository which is suitable for public release, and consumed by your
> internal systems?  We did this for Xen via Mercurial patchqueues (held in
> a separate repository), to make it clear which the product-local changes
> were.
>
> > I agree getting it out there is the most important thing.  That's why we
> > got the current version out (although I wouldn't start forking it just
> > yet.  I think we're going to strip it clean and regenerate it in the
> > next few days to fix a few problems that showed up.)
>
> Great! Will there be history in the regenerated one? I just see a mega
> commit from ysulky at the moment.


No regenerated history, I'm afraid, and that is not likely to change.

y
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111204/b726468f/attachment.html>

From yminsky at gmail.com  Sun Dec  4 13:06:08 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sun, 4 Dec 2011 08:06:08 -0500
Subject: hg <-> git madness
In-Reply-To: <687D2086-E22D-4F53-8265-817B1F4699B4@recoil.org>
References: <20111204100505.GA30045@dark.recoil.org>
	<687D2086-E22D-4F53-8265-817B1F4699B4@recoil.org>
Message-ID: <CADKNfh++a+a3+vurNPaR4c-2qpaqh+zt6LOFHApepo1qijTLww@mail.gmail.com>

Not at all!  Glad to have the discussion.

One thing I wanted to mention that I didn't say on the list: one of the
reasons we don't want to export lots of history is that we're trying to be
quite careful about IP issues, and exporting a big complicated history
makes that virtually impossible.

y

On Sun, Dec 4, 2011 at 6:37 AM, Anil Madhavapeddy <anil at recoil.org> wrote:

> I just re-read this and realised the tone is a little demanding. I didn't
> intend it that way at all! Just honestly wondering about the best way to
> make Core a success for all...
>
> Begin forwarded message:
>
> > This is the real source of my concern.  A public release needs real users
> > in order to get it off the ground. If Jane Street is keeping an internal
> > tree, then that means they aren't using the public release, and feeling
> > the pain of bugs or a lack of documentation.
> >
> > Is there any reason not to split out your use of Core into a separate
> > repository which is suitable for public release, and consumed by your
> > internal systems?  We did this for Xen via Mercurial patchqueues (held in
> > a separate repository), to make it clear which the product-local changes
> > were.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111204/a34778e2/attachment.html>

From anil at recoil.org  Sun Dec  4 10:05:05 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Sun, 4 Dec 2011 10:05:05 +0000
Subject: hg <-> git madness
In-Reply-To: <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
 <20111203161115.GA9686@dark.recoil.org>
 <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
Message-ID: <20111204100505.GA30045@dark.recoil.org>


On Sat, Dec 03, 2011 at 12:19:53PM -0500, Yaron Minsky wrote:
> 
> We have no intent on using branches at present (although my
> understanding is that hg bookmarks and git branches are pretty damn
> similar to git branches.)
> 
> Yury was able to get the changes pushed out to git, but hg-git seemed
> pretty flaky.  That said, maybe Yury can describe some of the specific
> issues he ran into.  We definitely want a two-way bridging process, and
> the flakiness of the tool did not give us much confidence.
> 
> Do you think it would be worthwhile doing a purely one-way bridge from
> bitbucket to github, just to make it easier for more people to follow
> along, but to keep serious collaboration to bitbucket?

Fast-export has normally been what I've used to go in one direction, but
I've never tried hg-git.

The main advantage of github is actually its public workflow. Pull
requests with code review, a decent issue system, an API good enough for
continuous integration (e.g. the xen-api has a buildbot test a pull
request automatically before it is merged [1][2]). 

Bitbucket looks like it has the same features (the same names, anyway), so
should work well enough if that's what you want.

[1] https://github.com/xen-org/xen-api/pull/406
[2] https://github.com/xen-org/pull-request-manager

> Here's the rough idea.  We have a very big internal repo that has lots of
> code that we don't want to export.  But we do want to share some of that
> code, and make it possible to integrate work from others into our internal
> tree.

This is the real source of my concern.  A public release needs real users
in order to get it off the ground. If Jane Street is keeping an internal
tree, then that means they aren't using the public release, and feeling
the pain of bugs or a lack of documentation.

Is there any reason not to split out your use of Core into a separate
repository which is suitable for public release, and consumed by your
internal systems?  We did this for Xen via Mercurial patchqueues (held in
a separate repository), to make it clear which the product-local changes
were.

> I agree getting it out there is the most important thing.  That's why we
> got the current version out (although I wouldn't start forking it just
> yet.  I think we're going to strip it clean and regenerate it in the
> next few days to fix a few problems that showed up.)

Great! Will there be history in the regenerated one? I just see a mega
commit from ysulky at the moment.

-- 
Anil Madhavapeddy                                 http://anil.recoil.org


From markus.mottl at gmail.com  Sun Dec  4 15:44:13 2011
From: markus.mottl at gmail.com (Markus Mottl)
Date: Sun, 4 Dec 2011 10:44:13 -0500
Subject: Making Async play better with others
In-Reply-To: <20111202235946.GH3061@janestreet.com>
References: <20111031142540.GZ26614@janestreet.com>
	<531e4eac-1d50-4432-8073-7b78ad7d80b0@o9g2000vbc.googlegroups.com>
	<20111122004427.GU7522@janestreet.com>
	<CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
	<20111202235946.GH3061@janestreet.com>
Message-ID: <CAP_800p0EP04NB9zqNAESmu5WfP0=_wT5EfMc3VG7zzJtU-aKA@mail.gmail.com>


Hi Ron,

On Fri, Dec 2, 2011 at 18:59, Yaron Minsky <yminsky at janestreet.com> wrote:
> Hey Markus. ?One thing I wanted to bounce off of you is how you feel
> about the idea of us integrating the type-conv suite into the Core
> repo. ?We'd still release separate tarballs so people could download
> just the bits they want. ?But we were thinking it would be easier to
> manage the coordination with our internal tree if we kept them
> together in the repo.

As long as every sub-project (type-conv, sexplib, bin-prot, etc.) can
build and install completely separately, this should be fine.  The
sub-directories should ideally be identical to what's going into the
release tarballs.  That said, if there is a way to keep things in
separate repos, I'd prefer that solution.

On another note, any news on your commitment to Oasis?  I'm still
holding off on switching my other libraries as long as it's future is
unclear, which mostly depends on whether or not Jane Street will
support it.

Btw., do you have any intentions to release your OMakeroot?  I guess
it might be useful for people who prefer OMake over ocamlbuild.

> We've basically given up on Git and Github, though Yury is going to
> give it one more try. ?We've done a preliminary export (the build
> isn't set up quite right yet, but the code is all there) on bitbucket.
>
> ? https://bitbucket.org/yminsky/ocaml-core
>
> This is cut from trunk and has Stephen's new refactor of Async. ?We'll
> probably get this through code review in January or February.

Indeed, Stephen's golden fingerprints are all over the code ;-).  Nice job!

> We might blow this one away and recreate it on Monday, but I wanted to
> give you an early look.

Looks great, I can't wait to see a public release....

Regards,
Markus

-- 
Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com


From yminsky at gmail.com  Sun Dec  4 16:08:53 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sun, 4 Dec 2011 11:08:53 -0500
Subject: Making Async play better with others
In-Reply-To: <CAP_800p0EP04NB9zqNAESmu5WfP0=_wT5EfMc3VG7zzJtU-aKA@mail.gmail.com>
References: <20111031142540.GZ26614@janestreet.com>
	<531e4eac-1d50-4432-8073-7b78ad7d80b0@o9g2000vbc.googlegroups.com>
	<20111122004427.GU7522@janestreet.com>
	<CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
	<20111202235946.GH3061@janestreet.com>
	<CAP_800p0EP04NB9zqNAESmu5WfP0=_wT5EfMc3VG7zzJtU-aKA@mail.gmail.com>
Message-ID: <CADKNfhKM=OaB55Mz2Juju48m=hspKnjByf_RLBQrYXmy39wcSQ@mail.gmail.com>

On Sun, Dec 4, 2011 at 10:44 AM, Markus Mottl <markus.mottl at gmail.com>wrote:

> Hi Ron,
>
> On Fri, Dec 2, 2011 at 18:59, Yaron Minsky <yminsky at janestreet.com> wrote:
> > Hey Markus.  One thing I wanted to bounce off of you is how you feel
> > about the idea of us integrating the type-conv suite into the Core
> > repo.  We'd still release separate tarballs so people could download
> > just the bits they want.  But we were thinking it would be easier to
> > manage the coordination with our internal tree if we kept them
> > together in the repo.
>
> As long as every sub-project (type-conv, sexplib, bin-prot, etc.) can
> build and install completely separately, this should be fine.  The
> sub-directories should ideally be identical to what's going into the
> release tarballs.  That said, if there is a way to keep things in
> separate repos, I'd prefer that solution.
>

Making the sub-directories separately releasable is very much the intent,
and the single-repo approach is much easier for us to keep in sync with our
internal dev process.


> On another note, any news on your commitment to Oasis?  I'm still
> holding off on switching my other libraries as long as it's future is
> unclear, which mostly depends on whether or not Jane Street will
> support it.
>

No news yet, but we're looking at the question.  I think in the end OCaml
needs something along the lines of what oasis provides (i.e., a cabal
clone.)  The question in my mind is whether Oasis is the right tool to get
us there.


> Btw., do you have any intentions to release your OMakeroot?  I guess
> it might be useful for people who prefer OMake over ocamlbuild.


I don't see why not.  Nick Chapman actually just completed a ground-up
rewrite of the rules that greatly simplifies the system and makes it more
efficient and less flaky --- the transdeps hack is now gone, for one thing,
and compilation of big trees is something like 30% faster.  And we also
have a better development mode where we turn off cross-module inlining and
therefore can avoid recompilations after a change that doesn't affect the
interface of a module.

So, I'll talk to Yury and Nick and see if we could include our OMakeroot
and OMakefiles.


> > We've basically given up on Git and Github, though Yury is going to
> > give it one more try.  We've done a preliminary export (the build
> > isn't set up quite right yet, but the code is all there) on bitbucket.
> >
> >   https://bitbucket.org/yminsky/ocaml-core
> >
> > This is cut from trunk and has Stephen's new refactor of Async.  We'll
> > probably get this through code review in January or February.
>
> Indeed, Stephen's golden fingerprints are all over the code ;-).  Nice job!


I do like having that guy around.  Sometimes I think about what our
codebase would be like if we hadn't hired him and I shudder...


> > We might blow this one away and recreate it on Monday, but I wanted to
> > give you an early look.
>
> Looks great, I can't wait to see a public release....
>
> Regards,
> Markus
>
> --
> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111204/d61f74ba/attachment.html>

From anil at recoil.org  Sun Dec  4 11:37:22 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Sun, 4 Dec 2011 11:37:22 +0000
Subject: Fwd: hg <-> git madness
References: <20111204100505.GA30045@dark.recoil.org>
Message-ID: <687D2086-E22D-4F53-8265-817B1F4699B4@recoil.org>


I just re-read this and realised the tone is a little demanding. I didn't intend it that way at all! Just honestly wondering about the best way to make Core a success for all...

Begin forwarded message:

> This is the real source of my concern.  A public release needs real users
> in order to get it off the ground. If Jane Street is keeping an internal
> tree, then that means they aren't using the public release, and feeling
> the pain of bugs or a lack of documentation.
> 
> Is there any reason not to split out your use of Core into a separate
> repository which is suitable for public release, and consumed by your
> internal systems?  We did this for Xen via Mercurial patchqueues (held in
> a separate repository), to make it clear which the product-local changes
> were.



From bfulgham at gmail.com  Mon Dec  5 18:52:31 2011
From: bfulgham at gmail.com (Brent Fulgham)
Date: Mon, 5 Dec 2011 10:52:31 -0800
Subject: hg <-> git madness
In-Reply-To: <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
Message-ID: <CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>


Hi,

On Fri, Dec 02, 2011 at 06:16:52PM -0500, Yaron Minsky wrote:
> We've done most of the work of bridging from internal to external
> repos for Core and the related repositories, but we're having a hell
> of a time converting from hg to git in a clean way. ?We're about to
> give up and just host the repos on bitbucket --- we basically like hg
> better internally anyway.

If you are already using hg internally, why not just go with bitbucket
and avoid the heartache?  I doubt that many people care where the
sources are hosted (I know I don't). I imagine that the bulk of
changes for the forceable future will probably originate within Jane
Street, so anything that lowers the barrier of getting Jane Street
code out to the world at large seems worth whatever minimal cost there
might be for non-mercurial users.

-Brent


From yminsky at janestreet.com  Mon Dec  5 19:19:12 2011
From: yminsky at janestreet.com (Yaron Minsky)
Date: Mon, 5 Dec 2011 14:19:12 -0500
Subject: hg <-> git madness
In-Reply-To: <CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
 <20111203161115.GA9686@dark.recoil.org>
 <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
 <CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>
Message-ID: <20111205191912.GH3061@janestreet.com>


On 05/12/11 10:52, Brent Fulgham wrote:
> Hi,
> 
> On Fri, Dec 02, 2011 at 06:16:52PM -0500, Yaron Minsky wrote:
> > We've done most of the work of bridging from internal to external
> > repos for Core and the related repositories, but we're having a hell
> > of a time converting from hg to git in a clean way. ?We're about to
> > give up and just host the repos on bitbucket --- we basically like hg
> > better internally anyway.
> 
> If you are already using hg internally, why not just go with bitbucket
> and avoid the heartache?  I doubt that many people care where the
> sources are hosted (I know I don't). I imagine that the bulk of
> changes for the forceable future will probably originate within Jane
> Street, so anything that lowers the barrier of getting Jane Street
> code out to the world at large seems worth whatever minimal cost there
> might be for non-mercurial users.

I think that's the way we're going at this point.  We might have a
github mirror as well, but I'm not sure it's worth the effort.

y

-- 
Yaron Minsky


From markus.mottl at gmail.com  Mon Dec  5 19:37:33 2011
From: markus.mottl at gmail.com (Markus Mottl)
Date: Mon, 5 Dec 2011 14:37:33 -0500
Subject: hg <-> git madness
In-Reply-To: <20111205191912.GH3061@janestreet.com>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
	<CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>
	<20111205191912.GH3061@janestreet.com>
Message-ID: <CAP_800oxU=_URFFU0VyfTcYVM1eeZyqxnUGqerhZ-hGBP3=B_A@mail.gmail.com>


On Mon, Dec 5, 2011 at 14:19, Yaron Minsky <yminsky at janestreet.com> wrote:
> I think that's the way we're going at this point. ?We might have a
> github mirror as well, but I'm not sure it's worth the effort.

I don't know how compelling the github features are compared to
bitbucket, but it's hard to imagine the difference matters for most
people.  Even OCamlForge seems decent enough for my purposes, and it
supports both mercurial and git repositories.

Regards,
Markus

-- 
Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com


From agarwal1975 at gmail.com  Mon Dec  5 20:16:36 2011
From: agarwal1975 at gmail.com (Ashish Agarwal)
Date: Mon, 5 Dec 2011 15:16:36 -0500
Subject: hg <-> git madness
In-Reply-To: <CAP_800oxU=_URFFU0VyfTcYVM1eeZyqxnUGqerhZ-hGBP3=B_A@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com> <20111203161115.GA9686@dark.recoil.org>
 <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
 <CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>
 <20111205191912.GH3061@janestreet.com> <CAP_800oxU=_URFFU0VyfTcYVM1eeZyqxnUGqerhZ-hGBP3=B_A@mail.gmail.com>
Message-ID: <CAMu2m2Jdw-O8+hi08FG2Chh=89w-pcmBcdvCTnXQBUDjsnkdqA@mail.gmail.com>

I'll add my vote too? github is not fundamentally important. Any public
code repository is fine.

On Mon, Dec 5, 2011 at 2:37 PM, Markus Mottl <markus.mottl at gmail.com> wrote:

> On Mon, Dec 5, 2011 at 14:19, Yaron Minsky <yminsky at janestreet.com> wrote:
> > I think that's the way we're going at this point.  We might have a
> > github mirror as well, but I'm not sure it's worth the effort.
>
> I don't know how compelling the github features are compared to
> bitbucket, but it's hard to imagine the difference matters for most
> people.  Even OCamlForge seems decent enough for my purposes, and it
> supports both mercurial and git repositories.
>
> Regards,
> Markus
>
> --
> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111205/732cd05b/attachment.html>

From ocaml-core at googlegroups.com  Tue Dec  6 03:01:34 2011
From: ocaml-core at googlegroups.com (ocaml-core at googlegroups.com)
Date: Tue, 06 Dec 2011 03:01:34 +0000
Subject: Moderator's spam report for ocaml-core@googlegroups.com
Message-ID: <0016367f9f6628ab7e04b363a735@google.com>


This message is being sent to you because you are a moderator of the group ocaml-core.

The following suspicious messages were sent to your group, but are being held in your moderation queue because they are classified as likely spam messages.

If you take no action, all the messages below will be discarded automatically as spam.

However, if you see any messages that are not spam below, you may approve them individually by going to:

http://groups.google.com/group/ocaml-core/pendmsg

Please do not mark this notification as spam; this is a service for group moderators. If you do not wish to receive these notifications in the future, you may change your preferences by going to:

http://groups.google.com/group/ocaml-core/manage_post


------- 1 of 1  -------
Subject: Your e-mail has won $1million
>From: "YAHOO ASIA LOTTERY" <decemberdraw1 at o2.pl>
Date: Dec 05 09:29AM +0100

-- 
YAHOO ASIAN LOTTERY DECEMBER DRAW
Congratulation,
Your email has won $1million For Claim contact.
Mrs.Stella Sun
Email : claimdepartment_my at live.com
Congratulation"""
Yahoo Asian coordinators.


Approve: http://groups.google.com/group/ocaml-core/pendmsg?view=full&pending_id=7079379297301382476


For more information about this message, please visit:
http://groups.google.com/support/bin/answer.py?hl=en&answer=165806



From agarwal1975 at gmail.com  Wed Dec  7 21:54:53 2011
From: agarwal1975 at gmail.com (Ashish Agarwal)
Date: Wed, 7 Dec 2011 16:54:53 -0500
Subject: stream based programming
Message-ID: <CAMu2m2JATDN=m1aZQPKkVXt=5rMevj38U9aXi=GU+ATGoWUQGA@mail.gmail.com>

Is there anything like Batteries' Enum in Core, or some other improvement
on Stream? I see lazy lists in core-extended, but is that used commonly?
More generally, what does Jane St use for stream based programming?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111207/35557c09/attachment.html>

From yminsky at janestreet.com  Wed Dec  7 22:34:21 2011
From: yminsky at janestreet.com (Yaron Minsky)
Date: Wed, 7 Dec 2011 17:34:21 -0500
Subject: stream based programming
In-Reply-To: <CAMu2m2JATDN=m1aZQPKkVXt=5rMevj38U9aXi=GU+ATGoWUQGA@mail.gmail.com>
References: <CAMu2m2JATDN=m1aZQPKkVXt=5rMevj38U9aXi=GU+ATGoWUQGA@mail.gmail.com>
Message-ID: <20111207223421.GS3061@janestreet.com>


We don't have anything like Enum.  We do have async streams and pipes,
which are used for stream-based programming.  We played a little with
tricks for writing generic container-related code, but we never found
a big need for it.  Porting something like Enum and adding it to
Core_extended seems like a reasonable thing to do, if someone wants to
propose some code.

y

On 07/12/11 16:54, Ashish Agarwal wrote:
> Is there anything like Batteries' Enum in Core, or some other improvement
> on Stream? I see lazy lists in core-extended, but is that used commonly?
> More generally, what does Jane St use for stream based programming?

-- 
Yaron Minsky


From anil at recoil.org  Sun Dec 11 17:26:34 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Sun, 11 Dec 2011 17:26:34 +0000
Subject: hg <-> git madness
In-Reply-To: <CADKNfh++a+a3+vurNPaR4c-2qpaqh+zt6LOFHApepo1qijTLww@mail.gmail.com>
References: <20111204100505.GA30045@dark.recoil.org>
 <687D2086-E22D-4F53-8265-817B1F4699B4@recoil.org>
 <CADKNfh++a+a3+vurNPaR4c-2qpaqh+zt6LOFHApepo1qijTLww@mail.gmail.com>
Message-ID: <20111211172634.GA29788@dark.recoil.org>


Yeah, that's fair enough. We had exactly the same problem at XenSource,
and ended up using a core open-source repository with a bunch of Mercurial
patch queues to layer the proprietary stuff on.

All in all, I'm a bit surprised that there are no commercial tools that
help with controlling information flow in version control systems
better...

Anil

On Sun, Dec 04, 2011 at 08:06:08AM -0500, Yaron Minsky wrote:
> Not at all!  Glad to have the discussion.
> 
> One thing I wanted to mention that I didn't say on the list: one of the
> reasons we don't want to export lots of history is that we're trying to be
> quite careful about IP issues, and exporting a big complicated history
> makes that virtually impossible.
> 
> y
> 
> On Sun, Dec 4, 2011 at 6:37 AM, Anil Madhavapeddy <anil at recoil.org> wrote:
> 
> > I just re-read this and realised the tone is a little demanding. I didn't
> > intend it that way at all! Just honestly wondering about the best way to
> > make Core a success for all...
> >
> > Begin forwarded message:
> >
> > > This is the real source of my concern.  A public release needs real users
> > > in order to get it off the ground. If Jane Street is keeping an internal
> > > tree, then that means they aren't using the public release, and feeling
> > > the pain of bugs or a lack of documentation.
> > >
> > > Is there any reason not to split out your use of Core into a separate
> > > repository which is suitable for public release, and consumed by your
> > > internal systems?  We did this for Xen via Mercurial patchqueues (held in
> > > a separate repository), to make it clear which the product-local changes
> > > were.
> >
> >

-- 
Anil Madhavapeddy                                 http://anil.recoil.org


From anil at recoil.org  Mon Dec 26 08:20:40 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Mon, 26 Dec 2011 00:20:40 -0800
Subject: version of oasis for core
Message-ID: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>


Which version of OASIS was used to generate the build.ml file in core?

I'm building a packed library that uses type-conv, but the Pack option doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the darcs-trunk also doesnt find it.  Is Core using a custom version or (more likely), what am I missing?

-anil




From anil at recoil.org  Mon Dec 26 16:32:01 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Mon, 26 Dec 2011 08:32:01 -0800
Subject: version of oasis for core
In-Reply-To: <CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org> <CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com> <CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com>
Message-ID: <D12ED7C5-EA00-4EC3-BA70-B4C1736C6037@recoil.org>

The darcs series on the OCamlForge bug (#573) doesn't apply cleanly to the trunk of oasis-dev, so I fixed up the conflicts and have attached the dpatch stream here.  I couldn't figure out how to add a new attachment to the OCamlForge bug (admin only?).

Only lightly tested so far, but it seems to work on cohttp+lwt for me.

-anil


On 26 Dec 2011, at 08:21, Yaron Minsky wrote:

> Indeed.  We have a darcs repo with some extra patches that Till wrote that have yet to be successfully upstreamed.  I know that Till was working with Sylvain, but I'm not sure of the current state of the patches.
> 
> I'm CC'ing Till and Sylvain, in case they know the state of getting those patches in a release.
> 
> y
> 
> On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com> wrote:
> AFAIK Jane Street still uses an internal version of Oasis with
> extensions for packing libraries.
> 
> Regards,
> Markus
> 
> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
> > Which version of OASIS was used to generate the build.ml file in core?
> >
> > I'm building a packed library that uses type-conv, but the Pack option doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the darcs-trunk also doesnt find it.  Is Core using a custom version or (more likely), what am I missing?
> >
> > -anil
> >
> >
> 
> 
> 
> --
> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/83d22db9/attachment.html>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/83d22db9/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: support-for-packed-libraries-_but-not-in-_tags-head.dpatch
Type: application/octet-stream
Size: 44385 bytes
Desc: not available
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/83d22db9/attachment.obj>

From markus.mottl at gmail.com  Mon Dec 26 15:45:01 2011
From: markus.mottl at gmail.com (Markus Mottl)
Date: Mon, 26 Dec 2011 10:45:01 -0500
Subject: version of oasis for core
In-Reply-To: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>
Message-ID: <CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com>


AFAIK Jane Street still uses an internal version of Oasis with
extensions for packing libraries.

Regards,
Markus

On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
> Which version of OASIS was used to generate the build.ml file in core?
>
> I'm building a packed library that uses type-conv, but the Pack option doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the darcs-trunk also doesnt find it. ?Is Core using a custom version or (more likely), what am I missing?
>
> -anil
>
>



-- 
Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com


From yminsky at gmail.com  Mon Dec 26 16:21:41 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Mon, 26 Dec 2011 11:21:41 -0500
Subject: version of oasis for core
In-Reply-To: <CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>
	<CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com>
Message-ID: <CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com>

Indeed.  We have a darcs repo with some extra patches that Till wrote that
have yet to be successfully upstreamed.  I know that Till was working with
Sylvain, but I'm not sure of the current state of the patches.

I'm CC'ing Till and Sylvain, in case they know the state of getting those
patches in a release.

y

On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com>wrote:

> AFAIK Jane Street still uses an internal version of Oasis with
> extensions for packing libraries.
>
> Regards,
> Markus
>
> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
> > Which version of OASIS was used to generate the build.ml file in core?
> >
> > I'm building a packed library that uses type-conv, but the Pack option
> doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the
> darcs-trunk also doesnt find it.  Is Core using a custom version or (more
> likely), what am I missing?
> >
> > -anil
> >
> >
>
>
>
> --
> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/48830a4a/attachment.html>

From ocaml-core+msgappr at googlegroups.com  Mon Dec 26 18:05:05 2011
From: ocaml-core+msgappr at googlegroups.com (ocaml-core)
Date: Mon, 26 Dec 2011 18:05:05 +0000
Subject: ocaml-core - Google Groups: Message Pending [{IPHRrbCOuZzgayoCaWcwAQzKulfL99Yq0}]
Message-ID: <pending-CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>


A message has been sent to the ocaml-core group and is awaiting approval. We've included this message for your review.

The message requires moderation because the user does not have permission to post.

You can approve or reject this message online at:
http://groups.google.com/group/ocaml-core/pendmsg?hl=en_US

or

You can approve this message by replying to this email.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/c3bebf0a/attachment.html>
-------------- next part --------------
An embedded message was scrubbed...
From: unknown sender
Subject: Re: version of oasis for core
Date: Mon, 26 Dec 2011 19:05:05 +0100
Size: 4482
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/c3bebf0a/attachment.mht>

From sylvain at le-gall.net  Mon Dec 26 18:05:05 2011
From: sylvain at le-gall.net (Sylvain Le Gall)
Date: Mon, 26 Dec 2011 19:05:05 +0100
Subject: version of oasis for core
In-Reply-To: <D12ED7C5-EA00-4EC3-BA70-B4C1736C6037@recoil.org>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>
	<CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com>
	<CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com>
	<D12ED7C5-EA00-4EC3-BA70-B4C1736C6037@recoil.org>
Message-ID: <CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>


Hello,

I resume my work on OASIS v0.2.1 recently. I plan to include the
patches provided by Jane Street soon after the release of 0.2.1, for
the 0.3 release. I have no ETA for now.

Anil: Thanks for the update of the patch. I attached the patch to the
bug myself (only admin and submitters can attach files).

Cheers
Sylvain

2011/12/26 Anil Madhavapeddy <anil at recoil.org>:
> The darcs series on the OCamlForge bug (#573) doesn't apply cleanly to the
> trunk of oasis-dev, so I fixed up the conflicts and have attached the dpatch
> stream here. ?I couldn't figure out how to add a new attachment to the
> OCamlForge bug (admin only?).
>
> Only lightly tested so far, but it seems to work on cohttp+lwt for me.
>
> -anil
>
>
>
> On 26 Dec 2011, at 08:21, Yaron Minsky wrote:
>
> Indeed. ?We have a darcs repo with some extra patches that Till wrote that
> have yet to be successfully upstreamed. ?I know that Till was working with
> Sylvain, but I'm not sure of the current state of the patches.
>
> I'm CC'ing Till and Sylvain, in case they know the state of getting those
> patches in a release.
>
> y
>
> On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com>
> wrote:
>>
>> AFAIK Jane Street still uses an internal version of Oasis with
>> extensions for packing libraries.
>>
>> Regards,
>> Markus
>>
>> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
>> > Which version of OASIS was used to generate the build.ml file in core?
>> >
>> > I'm building a packed library that uses type-conv, but the Pack option
>> > doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the
>> > darcs-trunk also doesnt find it. ?Is Core using a custom version or (more
>> > likely), what am I missing?
>> >
>> > -anil
>> >
>> >
>>
>>
>>
>> --
>> Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com
>
>
>
>


From yminsky at gmail.com  Tue Dec 27 03:15:22 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Mon, 26 Dec 2011 22:15:22 -0500
Subject: ocaml-core - Google Groups: Message Pending [{IPHRrbCOuZzgayoCaWcwAQzKulfL99Yq0}]
In-Reply-To: <pending-CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>
References: <pending-CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>
Message-ID: <CADKNfhL4Qt5TjVEy0UH0j+6nNMJTefHCJSMY7+QRP9oZ0KR63w@mail.gmail.com>

On Mon, Dec 26, 2011 at 1:05 PM, ocaml-core <
ocaml-core+msgappr at googlegroups.com> wrote:

>   A message has been sent to the ocaml-core<http://groups.google.com/group/ocaml-core?hl=en_US>group and is awaiting approval. We've included this message for your review.
>
> The message requires moderation because the user does not have permission
> to post.
>
> You can approve or reject<http://groups.google.com/group/ocaml-core/pendmsg?hl=en_US>this message or you can approve this message by replying to this email.
>  [image: Visit Google Groups]
>
> Start <https://groups.google.com/groups/create?hl=en_US&src=email> your
> own group, visit <http://groups.google.com/support/?hl=en_US&src=email>the help center, or
> report <https://groups.google.com/groups/abuse?hl=en_US&src=email> abuse.
>
>
> ---------- Forwarded message ----------
> From: Sylvain Le Gall <sylvain at le-gall.net>
> To: Anil Madhavapeddy <anil at recoil.org>
> Cc: ocaml-core at googlegroups.com, Till Varoquaux <till.varoquaux at gmail.com>
> Date: Mon, 26 Dec 2011 19:05:05 +0100
> Subject: Re: version of oasis for core
> Hello,
>
> I resume my work on OASIS v0.2.1 recently. I plan to include the
> patches provided by Jane Street soon after the release of 0.2.1, for
> the 0.3 release. I have no ETA for now.
>
> Anil: Thanks for the update of the patch. I attached the patch to the
> bug myself (only admin and submitters can attach files).
>
> Cheers
> Sylvain
>
> 2011/12/26 Anil Madhavapeddy <anil at recoil.org>:
> > The darcs series on the OCamlForge bug (#573) doesn't apply cleanly to
> the
> > trunk of oasis-dev, so I fixed up the conflicts and have attached the
> dpatch
> > stream here.  I couldn't figure out how to add a new attachment to the
> > OCamlForge bug (admin only?).
> >
> > Only lightly tested so far, but it seems to work on cohttp+lwt for me.
> >
> > -anil
> >
> >
> >
> > On 26 Dec 2011, at 08:21, Yaron Minsky wrote:
> >
> > Indeed.  We have a darcs repo with some extra patches that Till wrote
> that
> > have yet to be successfully upstreamed.  I know that Till was working
> with
> > Sylvain, but I'm not sure of the current state of the patches.
> >
> > I'm CC'ing Till and Sylvain, in case they know the state of getting those
> > patches in a release.
> >
> > y
> >
> > On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com>
> > wrote:
> >>
> >> AFAIK Jane Street still uses an internal version of Oasis with
> >> extensions for packing libraries.
> >>
> >> Regards,
> >> Markus
> >>
> >> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org>
> wrote:
> >> > Which version of OASIS was used to generate the build.ml file in
> core?
> >> >
> >> > I'm building a packed library that uses type-conv, but the Pack option
> >> > doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the
> >> > darcs-trunk also doesnt find it.  Is Core using a custom version or
> (more
> >> > likely), what am I missing?
> >> >
> >> > -anil
> >> >
> >> >
> >>
> >>
> >>
> >> --
> >> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
> >
> >
> >
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/479f03b8/attachment.html>

From anil at recoil.org  Tue Dec 27 15:18:36 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Tue, 27 Dec 2011 07:18:36 -0800
Subject: version of oasis for core
In-Reply-To: <CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org> <CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com> <CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com> <D12ED7C5-EA00-4EC3-BA70-B4C1736C6037@recoil.org> <CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>
Message-ID: <C3D612E1-433A-40DA-80B2-2251CC37C10F@recoil.org>


Thanks for the update Sylvain; I'm happy enough using the patched version of OASIS for now (since the generated setup.ml can be used without needing it).

One further question about OASIS... how do I pass a '-package lwt.syntax' to an OCamldoc invocation?

This:
Document "cohttp"
  Title:                HTTP protocol library for Lwt
  Type:                 ocamlbuild (0.2)
  BuildTools+:          ocamldoc
  XOCamlbuildPath:      lib
  XOCamlbuildLibraries: cohttp, lwt.syntax

Does not work, as Lwt.syntax is not a local library to the repository.  Core doesn't appear to have any special support for this in its _oasis file.

-anil

On 26 Dec 2011, at 10:05, Sylvain Le Gall wrote:

> Hello,
> 
> I resume my work on OASIS v0.2.1 recently. I plan to include the
> patches provided by Jane Street soon after the release of 0.2.1, for
> the 0.3 release. I have no ETA for now.
> 
> Anil: Thanks for the update of the patch. I attached the patch to the
> bug myself (only admin and submitters can attach files).
> 
> Cheers
> Sylvain
> 
> 2011/12/26 Anil Madhavapeddy <anil at recoil.org>:
>> The darcs series on the OCamlForge bug (#573) doesn't apply cleanly to the
>> trunk of oasis-dev, so I fixed up the conflicts and have attached the dpatch
>> stream here.  I couldn't figure out how to add a new attachment to the
>> OCamlForge bug (admin only?).
>> 
>> Only lightly tested so far, but it seems to work on cohttp+lwt for me.
>> 
>> -anil
>> 
>> 
>> 
>> On 26 Dec 2011, at 08:21, Yaron Minsky wrote:
>> 
>> Indeed.  We have a darcs repo with some extra patches that Till wrote that
>> have yet to be successfully upstreamed.  I know that Till was working with
>> Sylvain, but I'm not sure of the current state of the patches.
>> 
>> I'm CC'ing Till and Sylvain, in case they know the state of getting those
>> patches in a release.
>> 
>> y
>> 
>> On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com>
>> wrote:
>>> 
>>> AFAIK Jane Street still uses an internal version of Oasis with
>>> extensions for packing libraries.
>>> 
>>> Regards,
>>> Markus
>>> 
>>> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
>>>> Which version of OASIS was used to generate the build.ml file in core?
>>>> 
>>>> I'm building a packed library that uses type-conv, but the Pack option
>>>> doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the
>>>> darcs-trunk also doesnt find it.  Is Core using a custom version or (more
>>>> likely), what am I missing?
>>>> 
>>>> -anil
>>>> 
>>>> 
>>> 
>>> 
>>> 
>>> --
>>> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>> 
>> 
>> 
>> 
> 



From ben.mailist at gmail.com  Fri Dec  2 11:03:02 2011
From: ben.mailist at gmail.com (ben mailist)
Date: Fri, 2 Dec 2011 03:03:02 -0800 (PST)
Subject: build error with ocaml-core on mac os x
Message-ID: <17292518.156.1322823782584.JavaMail.geo-discussion-forums@vbmh5>

hi

I successfully installed all the primary dependencies mentioned in INSTALL. 
Same goes for the secondary dependencies like type-conv on which some o the 
primary ones depend on.

My setup:
- core-107.01
- mac os x 10.6.8
- ocaml  3-12.1

Error message:
$ cd core-1.7.01
$ ocaml setup.ml -configure
$ ocaml setup.ml -build
[....]
ocamlfind: Package `type-conv.syntax' not found - required by 
`sexplib.syntax' Command exited with code 2. E: Command 
'/homes/ben/local/bin/ocamlbuild lib/libcore.a lib/dllcore.so lib/core.cma 
lib/core.cmxa lib/core.a lib_test/test_runner.byte -tag debug' terminated 
with error code 10
[....]


Obviously there is a problem with type-conv.syntax not beeing installed:
$ ocamlfind list | grep sexp 
sexplib (version: 6.1.1) 
sexplib.syntax (version: 6.1.1) 
sexplib.top (version: 6.1.1)

$ ocamlfind list | grep conv
type-conv (version: 2.3.0) 

But is this really the problem on type-conv? Sexplib built without any 
errors in this regard.

thanks 
ben


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111202/7b6e24f1/attachment-0001.html>

From ben.mailist at gmail.com  Fri Dec  2 11:18:45 2011
From: ben.mailist at gmail.com (ben mailist)
Date: Fri, 2 Dec 2011 03:18:45 -0800 (PST)
Subject: build error with ocaml-core on mac os x
In-Reply-To: <4ED8B302.8080100@glondu.net>
References: <17292518.156.1322823782584.JavaMail.geo-discussion-forums@vbmh5>
 <4ED8B302.8080100@glondu.net>
Message-ID: <4668457.135.1322824725898.JavaMail.geo-discussion-forums@vbjs5>

wow that was quick, thank you.

Right after my post I did what are you suggesting now. I've reinstalled 
sexplib, since the problem stemmed from an outdated directive in the 
META file of sexplib.

After installing the latest sexplib package, ocaml-core built without any 
problems.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111202/c4619546/attachment-0001.html>

From steph at glondu.net  Fri Dec  2 11:14:10 2011
From: steph at glondu.net (=?UTF-8?B?U3TDqXBoYW5lIEdsb25kdQ==?=)
Date: Fri, 02 Dec 2011 12:14:10 +0100
Subject: build error with ocaml-core on mac os x
In-Reply-To: <17292518.156.1322823782584.JavaMail.geo-discussion-forums@vbmh5>
References: <17292518.156.1322823782584.JavaMail.geo-discussion-forums@vbmh5>
Message-ID: <4ED8B302.8080100@glondu.net>


On 12/02/2011 12:03 PM, ben mailist wrote:
> Obviously there is a problem with type-conv.syntax not beeing installed:
> $ ocamlfind list | grep sexp
> sexplib (version: 6.1.1)
> sexplib.syntax (version: 6.1.1)
> sexplib.top (version: 6.1.1)
> 
> $ ocamlfind list | grep conv
> type-conv (version: 2.3.0)

Try upgrading sexplib and type-conv. I don't know exactly what are the
minimal requirements, but it should compile at least with sexplib 7.0.4
and type-conv 3.0.4).


Cheers,

-- 
St?phane


From yminsky at janestreet.com  Fri Dec  2 23:16:52 2011
From: yminsky at janestreet.com (Yaron Minsky)
Date: Fri, 2 Dec 2011 18:16:52 -0500
Subject: hg <-> git madness
Message-ID: <20111202231652.GB3061@janestreet.com>


We've done most of the work of bridging from internal to external
repos for Core and the related repositories, but we're having a hell
of a time converting from hg to git in a clean way.  We're about to
give up and just host the repos on bitbucket --- we basically like hg
better internally anyway.

Does anyone on the list care that much?  And if you _really_ care, you
can help us build a converter from hg to git....

y

-- 
Yaron Minsky


From yminsky at janestreet.com  Fri Dec  2 23:59:46 2011
From: yminsky at janestreet.com (Yaron Minsky)
Date: Fri, 2 Dec 2011 18:59:46 -0500
Subject: Making Async play better with others
In-Reply-To: <CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
References: <20111031142540.GZ26614@janestreet.com>
 <531e4eac-1d50-4432-8073-7b78ad7d80b0@o9g2000vbc.googlegroups.com>
 <20111122004427.GU7522@janestreet.com>
 <CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
Message-ID: <20111202235946.GH3061@janestreet.com>


Hey Markus.  One thing I wanted to bounce off of you is how you feel
about the idea of us integrating the type-conv suite into the Core
repo.  We'd still release separate tarballs so people could download
just the bits they want.  But we were thinking it would be easier to
manage the coordination with our internal tree if we kept them
together in the repo.

We've basically given up on Git and Github, though Yury is going to
give it one more try.  We've done a preliminary export (the build
isn't set up quite right yet, but the code is all there) on bitbucket.

   https://bitbucket.org/yminsky/ocaml-core

This is cut from trunk and has Stephen's new refactor of Async.  We'll
probably get this through code review in January or February.

We might blow this one away and recreate it on Monday, but I wanted to
give you an early look.

y

On 21/11/11 20:05, Markus Mottl wrote:
> On Mon, Nov 21, 2011 at 19:44, Yaron Minsky <yminsky at janestreet.com> wrote:
> > Yury is hoping to get a proper bridging system for ferrying patches
> > back and forth to github done very soon, say, in another week. ?If we
> > can't get it done, we'll try something simpler as an intermediate
> > step.
> 
> Sounds good, my kids will keep me busy enough in the meanwhile.
> 
> > In any case, we'd be very happy to accept portability patches!
> > Stephen, what do you think about Markus' proposal for how to organize
> > it? ?It's worth noting that this patch might conflict with a patch
> > that Stephen has done internally that reorganizes much of Async's
> > internals to separate out a small core that is independent of all
> > OS-specific code.
> 
> I'd surely prefer using that version.  In case it would take too long
> to wait for the integration, I could apply the trivial changes.  I
> managed to build async on Mac OS X using the preprocessor with them.
> Merging a few lines later doesn't sound like too much of a challenge.
> 
> Regards,
> Markus
> 
> -- 
> Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com

-- 
Yaron Minsky


From yminsky at gmail.com  Sat Dec  3 00:34:41 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Fri, 2 Dec 2011 19:34:41 -0500
Subject: Making Async play better with others
In-Reply-To: <20111202235946.GH3061@janestreet.com>
References: <20111031142540.GZ26614@janestreet.com>
	<531e4eac-1d50-4432-8073-7b78ad7d80b0@o9g2000vbc.googlegroups.com>
	<20111122004427.GU7522@janestreet.com>
	<CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
	<20111202235946.GH3061@janestreet.com>
Message-ID: <CADKNfhKTxKHFYJu4tL490PmYs+mDwvDWnKtiyxoWMGSyh=PWpQ@mail.gmail.com>

Whoops.  Meant to include Markus explicitly in the to-address.
On Dec 2, 2011 6:59 PM, "Yaron Minsky" <yminsky at janestreet.com> wrote:

> Hey Markus.  One thing I wanted to bounce off of you is how you feel
> about the idea of us integrating the type-conv suite into the Core
> repo.  We'd still release separate tarballs so people could download
> just the bits they want.  But we were thinking it would be easier to
> manage the coordination with our internal tree if we kept them
> together in the repo.
>
> We've basically given up on Git and Github, though Yury is going to
> give it one more try.  We've done a preliminary export (the build
> isn't set up quite right yet, but the code is all there) on bitbucket.
>
>   https://bitbucket.org/yminsky/ocaml-core
>
> This is cut from trunk and has Stephen's new refactor of Async.  We'll
> probably get this through code review in January or February.
>
> We might blow this one away and recreate it on Monday, but I wanted to
> give you an early look.
>
> y
>
> On 21/11/11 20:05, Markus Mottl wrote:
> > On Mon, Nov 21, 2011 at 19:44, Yaron Minsky <yminsky at janestreet.com>
> wrote:
> > > Yury is hoping to get a proper bridging system for ferrying patches
> > > back and forth to github done very soon, say, in another week.  If we
> > > can't get it done, we'll try something simpler as an intermediate
> > > step.
> >
> > Sounds good, my kids will keep me busy enough in the meanwhile.
> >
> > > In any case, we'd be very happy to accept portability patches!
> > > Stephen, what do you think about Markus' proposal for how to organize
> > > it?  It's worth noting that this patch might conflict with a patch
> > > that Stephen has done internally that reorganizes much of Async's
> > > internals to separate out a small core that is independent of all
> > > OS-specific code.
> >
> > I'd surely prefer using that version.  In case it would take too long
> > to wait for the integration, I could apply the trivial changes.  I
> > managed to build async on Mac OS X using the preprocessor with them.
> > Merging a few lines later doesn't sound like too much of a challenge.
> >
> > Regards,
> > Markus
> >
> > --
> > Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>
> --
> Yaron Minsky
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111202/47e65228/attachment-0001.html>

From thomas at ocamlpro.com  Sat Dec  3 10:17:03 2011
From: thomas at ocamlpro.com (Thomas Gazagnaire)
Date: Sat, 3 Dec 2011 11:17:03 +0100
Subject: hg <-> git madness
In-Reply-To: <20111202231652.GB3061@janestreet.com>
References: <20111202231652.GB3061@janestreet.com>
Message-ID: <656F4468-4CC9-435A-A111-30A0C66E8A89@ocamlpro.com>

> We've done most of the work of bridging from internal to external
> repos for Core and the related repositories, but we're having a hell
> of a time converting from hg to git in a clean way.  We're about to
> give up and just host the repos on bitbucket --- we basically like hg
> better internally anyway.

What problem are you facing ? I guess you've already tried http://hg-git.github.com/

--
Thomas

> 
> Does anyone on the list care that much?  And if you _really_ care, you
> can help us build a converter from hg to git....
> 
> y
> 
> -- 
> Yaron Minsky

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111203/7356804a/attachment-0001.html>

From yminsky at gmail.com  Sat Dec  3 17:19:53 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sat, 3 Dec 2011 12:19:53 -0500
Subject: hg <-> git madness
In-Reply-To: <20111203161115.GA9686@dark.recoil.org>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
Message-ID: <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>

On Sat, Dec 3, 2011 at 11:11 AM, Anil Madhavapeddy <anil at recoil.org> wrote:

> On Fri, Dec 02, 2011 at 06:16:52PM -0500, Yaron Minsky wrote:
> > We've done most of the work of bridging from internal to external
> > repos for Core and the related repositories, but we're having a hell
> > of a time converting from hg to git in a clean way.  We're about to
> > give up and just host the repos on bitbucket --- we basically like hg
> > better internally anyway.
>
> Going one way from hg->git is pretty trivial, so I presume you mean
> two-way? This can be tricky if you're using branches, as they are quite
> different models between hg/git.


We have no intent on using branches at present (although my understanding
is that hg bookmarks and git branches are pretty damn similar to git
branches.)

Yury was able to get the changes pushed out to git, but hg-git seemed
pretty flaky.  That said, maybe Yury can describe some of the specific
issues he ran into.  We definitely want a two-way bridging process, and the
flakiness of the tool did not give us much confidence.

Do you think it would be worthwhile doing a purely one-way bridge from
bitbucket to github, just to make it easier for more people to follow
along, but to keep serious collaboration to bitbucket?


> > Does anyone on the list care that much?  And if you _really_ care, you
> > can help us build a converter from hg to git....
>
> It would be good to understand what your desired workflow is first, that
> makes it hard.
>

Here's the rough idea.  We have a very big internal repo that has lots of
code that we don't want to export.  But we do want to share some of that
code, and make it possible to integrate work from others into our internal
tree.

We have a piece of software we call a convert daemon, built on top of the
"hg convert" command, that exports our tree after applying some
transformations (mostly dropping files.)  That is used to create the
repository we just put on bitbucket.  The convert daemon can also pull
changesets back over from that repo.  We hope to be able to coordinate with
people using this tool; pulling patches in from the external repo, and
occasionally choosing an internal snapshot to export.

We'd like to be able to do the same thing while peering with github as
well, but for that, we basically need to be able to pull patches back and
forth between github and hg cleanly.  Perhaps with a bit more hacking we
can get hg-git to work properly, and that will provide an adequate solution.


> However, I'm far more interested in seeing code published and outside
> patches being applied, and less with precisely which VCS is being used. If
> Bitbucket makes your workflow easier, put it up there!


I agree getting it out there is the most important thing.  That's why we
got the current version out (although I wouldn't start forking it just yet.
 I think we're going to strip it clean and regenerate it in the next few
days to fix a few problems that showed up.)

y
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111203/5a461d1d/attachment-0001.html>

From ysulsky at gmail.com  Sat Dec  3 18:57:09 2011
From: ysulsky at gmail.com (Yury Sulsky)
Date: Sat, 3 Dec 2011 13:57:09 -0500
Subject: hg <-> git madness
In-Reply-To: <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
Message-ID: <CAEDxudyNPajjjzSLtR31g0zj75Oq4fSsaHgMCxXd1g-5kQYxVg@mail.gmail.com>


On Sat, Dec 3, 2011 at 12:19 PM, Yaron Minsky <yminsky at gmail.com> wrote:
> Yury was able to get the changes pushed out to git, but hg-git seemed pretty
> flaky. ?That said, maybe Yury can describe some of the specific issues he
> ran into. ?We definitely want a two-way bridging process, and the flakiness
> of the tool did not give us much confidence.

Actually, it looks like fast-export
(http://repo.or.cz/w/fast-export.git) works for converting from
mercurial to git with the tools I have installed at home. I haven't
had much success with hg-git, however. Sometimes "hg gexport" creates
a .git folder without any objects, and when it does work, sometimes
the resulting repo isn't cloneable by git.

So if we want to maintain a git version of the tree, it looks like we
have at least three options. If we debug hg-git, we'll have a pretty
seamless bridge between the two. We can also add a git backend to
mercurial's convert extension, and in that case the conversion process
is nice and symmetric. We can also use fast-export to go from
mercurial to git and "hg convert" to go the other way, but there would
be an additional step to make sure that the round trip is idempotent.

If we're okay with just hosting on on Bitbucket, of course all of this
nonsense just goes away :-).

Yury


From yminsky at gmail.com  Sat Dec  3 20:27:17 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sat, 3 Dec 2011 15:27:17 -0500
Subject: hg <-> git madness
In-Reply-To: <CAEDxudyNPajjjzSLtR31g0zj75Oq4fSsaHgMCxXd1g-5kQYxVg@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
	<CAEDxudyNPajjjzSLtR31g0zj75Oq4fSsaHgMCxXd1g-5kQYxVg@mail.gmail.com>
Message-ID: <CADKNfhLx-Nnd2eKc7-gXPofTs=eaHQxqHJ1J11oaymVYT8DwQA@mail.gmail.com>

On Sat, Dec 3, 2011 at 1:57 PM, Yury Sulsky <ysulsky at gmail.com> wrote:

> On Sat, Dec 3, 2011 at 12:19 PM, Yaron Minsky <yminsky at gmail.com> wrote:
> > Yury was able to get the changes pushed out to git, but hg-git seemed
> pretty
> > flaky.  That said, maybe Yury can describe some of the specific issues he
> > ran into.  We definitely want a two-way bridging process, and the
> flakiness
> > of the tool did not give us much confidence.
>
> Actually, it looks like fast-export
> (http://repo.or.cz/w/fast-export.git) works for converting from
> mercurial to git with the tools I have installed at home. I haven't
> had much success with hg-git, however. Sometimes "hg gexport" creates
> a .git folder without any objects, and when it does work, sometimes
> the resulting repo isn't cloneable by git.
>
> So if we want to maintain a git version of the tree, it looks like we
> have at least three options. If we debug hg-git, we'll have a pretty
> seamless bridge between the two. We can also add a git backend to
> mercurial's convert extension, and in that case the conversion process
> is nice and symmetric. We can also use fast-export to go from
> mercurial to git and "hg convert" to go the other way, but there would
> be an additional step to make sure that the round trip is idempotent.
>
> If we're okay with just hosting on on Bitbucket, of course all of this
> nonsense just goes away :-).


Let's focus on getting the repo up at bitbucket in any case.  Then we can
consider adding github to the merge-flow if we can get that part working
cleanly.  But getting it up and available seems like the first step.  And
anyway, leaving it in hg will make 90% of the Jane Street employees
happier, since that's the tool we're all used to.

y
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111203/6989e59a/attachment-0001.html>

From anil at recoil.org  Sat Dec  3 16:11:15 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Sat, 3 Dec 2011 16:11:15 +0000
Subject: hg <-> git madness
In-Reply-To: <20111202231652.GB3061@janestreet.com>
References: <20111202231652.GB3061@janestreet.com>
Message-ID: <20111203161115.GA9686@dark.recoil.org>


On Fri, Dec 02, 2011 at 06:16:52PM -0500, Yaron Minsky wrote:
> We've done most of the work of bridging from internal to external
> repos for Core and the related repositories, but we're having a hell
> of a time converting from hg to git in a clean way.  We're about to
> give up and just host the repos on bitbucket --- we basically like hg
> better internally anyway.

Going one way from hg->git is pretty trivial, so I presume you mean
two-way? This can be tricky if you're using branches, as they are quite
different models between hg/git.

> Does anyone on the list care that much?  And if you _really_ care, you
> can help us build a converter from hg to git....

It would be good to understand what your desired workflow is first, that
makes it hard.

However, I'm far more interested in seeing code published and outside
patches being applied, and less with precisely which VCS is being used. If
Bitbucket makes your workflow easier, put it up there!

-- 
Anil Madhavapeddy                                 http://anil.recoil.org


From yminsky at gmail.com  Sun Dec  4 13:04:29 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sun, 4 Dec 2011 08:04:29 -0500
Subject: hg <-> git madness
In-Reply-To: <20111204100505.GA30045@dark.recoil.org>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
	<20111204100505.GA30045@dark.recoil.org>
Message-ID: <CADKNfhJxrvf5AnpLAeOmp=H+1T_goa278AS=bDeDozLnNFU57w@mail.gmail.com>

On Sun, Dec 4, 2011 at 5:05 AM, Anil Madhavapeddy <anil at recoil.org> wrote:

> On Sat, Dec 03, 2011 at 12:19:53PM -0500, Yaron Minsky wrote:
> > Here's the rough idea.  We have a very big internal repo that has lots of
> > code that we don't want to export.  But we do want to share some of that
> > code, and make it possible to integrate work from others into our
> internal
> > tree.
>
> This is the real source of my concern.  A public release needs real users
> in order to get it off the ground. If Jane Street is keeping an internal
> tree, then that means they aren't using the public release, and feeling
> the pain of bugs or a lack of documentation.
>

It's a fair concern, but I think that our internal development cycle is
going to be quite hard to change in this way.

As for users, it's worth noting that we'll all be users at home!  One of
the big drivers of the public release is to allow people to use Core and
Async for their own personal projects, so we'll have a set of internal
users almost immediately.

As for bugs and documentation, the public release will get the same code
and the same documentation that we get internally (for what that's worth;
the documentation could be better...).  And we'll cut major releases from
the point in history where we have completed a full code-review cycle, so
the quality should be good.

There's no doubt that we'll have to work hard to make sure that externally
developed patches are integrated reasonably.  And I think we'll have to
find a modus vivendi on that, in particular finding a set of external
people who we trust to propose changes before we spend serious time
evaluating those changes.


> Is there any reason not to split out your use of Core into a separate
> repository which is suitable for public release, and consumed by your
> internal systems?  We did this for Xen via Mercurial patchqueues (held in
> a separate repository), to make it clear which the product-local changes
> were.
>
> > I agree getting it out there is the most important thing.  That's why we
> > got the current version out (although I wouldn't start forking it just
> > yet.  I think we're going to strip it clean and regenerate it in the
> > next few days to fix a few problems that showed up.)
>
> Great! Will there be history in the regenerated one? I just see a mega
> commit from ysulky at the moment.


No regenerated history, I'm afraid, and that is not likely to change.

y
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111204/b726468f/attachment-0001.html>

From yminsky at gmail.com  Sun Dec  4 13:06:08 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sun, 4 Dec 2011 08:06:08 -0500
Subject: hg <-> git madness
In-Reply-To: <687D2086-E22D-4F53-8265-817B1F4699B4@recoil.org>
References: <20111204100505.GA30045@dark.recoil.org>
	<687D2086-E22D-4F53-8265-817B1F4699B4@recoil.org>
Message-ID: <CADKNfh++a+a3+vurNPaR4c-2qpaqh+zt6LOFHApepo1qijTLww@mail.gmail.com>

Not at all!  Glad to have the discussion.

One thing I wanted to mention that I didn't say on the list: one of the
reasons we don't want to export lots of history is that we're trying to be
quite careful about IP issues, and exporting a big complicated history
makes that virtually impossible.

y

On Sun, Dec 4, 2011 at 6:37 AM, Anil Madhavapeddy <anil at recoil.org> wrote:

> I just re-read this and realised the tone is a little demanding. I didn't
> intend it that way at all! Just honestly wondering about the best way to
> make Core a success for all...
>
> Begin forwarded message:
>
> > This is the real source of my concern.  A public release needs real users
> > in order to get it off the ground. If Jane Street is keeping an internal
> > tree, then that means they aren't using the public release, and feeling
> > the pain of bugs or a lack of documentation.
> >
> > Is there any reason not to split out your use of Core into a separate
> > repository which is suitable for public release, and consumed by your
> > internal systems?  We did this for Xen via Mercurial patchqueues (held in
> > a separate repository), to make it clear which the product-local changes
> > were.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111204/a34778e2/attachment-0001.html>

From anil at recoil.org  Sun Dec  4 10:05:05 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Sun, 4 Dec 2011 10:05:05 +0000
Subject: hg <-> git madness
In-Reply-To: <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
 <20111203161115.GA9686@dark.recoil.org>
 <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
Message-ID: <20111204100505.GA30045@dark.recoil.org>


On Sat, Dec 03, 2011 at 12:19:53PM -0500, Yaron Minsky wrote:
> 
> We have no intent on using branches at present (although my
> understanding is that hg bookmarks and git branches are pretty damn
> similar to git branches.)
> 
> Yury was able to get the changes pushed out to git, but hg-git seemed
> pretty flaky.  That said, maybe Yury can describe some of the specific
> issues he ran into.  We definitely want a two-way bridging process, and
> the flakiness of the tool did not give us much confidence.
> 
> Do you think it would be worthwhile doing a purely one-way bridge from
> bitbucket to github, just to make it easier for more people to follow
> along, but to keep serious collaboration to bitbucket?

Fast-export has normally been what I've used to go in one direction, but
I've never tried hg-git.

The main advantage of github is actually its public workflow. Pull
requests with code review, a decent issue system, an API good enough for
continuous integration (e.g. the xen-api has a buildbot test a pull
request automatically before it is merged [1][2]). 

Bitbucket looks like it has the same features (the same names, anyway), so
should work well enough if that's what you want.

[1] https://github.com/xen-org/xen-api/pull/406
[2] https://github.com/xen-org/pull-request-manager

> Here's the rough idea.  We have a very big internal repo that has lots of
> code that we don't want to export.  But we do want to share some of that
> code, and make it possible to integrate work from others into our internal
> tree.

This is the real source of my concern.  A public release needs real users
in order to get it off the ground. If Jane Street is keeping an internal
tree, then that means they aren't using the public release, and feeling
the pain of bugs or a lack of documentation.

Is there any reason not to split out your use of Core into a separate
repository which is suitable for public release, and consumed by your
internal systems?  We did this for Xen via Mercurial patchqueues (held in
a separate repository), to make it clear which the product-local changes
were.

> I agree getting it out there is the most important thing.  That's why we
> got the current version out (although I wouldn't start forking it just
> yet.  I think we're going to strip it clean and regenerate it in the
> next few days to fix a few problems that showed up.)

Great! Will there be history in the regenerated one? I just see a mega
commit from ysulky at the moment.

-- 
Anil Madhavapeddy                                 http://anil.recoil.org


From markus.mottl at gmail.com  Sun Dec  4 15:44:13 2011
From: markus.mottl at gmail.com (Markus Mottl)
Date: Sun, 4 Dec 2011 10:44:13 -0500
Subject: Making Async play better with others
In-Reply-To: <20111202235946.GH3061@janestreet.com>
References: <20111031142540.GZ26614@janestreet.com>
	<531e4eac-1d50-4432-8073-7b78ad7d80b0@o9g2000vbc.googlegroups.com>
	<20111122004427.GU7522@janestreet.com>
	<CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
	<20111202235946.GH3061@janestreet.com>
Message-ID: <CAP_800p0EP04NB9zqNAESmu5WfP0=_wT5EfMc3VG7zzJtU-aKA@mail.gmail.com>


Hi Ron,

On Fri, Dec 2, 2011 at 18:59, Yaron Minsky <yminsky at janestreet.com> wrote:
> Hey Markus. ?One thing I wanted to bounce off of you is how you feel
> about the idea of us integrating the type-conv suite into the Core
> repo. ?We'd still release separate tarballs so people could download
> just the bits they want. ?But we were thinking it would be easier to
> manage the coordination with our internal tree if we kept them
> together in the repo.

As long as every sub-project (type-conv, sexplib, bin-prot, etc.) can
build and install completely separately, this should be fine.  The
sub-directories should ideally be identical to what's going into the
release tarballs.  That said, if there is a way to keep things in
separate repos, I'd prefer that solution.

On another note, any news on your commitment to Oasis?  I'm still
holding off on switching my other libraries as long as it's future is
unclear, which mostly depends on whether or not Jane Street will
support it.

Btw., do you have any intentions to release your OMakeroot?  I guess
it might be useful for people who prefer OMake over ocamlbuild.

> We've basically given up on Git and Github, though Yury is going to
> give it one more try. ?We've done a preliminary export (the build
> isn't set up quite right yet, but the code is all there) on bitbucket.
>
> ? https://bitbucket.org/yminsky/ocaml-core
>
> This is cut from trunk and has Stephen's new refactor of Async. ?We'll
> probably get this through code review in January or February.

Indeed, Stephen's golden fingerprints are all over the code ;-).  Nice job!

> We might blow this one away and recreate it on Monday, but I wanted to
> give you an early look.

Looks great, I can't wait to see a public release....

Regards,
Markus

-- 
Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com


From yminsky at gmail.com  Sun Dec  4 16:08:53 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Sun, 4 Dec 2011 11:08:53 -0500
Subject: Making Async play better with others
In-Reply-To: <CAP_800p0EP04NB9zqNAESmu5WfP0=_wT5EfMc3VG7zzJtU-aKA@mail.gmail.com>
References: <20111031142540.GZ26614@janestreet.com>
	<531e4eac-1d50-4432-8073-7b78ad7d80b0@o9g2000vbc.googlegroups.com>
	<20111122004427.GU7522@janestreet.com>
	<CAP_800p5WEHYow9TdmyyKbZmSpFg3C=WorT9W_PfLsaxByrhtQ@mail.gmail.com>
	<20111202235946.GH3061@janestreet.com>
	<CAP_800p0EP04NB9zqNAESmu5WfP0=_wT5EfMc3VG7zzJtU-aKA@mail.gmail.com>
Message-ID: <CADKNfhKM=OaB55Mz2Juju48m=hspKnjByf_RLBQrYXmy39wcSQ@mail.gmail.com>

On Sun, Dec 4, 2011 at 10:44 AM, Markus Mottl <markus.mottl at gmail.com>wrote:

> Hi Ron,
>
> On Fri, Dec 2, 2011 at 18:59, Yaron Minsky <yminsky at janestreet.com> wrote:
> > Hey Markus.  One thing I wanted to bounce off of you is how you feel
> > about the idea of us integrating the type-conv suite into the Core
> > repo.  We'd still release separate tarballs so people could download
> > just the bits they want.  But we were thinking it would be easier to
> > manage the coordination with our internal tree if we kept them
> > together in the repo.
>
> As long as every sub-project (type-conv, sexplib, bin-prot, etc.) can
> build and install completely separately, this should be fine.  The
> sub-directories should ideally be identical to what's going into the
> release tarballs.  That said, if there is a way to keep things in
> separate repos, I'd prefer that solution.
>

Making the sub-directories separately releasable is very much the intent,
and the single-repo approach is much easier for us to keep in sync with our
internal dev process.


> On another note, any news on your commitment to Oasis?  I'm still
> holding off on switching my other libraries as long as it's future is
> unclear, which mostly depends on whether or not Jane Street will
> support it.
>

No news yet, but we're looking at the question.  I think in the end OCaml
needs something along the lines of what oasis provides (i.e., a cabal
clone.)  The question in my mind is whether Oasis is the right tool to get
us there.


> Btw., do you have any intentions to release your OMakeroot?  I guess
> it might be useful for people who prefer OMake over ocamlbuild.


I don't see why not.  Nick Chapman actually just completed a ground-up
rewrite of the rules that greatly simplifies the system and makes it more
efficient and less flaky --- the transdeps hack is now gone, for one thing,
and compilation of big trees is something like 30% faster.  And we also
have a better development mode where we turn off cross-module inlining and
therefore can avoid recompilations after a change that doesn't affect the
interface of a module.

So, I'll talk to Yury and Nick and see if we could include our OMakeroot
and OMakefiles.


> > We've basically given up on Git and Github, though Yury is going to
> > give it one more try.  We've done a preliminary export (the build
> > isn't set up quite right yet, but the code is all there) on bitbucket.
> >
> >   https://bitbucket.org/yminsky/ocaml-core
> >
> > This is cut from trunk and has Stephen's new refactor of Async.  We'll
> > probably get this through code review in January or February.
>
> Indeed, Stephen's golden fingerprints are all over the code ;-).  Nice job!


I do like having that guy around.  Sometimes I think about what our
codebase would be like if we hadn't hired him and I shudder...


> > We might blow this one away and recreate it on Monday, but I wanted to
> > give you an early look.
>
> Looks great, I can't wait to see a public release....
>
> Regards,
> Markus
>
> --
> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111204/d61f74ba/attachment-0001.html>

From anil at recoil.org  Sun Dec  4 11:37:22 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Sun, 4 Dec 2011 11:37:22 +0000
Subject: Fwd: hg <-> git madness
References: <20111204100505.GA30045@dark.recoil.org>
Message-ID: <687D2086-E22D-4F53-8265-817B1F4699B4@recoil.org>


I just re-read this and realised the tone is a little demanding. I didn't intend it that way at all! Just honestly wondering about the best way to make Core a success for all...

Begin forwarded message:

> This is the real source of my concern.  A public release needs real users
> in order to get it off the ground. If Jane Street is keeping an internal
> tree, then that means they aren't using the public release, and feeling
> the pain of bugs or a lack of documentation.
> 
> Is there any reason not to split out your use of Core into a separate
> repository which is suitable for public release, and consumed by your
> internal systems?  We did this for Xen via Mercurial patchqueues (held in
> a separate repository), to make it clear which the product-local changes
> were.



From bfulgham at gmail.com  Mon Dec  5 18:52:31 2011
From: bfulgham at gmail.com (Brent Fulgham)
Date: Mon, 5 Dec 2011 10:52:31 -0800
Subject: hg <-> git madness
In-Reply-To: <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
Message-ID: <CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>


Hi,

On Fri, Dec 02, 2011 at 06:16:52PM -0500, Yaron Minsky wrote:
> We've done most of the work of bridging from internal to external
> repos for Core and the related repositories, but we're having a hell
> of a time converting from hg to git in a clean way. ?We're about to
> give up and just host the repos on bitbucket --- we basically like hg
> better internally anyway.

If you are already using hg internally, why not just go with bitbucket
and avoid the heartache?  I doubt that many people care where the
sources are hosted (I know I don't). I imagine that the bulk of
changes for the forceable future will probably originate within Jane
Street, so anything that lowers the barrier of getting Jane Street
code out to the world at large seems worth whatever minimal cost there
might be for non-mercurial users.

-Brent


From yminsky at janestreet.com  Mon Dec  5 19:19:12 2011
From: yminsky at janestreet.com (Yaron Minsky)
Date: Mon, 5 Dec 2011 14:19:12 -0500
Subject: hg <-> git madness
In-Reply-To: <CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com>
 <20111203161115.GA9686@dark.recoil.org>
 <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
 <CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>
Message-ID: <20111205191912.GH3061@janestreet.com>


On 05/12/11 10:52, Brent Fulgham wrote:
> Hi,
> 
> On Fri, Dec 02, 2011 at 06:16:52PM -0500, Yaron Minsky wrote:
> > We've done most of the work of bridging from internal to external
> > repos for Core and the related repositories, but we're having a hell
> > of a time converting from hg to git in a clean way. ?We're about to
> > give up and just host the repos on bitbucket --- we basically like hg
> > better internally anyway.
> 
> If you are already using hg internally, why not just go with bitbucket
> and avoid the heartache?  I doubt that many people care where the
> sources are hosted (I know I don't). I imagine that the bulk of
> changes for the forceable future will probably originate within Jane
> Street, so anything that lowers the barrier of getting Jane Street
> code out to the world at large seems worth whatever minimal cost there
> might be for non-mercurial users.

I think that's the way we're going at this point.  We might have a
github mirror as well, but I'm not sure it's worth the effort.

y

-- 
Yaron Minsky


From markus.mottl at gmail.com  Mon Dec  5 19:37:33 2011
From: markus.mottl at gmail.com (Markus Mottl)
Date: Mon, 5 Dec 2011 14:37:33 -0500
Subject: hg <-> git madness
In-Reply-To: <20111205191912.GH3061@janestreet.com>
References: <20111202231652.GB3061@janestreet.com>
	<20111203161115.GA9686@dark.recoil.org>
	<CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
	<CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>
	<20111205191912.GH3061@janestreet.com>
Message-ID: <CAP_800oxU=_URFFU0VyfTcYVM1eeZyqxnUGqerhZ-hGBP3=B_A@mail.gmail.com>


On Mon, Dec 5, 2011 at 14:19, Yaron Minsky <yminsky at janestreet.com> wrote:
> I think that's the way we're going at this point. ?We might have a
> github mirror as well, but I'm not sure it's worth the effort.

I don't know how compelling the github features are compared to
bitbucket, but it's hard to imagine the difference matters for most
people.  Even OCamlForge seems decent enough for my purposes, and it
supports both mercurial and git repositories.

Regards,
Markus

-- 
Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com


From agarwal1975 at gmail.com  Mon Dec  5 20:16:36 2011
From: agarwal1975 at gmail.com (Ashish Agarwal)
Date: Mon, 5 Dec 2011 15:16:36 -0500
Subject: hg <-> git madness
In-Reply-To: <CAP_800oxU=_URFFU0VyfTcYVM1eeZyqxnUGqerhZ-hGBP3=B_A@mail.gmail.com>
References: <20111202231652.GB3061@janestreet.com> <20111203161115.GA9686@dark.recoil.org>
 <CADKNfh+jaL4PgFttSbG3F7dZWMDEz3Je96-omneYcdVkFPWcPQ@mail.gmail.com>
 <CAFX-vui65DCDwX9_9oKzO3P39UaAZBpdh6_RLKbtUX=Ks__Aug@mail.gmail.com>
 <20111205191912.GH3061@janestreet.com> <CAP_800oxU=_URFFU0VyfTcYVM1eeZyqxnUGqerhZ-hGBP3=B_A@mail.gmail.com>
Message-ID: <CAMu2m2Jdw-O8+hi08FG2Chh=89w-pcmBcdvCTnXQBUDjsnkdqA@mail.gmail.com>

I'll add my vote too? github is not fundamentally important. Any public
code repository is fine.

On Mon, Dec 5, 2011 at 2:37 PM, Markus Mottl <markus.mottl at gmail.com> wrote:

> On Mon, Dec 5, 2011 at 14:19, Yaron Minsky <yminsky at janestreet.com> wrote:
> > I think that's the way we're going at this point.  We might have a
> > github mirror as well, but I'm not sure it's worth the effort.
>
> I don't know how compelling the github features are compared to
> bitbucket, but it's hard to imagine the difference matters for most
> people.  Even OCamlForge seems decent enough for my purposes, and it
> supports both mercurial and git repositories.
>
> Regards,
> Markus
>
> --
> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111205/732cd05b/attachment-0001.html>

From ocaml-core at googlegroups.com  Tue Dec  6 03:01:34 2011
From: ocaml-core at googlegroups.com (ocaml-core at googlegroups.com)
Date: Tue, 06 Dec 2011 03:01:34 +0000
Subject: Moderator's spam report for ocaml-core@googlegroups.com
Message-ID: <0016367f9f6628ab7e04b363a735@google.com>


This message is being sent to you because you are a moderator of the group ocaml-core.

The following suspicious messages were sent to your group, but are being held in your moderation queue because they are classified as likely spam messages.

If you take no action, all the messages below will be discarded automatically as spam.

However, if you see any messages that are not spam below, you may approve them individually by going to:

http://groups.google.com/group/ocaml-core/pendmsg

Please do not mark this notification as spam; this is a service for group moderators. If you do not wish to receive these notifications in the future, you may change your preferences by going to:

http://groups.google.com/group/ocaml-core/manage_post


------- 1 of 1  -------
Subject: Your e-mail has won $1million
>From: "YAHOO ASIA LOTTERY" <decemberdraw1 at o2.pl>
Date: Dec 05 09:29AM +0100

-- 
YAHOO ASIAN LOTTERY DECEMBER DRAW
Congratulation,
Your email has won $1million For Claim contact.
Mrs.Stella Sun
Email : claimdepartment_my at live.com
Congratulation"""
Yahoo Asian coordinators.


Approve: http://groups.google.com/group/ocaml-core/pendmsg?view=full&pending_id=7079379297301382476


For more information about this message, please visit:
http://groups.google.com/support/bin/answer.py?hl=en&answer=165806



From agarwal1975 at gmail.com  Wed Dec  7 21:54:53 2011
From: agarwal1975 at gmail.com (Ashish Agarwal)
Date: Wed, 7 Dec 2011 16:54:53 -0500
Subject: stream based programming
Message-ID: <CAMu2m2JATDN=m1aZQPKkVXt=5rMevj38U9aXi=GU+ATGoWUQGA@mail.gmail.com>

Is there anything like Batteries' Enum in Core, or some other improvement
on Stream? I see lazy lists in core-extended, but is that used commonly?
More generally, what does Jane St use for stream based programming?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111207/35557c09/attachment-0001.html>

From yminsky at janestreet.com  Wed Dec  7 22:34:21 2011
From: yminsky at janestreet.com (Yaron Minsky)
Date: Wed, 7 Dec 2011 17:34:21 -0500
Subject: stream based programming
In-Reply-To: <CAMu2m2JATDN=m1aZQPKkVXt=5rMevj38U9aXi=GU+ATGoWUQGA@mail.gmail.com>
References: <CAMu2m2JATDN=m1aZQPKkVXt=5rMevj38U9aXi=GU+ATGoWUQGA@mail.gmail.com>
Message-ID: <20111207223421.GS3061@janestreet.com>


We don't have anything like Enum.  We do have async streams and pipes,
which are used for stream-based programming.  We played a little with
tricks for writing generic container-related code, but we never found
a big need for it.  Porting something like Enum and adding it to
Core_extended seems like a reasonable thing to do, if someone wants to
propose some code.

y

On 07/12/11 16:54, Ashish Agarwal wrote:
> Is there anything like Batteries' Enum in Core, or some other improvement
> on Stream? I see lazy lists in core-extended, but is that used commonly?
> More generally, what does Jane St use for stream based programming?

-- 
Yaron Minsky


From anil at recoil.org  Sun Dec 11 17:26:34 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Sun, 11 Dec 2011 17:26:34 +0000
Subject: hg <-> git madness
In-Reply-To: <CADKNfh++a+a3+vurNPaR4c-2qpaqh+zt6LOFHApepo1qijTLww@mail.gmail.com>
References: <20111204100505.GA30045@dark.recoil.org>
 <687D2086-E22D-4F53-8265-817B1F4699B4@recoil.org>
 <CADKNfh++a+a3+vurNPaR4c-2qpaqh+zt6LOFHApepo1qijTLww@mail.gmail.com>
Message-ID: <20111211172634.GA29788@dark.recoil.org>


Yeah, that's fair enough. We had exactly the same problem at XenSource,
and ended up using a core open-source repository with a bunch of Mercurial
patch queues to layer the proprietary stuff on.

All in all, I'm a bit surprised that there are no commercial tools that
help with controlling information flow in version control systems
better...

Anil

On Sun, Dec 04, 2011 at 08:06:08AM -0500, Yaron Minsky wrote:
> Not at all!  Glad to have the discussion.
> 
> One thing I wanted to mention that I didn't say on the list: one of the
> reasons we don't want to export lots of history is that we're trying to be
> quite careful about IP issues, and exporting a big complicated history
> makes that virtually impossible.
> 
> y
> 
> On Sun, Dec 4, 2011 at 6:37 AM, Anil Madhavapeddy <anil at recoil.org> wrote:
> 
> > I just re-read this and realised the tone is a little demanding. I didn't
> > intend it that way at all! Just honestly wondering about the best way to
> > make Core a success for all...
> >
> > Begin forwarded message:
> >
> > > This is the real source of my concern.  A public release needs real users
> > > in order to get it off the ground. If Jane Street is keeping an internal
> > > tree, then that means they aren't using the public release, and feeling
> > > the pain of bugs or a lack of documentation.
> > >
> > > Is there any reason not to split out your use of Core into a separate
> > > repository which is suitable for public release, and consumed by your
> > > internal systems?  We did this for Xen via Mercurial patchqueues (held in
> > > a separate repository), to make it clear which the product-local changes
> > > were.
> >
> >

-- 
Anil Madhavapeddy                                 http://anil.recoil.org


From anil at recoil.org  Mon Dec 26 08:20:40 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Mon, 26 Dec 2011 00:20:40 -0800
Subject: version of oasis for core
Message-ID: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>


Which version of OASIS was used to generate the build.ml file in core?

I'm building a packed library that uses type-conv, but the Pack option doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the darcs-trunk also doesnt find it.  Is Core using a custom version or (more likely), what am I missing?

-anil




From anil at recoil.org  Mon Dec 26 16:32:01 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Mon, 26 Dec 2011 08:32:01 -0800
Subject: version of oasis for core
In-Reply-To: <CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org> <CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com> <CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com>
Message-ID: <D12ED7C5-EA00-4EC3-BA70-B4C1736C6037@recoil.org>

The darcs series on the OCamlForge bug (#573) doesn't apply cleanly to the trunk of oasis-dev, so I fixed up the conflicts and have attached the dpatch stream here.  I couldn't figure out how to add a new attachment to the OCamlForge bug (admin only?).

Only lightly tested so far, but it seems to work on cohttp+lwt for me.

-anil


On 26 Dec 2011, at 08:21, Yaron Minsky wrote:

> Indeed.  We have a darcs repo with some extra patches that Till wrote that have yet to be successfully upstreamed.  I know that Till was working with Sylvain, but I'm not sure of the current state of the patches.
> 
> I'm CC'ing Till and Sylvain, in case they know the state of getting those patches in a release.
> 
> y
> 
> On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com> wrote:
> AFAIK Jane Street still uses an internal version of Oasis with
> extensions for packing libraries.
> 
> Regards,
> Markus
> 
> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
> > Which version of OASIS was used to generate the build.ml file in core?
> >
> > I'm building a packed library that uses type-conv, but the Pack option doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the darcs-trunk also doesnt find it.  Is Core using a custom version or (more likely), what am I missing?
> >
> > -anil
> >
> >
> 
> 
> 
> --
> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/83d22db9/attachment-0002.html>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/83d22db9/attachment-0003.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: support-for-packed-libraries-_but-not-in-_tags-head.dpatch
Type: application/octet-stream
Size: 44385 bytes
Desc: not available
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/83d22db9/attachment-0001.obj>

From markus.mottl at gmail.com  Mon Dec 26 15:45:01 2011
From: markus.mottl at gmail.com (Markus Mottl)
Date: Mon, 26 Dec 2011 10:45:01 -0500
Subject: version of oasis for core
In-Reply-To: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>
Message-ID: <CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com>


AFAIK Jane Street still uses an internal version of Oasis with
extensions for packing libraries.

Regards,
Markus

On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
> Which version of OASIS was used to generate the build.ml file in core?
>
> I'm building a packed library that uses type-conv, but the Pack option doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the darcs-trunk also doesnt find it. ?Is Core using a custom version or (more likely), what am I missing?
>
> -anil
>
>



-- 
Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com


From yminsky at gmail.com  Mon Dec 26 16:21:41 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Mon, 26 Dec 2011 11:21:41 -0500
Subject: version of oasis for core
In-Reply-To: <CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>
	<CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com>
Message-ID: <CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com>

Indeed.  We have a darcs repo with some extra patches that Till wrote that
have yet to be successfully upstreamed.  I know that Till was working with
Sylvain, but I'm not sure of the current state of the patches.

I'm CC'ing Till and Sylvain, in case they know the state of getting those
patches in a release.

y

On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com>wrote:

> AFAIK Jane Street still uses an internal version of Oasis with
> extensions for packing libraries.
>
> Regards,
> Markus
>
> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
> > Which version of OASIS was used to generate the build.ml file in core?
> >
> > I'm building a packed library that uses type-conv, but the Pack option
> doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the
> darcs-trunk also doesnt find it.  Is Core using a custom version or (more
> likely), what am I missing?
> >
> > -anil
> >
> >
>
>
>
> --
> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/48830a4a/attachment-0001.html>

From ocaml-core+msgappr at googlegroups.com  Mon Dec 26 18:05:05 2011
From: ocaml-core+msgappr at googlegroups.com (ocaml-core)
Date: Mon, 26 Dec 2011 18:05:05 +0000
Subject: ocaml-core - Google Groups: Message Pending [{IPHRrbCOuZzgayoCaWcwAQzKulfL99Yq0}]
Message-ID: <pending-CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>


A message has been sent to the ocaml-core group and is awaiting approval. We've included this message for your review.

The message requires moderation because the user does not have permission to post.

You can approve or reject this message online at:
http://groups.google.com/group/ocaml-core/pendmsg?hl=en_US

or

You can approve this message by replying to this email.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/c3bebf0a/attachment-0001.html>
-------------- next part --------------
An embedded message was scrubbed...
From: unknown sender
Subject: Re: version of oasis for core
Date: Mon, 26 Dec 2011 19:05:05 +0100
Size: 4482
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/c3bebf0a/attachment-0001.mht>

From sylvain at le-gall.net  Mon Dec 26 18:05:05 2011
From: sylvain at le-gall.net (Sylvain Le Gall)
Date: Mon, 26 Dec 2011 19:05:05 +0100
Subject: version of oasis for core
In-Reply-To: <D12ED7C5-EA00-4EC3-BA70-B4C1736C6037@recoil.org>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org>
	<CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com>
	<CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com>
	<D12ED7C5-EA00-4EC3-BA70-B4C1736C6037@recoil.org>
Message-ID: <CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>


Hello,

I resume my work on OASIS v0.2.1 recently. I plan to include the
patches provided by Jane Street soon after the release of 0.2.1, for
the 0.3 release. I have no ETA for now.

Anil: Thanks for the update of the patch. I attached the patch to the
bug myself (only admin and submitters can attach files).

Cheers
Sylvain

2011/12/26 Anil Madhavapeddy <anil at recoil.org>:
> The darcs series on the OCamlForge bug (#573) doesn't apply cleanly to the
> trunk of oasis-dev, so I fixed up the conflicts and have attached the dpatch
> stream here. ?I couldn't figure out how to add a new attachment to the
> OCamlForge bug (admin only?).
>
> Only lightly tested so far, but it seems to work on cohttp+lwt for me.
>
> -anil
>
>
>
> On 26 Dec 2011, at 08:21, Yaron Minsky wrote:
>
> Indeed. ?We have a darcs repo with some extra patches that Till wrote that
> have yet to be successfully upstreamed. ?I know that Till was working with
> Sylvain, but I'm not sure of the current state of the patches.
>
> I'm CC'ing Till and Sylvain, in case they know the state of getting those
> patches in a release.
>
> y
>
> On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com>
> wrote:
>>
>> AFAIK Jane Street still uses an internal version of Oasis with
>> extensions for packing libraries.
>>
>> Regards,
>> Markus
>>
>> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
>> > Which version of OASIS was used to generate the build.ml file in core?
>> >
>> > I'm building a packed library that uses type-conv, but the Pack option
>> > doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the
>> > darcs-trunk also doesnt find it. ?Is Core using a custom version or (more
>> > likely), what am I missing?
>> >
>> > -anil
>> >
>> >
>>
>>
>>
>> --
>> Markus Mottl? ? ? ? http://www.ocaml.info? ? ? ? markus.mottl at gmail.com
>
>
>
>


From yminsky at gmail.com  Tue Dec 27 03:15:22 2011
From: yminsky at gmail.com (Yaron Minsky)
Date: Mon, 26 Dec 2011 22:15:22 -0500
Subject: ocaml-core - Google Groups: Message Pending [{IPHRrbCOuZzgayoCaWcwAQzKulfL99Yq0}]
In-Reply-To: <pending-CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>
References: <pending-CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>
Message-ID: <CADKNfhL4Qt5TjVEy0UH0j+6nNMJTefHCJSMY7+QRP9oZ0KR63w@mail.gmail.com>

On Mon, Dec 26, 2011 at 1:05 PM, ocaml-core <
ocaml-core+msgappr at googlegroups.com> wrote:

>   A message has been sent to the ocaml-core<http://groups.google.com/group/ocaml-core?hl=en_US>group and is awaiting approval. We've included this message for your review.
>
> The message requires moderation because the user does not have permission
> to post.
>
> You can approve or reject<http://groups.google.com/group/ocaml-core/pendmsg?hl=en_US>this message or you can approve this message by replying to this email.
>  [image: Visit Google Groups]
>
> Start <https://groups.google.com/groups/create?hl=en_US&src=email> your
> own group, visit <http://groups.google.com/support/?hl=en_US&src=email>the help center, or
> report <https://groups.google.com/groups/abuse?hl=en_US&src=email> abuse.
>
>
> ---------- Forwarded message ----------
> From: Sylvain Le Gall <sylvain at le-gall.net>
> To: Anil Madhavapeddy <anil at recoil.org>
> Cc: ocaml-core at googlegroups.com, Till Varoquaux <till.varoquaux at gmail.com>
> Date: Mon, 26 Dec 2011 19:05:05 +0100
> Subject: Re: version of oasis for core
> Hello,
>
> I resume my work on OASIS v0.2.1 recently. I plan to include the
> patches provided by Jane Street soon after the release of 0.2.1, for
> the 0.3 release. I have no ETA for now.
>
> Anil: Thanks for the update of the patch. I attached the patch to the
> bug myself (only admin and submitters can attach files).
>
> Cheers
> Sylvain
>
> 2011/12/26 Anil Madhavapeddy <anil at recoil.org>:
> > The darcs series on the OCamlForge bug (#573) doesn't apply cleanly to
> the
> > trunk of oasis-dev, so I fixed up the conflicts and have attached the
> dpatch
> > stream here.  I couldn't figure out how to add a new attachment to the
> > OCamlForge bug (admin only?).
> >
> > Only lightly tested so far, but it seems to work on cohttp+lwt for me.
> >
> > -anil
> >
> >
> >
> > On 26 Dec 2011, at 08:21, Yaron Minsky wrote:
> >
> > Indeed.  We have a darcs repo with some extra patches that Till wrote
> that
> > have yet to be successfully upstreamed.  I know that Till was working
> with
> > Sylvain, but I'm not sure of the current state of the patches.
> >
> > I'm CC'ing Till and Sylvain, in case they know the state of getting those
> > patches in a release.
> >
> > y
> >
> > On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com>
> > wrote:
> >>
> >> AFAIK Jane Street still uses an internal version of Oasis with
> >> extensions for packing libraries.
> >>
> >> Regards,
> >> Markus
> >>
> >> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org>
> wrote:
> >> > Which version of OASIS was used to generate the build.ml file in
> core?
> >> >
> >> > I'm building a packed library that uses type-conv, but the Pack option
> >> > doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the
> >> > darcs-trunk also doesnt find it.  Is Core using a custom version or
> (more
> >> > likely), what am I missing?
> >> >
> >> > -anil
> >> >
> >> >
> >>
> >>
> >>
> >> --
> >> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
> >
> >
> >
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/core/attachments/20111226/479f03b8/attachment-0001.html>

From anil at recoil.org  Tue Dec 27 15:18:36 2011
From: anil at recoil.org (Anil Madhavapeddy)
Date: Tue, 27 Dec 2011 07:18:36 -0800
Subject: version of oasis for core
In-Reply-To: <CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>
References: <FF338534-7022-46D7-84E5-BC7A1D914EFB@recoil.org> <CAP_800oT-VAJVVM+9CWmH5OonRL=CeUq-pbg6L3w0uerU4_zkQ@mail.gmail.com> <CADKNfhJUUvp2tXyda3EFPsy_Eq-6oPrBskX65Tq5mb9iLtZp8Q@mail.gmail.com> <D12ED7C5-EA00-4EC3-BA70-B4C1736C6037@recoil.org> <CAOCAUGPODRnfUaVJikeu8pSBK-vYL6fFpjS6r2Y+G4UjJK3-+A@mail.gmail.com>
Message-ID: <C3D612E1-433A-40DA-80B2-2251CC37C10F@recoil.org>


Thanks for the update Sylvain; I'm happy enough using the patched version of OASIS for now (since the generated setup.ml can be used without needing it).

One further question about OASIS... how do I pass a '-package lwt.syntax' to an OCamldoc invocation?

This:
Document "cohttp"
  Title:                HTTP protocol library for Lwt
  Type:                 ocamlbuild (0.2)
  BuildTools+:          ocamldoc
  XOCamlbuildPath:      lib
  XOCamlbuildLibraries: cohttp, lwt.syntax

Does not work, as Lwt.syntax is not a local library to the repository.  Core doesn't appear to have any special support for this in its _oasis file.

-anil

On 26 Dec 2011, at 10:05, Sylvain Le Gall wrote:

> Hello,
> 
> I resume my work on OASIS v0.2.1 recently. I plan to include the
> patches provided by Jane Street soon after the release of 0.2.1, for
> the 0.3 release. I have no ETA for now.
> 
> Anil: Thanks for the update of the patch. I attached the patch to the
> bug myself (only admin and submitters can attach files).
> 
> Cheers
> Sylvain
> 
> 2011/12/26 Anil Madhavapeddy <anil at recoil.org>:
>> The darcs series on the OCamlForge bug (#573) doesn't apply cleanly to the
>> trunk of oasis-dev, so I fixed up the conflicts and have attached the dpatch
>> stream here.  I couldn't figure out how to add a new attachment to the
>> OCamlForge bug (admin only?).
>> 
>> Only lightly tested so far, but it seems to work on cohttp+lwt for me.
>> 
>> -anil
>> 
>> 
>> 
>> On 26 Dec 2011, at 08:21, Yaron Minsky wrote:
>> 
>> Indeed.  We have a darcs repo with some extra patches that Till wrote that
>> have yet to be successfully upstreamed.  I know that Till was working with
>> Sylvain, but I'm not sure of the current state of the patches.
>> 
>> I'm CC'ing Till and Sylvain, in case they know the state of getting those
>> patches in a release.
>> 
>> y
>> 
>> On Mon, Dec 26, 2011 at 10:45 AM, Markus Mottl <markus.mottl at gmail.com>
>> wrote:
>>> 
>>> AFAIK Jane Street still uses an internal version of Oasis with
>>> extensions for packing libraries.
>>> 
>>> Regards,
>>> Markus
>>> 
>>> On Mon, Dec 26, 2011 at 03:20, Anil Madhavapeddy <anil at recoil.org> wrote:
>>>> Which version of OASIS was used to generate the build.ml file in core?
>>>> 
>>>> I'm building a packed library that uses type-conv, but the Pack option
>>>> doesnt seem to be recognised (0.2.1alpha OASIS), and a grep of the
>>>> darcs-trunk also doesnt find it.  Is Core using a custom version or (more
>>>> likely), what am I missing?
>>>> 
>>>> -anil
>>>> 
>>>> 
>>> 
>>> 
>>> 
>>> --
>>> Markus Mottl        http://www.ocaml.info        markus.mottl at gmail.com
>> 
>> 
>> 
>> 
> 



