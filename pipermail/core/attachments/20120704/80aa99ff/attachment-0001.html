<tt>
That's&nbsp;true&nbsp;for&nbsp;the&nbsp;upon&nbsp;in&nbsp;'start',&nbsp;but&nbsp;not&nbsp;for&nbsp;the&nbsp;other&nbsp;two&nbsp;in&nbsp;'loop'.&nbsp;You&nbsp;do&nbsp;wait&nbsp;on&nbsp;those&nbsp;deferreds&nbsp;to&nbsp;continue,&nbsp;you're&nbsp;just&nbsp;using&nbsp;upon&nbsp;to&nbsp;get&nbsp;the&nbsp;unit&nbsp;type&nbsp;you&nbsp;want.&nbsp;I&nbsp;think&nbsp;what&nbsp;you&nbsp;really&nbsp;want&nbsp;to&nbsp;be&nbsp;doing&nbsp;is&nbsp;calling&nbsp;&quot;whenever&nbsp;(Stream.iter'&nbsp;...)&quot;&nbsp;in&nbsp;'start',&nbsp;since&nbsp;you're&nbsp;basically&nbsp;implementing&nbsp;Stream.iter&nbsp;yourself&nbsp;with&nbsp;'loop'&nbsp;anyway.&nbsp;Whenever&nbsp;is&nbsp;like&nbsp;the&nbsp;standard&nbsp;ignore&nbsp;function,&nbsp;except&nbsp;it&nbsp;only&nbsp;takes&nbsp;things&nbsp;if&nbsp;type&nbsp;unit&nbsp;deferred.&lt;br&gt;&lt;br&gt;You&nbsp;also&nbsp;definitely&nbsp;want&nbsp;a&nbsp;map&nbsp;instead&nbsp;of&nbsp;bind&nbsp;in&nbsp;'start'.&lt;br&gt;&lt;br&gt;As&nbsp;I&nbsp;was&nbsp;saying&nbsp;before&nbsp;(or&nbsp;maybe&nbsp;as&nbsp;I&nbsp;meant&nbsp;to&nbsp;say&nbsp;before),&nbsp;using&nbsp;upon&nbsp;and&nbsp;things&nbsp;like&nbsp;raw&nbsp;ivars&nbsp;a&nbsp;lot&nbsp;isn't&nbsp;necessarily&nbsp;wrong,&nbsp;but&nbsp;it&nbsp;does&nbsp;suggest&nbsp;that&nbsp;you're&nbsp;working&nbsp;at&nbsp;a&nbsp;lower&nbsp;level&nbsp;of&nbsp;abstraction&nbsp;than&nbsp;is&nbsp;usually&nbsp;necessary.&lt;br&gt;
</tt>
