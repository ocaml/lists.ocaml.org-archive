From Xavier.Leroy at inria.fr  Mon Sep  5 08:01:04 2016
From: Xavier.Leroy at inria.fr (Xavier Leroy)
Date: Mon, 5 Sep 2016 09:01:04 +0200
Subject: [ocaml-infra] expiration SSL certificate
Message-ID: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>

Dear all,

Gandi informs me that the SSL certificate for the ocaml.org domain
expires in 14 days, on 2016-09-20 01:59.

If you need me to do something with Gandi in order to renew this
certificate, do let me know ASAP.

Kind regards,

- Xavier Leroy

From francois.bobot at cea.fr  Mon Sep  5 12:29:54 2016
From: francois.bobot at cea.fr (=?UTF-8?Q?Fran=c3=a7ois_Bobot?=)
Date: Mon, 5 Sep 2016 13:29:54 +0200
Subject: [ocaml-infra] expiration SSL certificate
In-Reply-To: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
Message-ID: <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>

On 05/09/2016 09:01, Xavier Leroy wrote:
> Gandi informs me that the SSL certificate for the ocaml.org domain
> expires in 14 days, on 2016-09-20 01:59.
>
> If you need me to do something with Gandi in order to renew this
> certificate, do let me know ASAP.
>

I used https://letsencrypt.org/ for getting free SSL certificate for frama-c.com (bts.,git.,...) and 
it worked very well. There is even a debian package.

My two cents,

-- 
Fran?ois

From agarwal1975 at gmail.com  Wed Sep  7 15:21:04 2016
From: agarwal1975 at gmail.com (Ashish Agarwal)
Date: Wed, 7 Sep 2016 10:21:04 -0400
Subject: [ocaml-infra] expiration SSL certificate
In-Reply-To: <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
Message-ID: <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>

IIRC, this was particularly relevant for the opam sub-domain, so cc-ing the
opam-devel list. Can any opam dev please confirm. If it is still needed, we
should act quick to update this.

On Mon, Sep 5, 2016 at 7:29 AM, Fran?ois Bobot <francois.bobot at cea.fr>
wrote:

> On 05/09/2016 09:01, Xavier Leroy wrote:
>
>> Gandi informs me that the SSL certificate for the ocaml.org domain
>> expires in 14 days, on 2016-09-20 01:59.
>>
>> If you need me to do something with Gandi in order to renew this
>> certificate, do let me know ASAP.
>>
>>
> I used https://letsencrypt.org/ for getting free SSL certificate for
> frama-c.com (bts.,git.,...) and it worked very well. There is even a
> debian package.
>
> My two cents,
>
> --
> Fran?ois
>
> _______________________________________________
> Infrastructure mailing list
> Infrastructure at lists.ocaml.org
> http://lists.ocaml.org/listinfo/infrastructure
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/infrastructure/attachments/20160907/24e07f58/attachment.html>

From Xavier.Leroy at inria.fr  Sat Sep 10 15:42:00 2016
From: Xavier.Leroy at inria.fr (Xavier Leroy)
Date: Sat, 10 Sep 2016 16:42:00 +0200
Subject: [ocaml-infra] expiration SSL certificate
In-Reply-To: <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
Message-ID: <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>

On 09/07/2016 04:21 PM, Ashish Agarwal wrote:
> IIRC, this was particularly relevant for the opam sub-domain, so cc-ing the
> opam-devel list. Can any opam dev please confirm. If it is still needed, we
> should act quick to update this.

I'm positive you need secure connections for lists.ocaml.org as well
(to protect the passwords of list administrators and subscribers).

Now that Anil is a successful businessman, who is administering the
*.ocaml.org Web servers and DNS ?

FYI, if you go the Gandi renewal way, it costs 200 Eur for 3 years,
and one of the three validation methods below may have to be
implemented.

- Xavier Leroy

Validation by DNS record Validation by DNS record implies that you have
access to the DNS zone file of your domain, and can add a record to it. If
you opt for this method, the record to be inserted into the zone will be
displayed on the following page.

Validation by email This validation method is simple, though requires that
you have an email address available for for each domain validated. This
email address must be created with the user admin@ (ex.: if you want to
validate the domain example.com, you must create the email address
admin at example.com). If you did not get the validation email, go to your
validation status interface and relaunch the sending of the verification emails.

Validation by file This validation method requires that you have access to
the server that hosts the website that the domain will point to. You are
asked to copy a TXT file that contains a verification key, and to place it
at the root directory of the website. If you don't have the hosting set up
for your site, or if you don't have access to the root directory, then
choose another validation method. Warning: Your .TXT file should only be
available through HTTP. The validation will not work with HTTPS redirection.

> 
> On Mon, Sep 5, 2016 at 7:29 AM, Fran?ois Bobot <francois.bobot at cea.fr
> <mailto:francois.bobot at cea.fr>> wrote:
> 
>     On 05/09/2016 09:01, Xavier Leroy wrote:
> 
>         Gandi informs me that the SSL certificate for the ocaml.org
>         <http://ocaml.org> domain
>         expires in 14 days, on 2016-09-20 01:59.
> 
>         If you need me to do something with Gandi in order to renew this
>         certificate, do let me know ASAP.
> 
> 
>     I used https://letsencrypt.org/ for getting free SSL certificate for
>     frama-c.com <http://frama-c.com> (bts.,git.,...) and it worked very
>     well. There is even a debian package.
> 
>     My two cents,
> 
>     -- 
>     Fran?ois
> 
>     _______________________________________________
>     Infrastructure mailing list
>     Infrastructure at lists.ocaml.org <mailto:Infrastructure at lists.ocaml.org>
>     http://lists.ocaml.org/listinfo/infrastructure
>     <http://lists.ocaml.org/listinfo/infrastructure>
> 
> 
> 
> 
> _______________________________________________
> Infrastructure mailing list
> Infrastructure at lists.ocaml.org
> http://lists.ocaml.org/listinfo/infrastructure
> 


From anil at recoil.org  Tue Sep 13 09:51:00 2016
From: anil at recoil.org (Anil Madhavapeddy)
Date: Tue, 13 Sep 2016 09:51:00 +0100
Subject: [ocaml-infra] expiration SSL certificate
In-Reply-To: <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
Message-ID: <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>

On 10 Sep 2016, at 15:42, Xavier Leroy <Xavier.Leroy at inria.fr> wrote:
> 
> On 09/07/2016 04:21 PM, Ashish Agarwal wrote:
>> IIRC, this was particularly relevant for the opam sub-domain, so cc-ing the
>> opam-devel list. Can any opam dev please confirm. If it is still needed, we
>> should act quick to update this.
> 
> I'm positive you need secure connections for lists.ocaml.org as well
> (to protect the passwords of list administrators and subscribers).

That's correct -- the current Gandi SSL certificate had a few subdomains to
deal with as well, so all of those need to be renewed.

I've been experimenting with Letsencrypt on a few other domains, and it
is mostly working fine except that certificates are only issued for 90 days.
This means that it's essential to implement autorenewal via the Acme API,
or else domains will expire rather rapidly.

This is generally a good excuse to examine the state of the various
infrastructures to determine how auto-update friendly they all are. There
is an ocaml-acme client under development at:
https://github.com/mmaker/ocaml-acme
...but it requires a release of OCaml-X509 to expose some extra CSR
information.  Hannes, is there a release of that scheduled, or should I
look at an alternative mechanism for our auto-updated certs?

> Now that Anil is a successful businessman, who is administering the
> *.ocaml.org Web servers and DNS ?

Happily, this businessman is still administering the servers, albeit with
a slightly higher latency...

regards,
Anil

From daniel.buenzli at erratique.ch  Tue Sep 13 10:15:51 2016
From: daniel.buenzli at erratique.ch (=?utf-8?Q?Daniel_B=C3=BCnzli?=)
Date: Tue, 13 Sep 2016 11:15:51 +0200
Subject: [ocaml-infra] [opam-devel]  expiration SSL certificate
In-Reply-To: <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
Message-ID: <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>



On Tuesday 13 September 2016 at 10:51, Anil Madhavapeddy wrote:

> There is an ocaml-acme client under development at:
> https://github.com/mmaker/ocaml-acme

Had a look at this. It seems rather toyish at the moment and makes me wonder a bit about programmers building security infrastructure on top of libraries with obvious security risks...

Daniel

From anil at recoil.org  Tue Sep 13 10:26:40 2016
From: anil at recoil.org (Anil Madhavapeddy)
Date: Tue, 13 Sep 2016 10:26:40 +0100
Subject: [ocaml-infra] [opam-devel]  expiration SSL certificate
In-Reply-To: <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
Message-ID: <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>

On 13 Sep 2016, at 10:15, Daniel B?nzli <daniel.buenzli at erratique.ch> wrote:
> 
> On Tuesday 13 September 2016 at 10:51, Anil Madhavapeddy wrote:
> 
>> There is an ocaml-acme client under development at:
>> https://github.com/mmaker/ocaml-acme
> 
> Had a look at this. It seems rather toyish at the moment and makes me wonder a bit about programmers building security infrastructure on top of libraries with obvious security risks...

Is there something specific in OCaml-Acme that worries you, or is this a general existential crisis about the state of software security that you are experiencing?

Anil

From anil at recoil.org  Tue Sep 13 10:35:39 2016
From: anil at recoil.org (Anil Madhavapeddy)
Date: Tue, 13 Sep 2016 10:35:39 +0100
Subject: [ocaml-infra] [opam-devel]  expiration SSL certificate
In-Reply-To: <4CA461C9-CC0C-4A9D-87D2-5C328AE8F23A@gmail.com>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <4CA461C9-CC0C-4A9D-87D2-5C328AE8F23A@gmail.com>
Message-ID: <3A8843A2-CAB6-4ADE-AE9B-B278BB728D0E@recoil.org>

On 13 Sep 2016, at 10:31, Michael Gr?newald <michipili at gmail.com> wrote:
> 
> 
>> On 13 Sep 2016, at 11:26, Anil Madhavapeddy <anil at recoil.org> wrote:
>> 
>> On 13 Sep 2016, at 10:15, Daniel B?nzli <daniel.buenzli at erratique.ch> wrote:
>>> 
>>> Had a look at this. It seems rather toyish at the moment and makes me wonder a bit about programmers building security infrastructure on top of libraries with obvious security risks...
>> 
>> Is there something specific in OCaml-Acme that worries you, or is this a general existential crisis about the state of software security that you are experiencing?
> 
> Could we relax a bit?  It?s only Tuesday. ;)

I'm perfectly relaxed, thank you. Daniel is pretty good at spotting fatal flaws in software, so I'd like to clarify his opinion before reconstructing our SSL infrastructure.

Xavier, it may be better just to renew with Gandi TLS for another year, to give us a bit more time to move over to a properly rotated Letsencrypt.org base over the course of the year.

regards,
Anil

From daniel.buenzli at erratique.ch  Tue Sep 13 10:36:43 2016
From: daniel.buenzli at erratique.ch (=?utf-8?Q?Daniel_B=C3=BCnzli?=)
Date: Tue, 13 Sep 2016 11:36:43 +0200
Subject: [ocaml-infra] [opam-devel]  expiration SSL certificate
In-Reply-To: <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
Message-ID: <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>

On Tuesday 13 September 2016 at 11:26, Anil Madhavapeddy wrote:
> Is there something specific in OCaml-Acme that worries you, or is this a general existential crisis about the state of software security that you are experiencing?

Only waiting for people being sorry for using a library that doesn't check the validity of the underlying encoding it is supposed to assert.

Best,

Daniel



From sheets at alum.mit.edu  Tue Sep 13 11:14:49 2016
From: sheets at alum.mit.edu (David Sheets)
Date: Tue, 13 Sep 2016 11:14:49 +0100
Subject: [ocaml-infra] [opam-devel] expiration SSL certificate
In-Reply-To: <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
Message-ID: <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>

On Tue, Sep 13, 2016 at 10:36 AM, Daniel B?nzli
<daniel.buenzli at erratique.ch> wrote:
> On Tuesday 13 September 2016 at 11:26, Anil Madhavapeddy wrote:
>> Is there something specific in OCaml-Acme that worries you, or is this a general existential crisis about the state of software security that you are experiencing?
>
> Only waiting for people being sorry for using a library that doesn't check the validity of the underlying encoding it is supposed to assert.

Hi Daniel,

Could you please direct us to the bug report about this issue?

Thanks,

David

> Best,
>
> Daniel
>
>
> _______________________________________________
> Infrastructure mailing list
> Infrastructure at lists.ocaml.org
> http://lists.ocaml.org/listinfo/infrastructure

From daniel.buenzli at erratique.ch  Tue Sep 13 11:33:18 2016
From: daniel.buenzli at erratique.ch (=?utf-8?Q?Daniel_B=C3=BCnzli?=)
Date: Tue, 13 Sep 2016 12:33:18 +0200
Subject: [ocaml-infra] [opam-devel] expiration SSL certificate
In-Reply-To: <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
 <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
Message-ID: <609F6373C58A4F25839478881A966439@erratique.ch>

On Tuesday 13 September 2016 at 12:14, David Sheets wrote:
> Could you please direct us to the bug report about this issue?

There no bug to be reported, it's by design. You should read the documentation of the libraries you are using. 

Best,

Daniel

From sheets at alum.mit.edu  Tue Sep 13 11:34:54 2016
From: sheets at alum.mit.edu (David Sheets)
Date: Tue, 13 Sep 2016 11:34:54 +0100
Subject: [ocaml-infra] [opam-devel] expiration SSL certificate
In-Reply-To: <609F6373C58A4F25839478881A966439@erratique.ch>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
 <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
 <609F6373C58A4F25839478881A966439@erratique.ch>
Message-ID: <CAAWM5Tzw-6tu6Pg2Q4Hw6k5CxiwV1PuWAgMS4RFS_zw2v=a+pQ@mail.gmail.com>

On Tue, Sep 13, 2016 at 11:33 AM, Daniel B?nzli
<daniel.buenzli at erratique.ch> wrote:
> On Tuesday 13 September 2016 at 12:14, David Sheets wrote:
>> Could you please direct us to the bug report about this issue?
>
> There no bug to be reported, it's by design. You should read the documentation of the libraries you are using.

Could you please elaborate on the design problem? I believe the
project has an issue tracker where you can report constructive
feedback about any design issues you encounter.

> Best,
>
> Daniel

From daniel.buenzli at erratique.ch  Tue Sep 13 11:45:10 2016
From: daniel.buenzli at erratique.ch (=?utf-8?Q?Daniel_B=C3=BCnzli?=)
Date: Tue, 13 Sep 2016 12:45:10 +0200
Subject: [ocaml-infra] [opam-devel] expiration SSL certificate
In-Reply-To: <CAAWM5Tzw-6tu6Pg2Q4Hw6k5CxiwV1PuWAgMS4RFS_zw2v=a+pQ@mail.gmail.com>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
 <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
 <609F6373C58A4F25839478881A966439@erratique.ch>
 <CAAWM5Tzw-6tu6Pg2Q4Hw6k5CxiwV1PuWAgMS4RFS_zw2v=a+pQ@mail.gmail.com>
Message-ID: <83CBE779258C49CC8002861BC023EB12@erratique.ch>

On Tuesday 13 September 2016 at 12:34, David Sheets wrote:
> Could you please elaborate on the design problem?

http://mjambon.com/yojson.html

"Note that yojson never checks the encoding of strings."

Daniel



From sheets at alum.mit.edu  Tue Sep 13 11:56:26 2016
From: sheets at alum.mit.edu (David Sheets)
Date: Tue, 13 Sep 2016 11:56:26 +0100
Subject: [ocaml-infra] [opam-devel] expiration SSL certificate
In-Reply-To: <83CBE779258C49CC8002861BC023EB12@erratique.ch>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
 <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
 <609F6373C58A4F25839478881A966439@erratique.ch>
 <CAAWM5Tzw-6tu6Pg2Q4Hw6k5CxiwV1PuWAgMS4RFS_zw2v=a+pQ@mail.gmail.com>
 <83CBE779258C49CC8002861BC023EB12@erratique.ch>
Message-ID: <CAAWM5Tz5Q8PgS-qxDzUipZLf4E-cPmmyKBxxd+by5QcOpfxAVA@mail.gmail.com>

On Tue, Sep 13, 2016 at 11:45 AM, Daniel B?nzli
<daniel.buenzli at erratique.ch> wrote:
> On Tuesday 13 September 2016 at 12:34, David Sheets wrote:
>> Could you please elaborate on the design problem?
>
> http://mjambon.com/yojson.html
>
> "Note that yojson never checks the encoding of strings."

This refers to the internal string representation. It's not clear to
me why or how this will result in users "being sorry" for using a
library in order to get a certificate from a (trusted) CA. I think the
author of the library might like to understand more about why you
think this might be a problem so that they can correct it. Telling
them is certainly more effective (and socially responsible) than
spreading FUD on an unrelated mailing list.

David

From daniel.buenzli at erratique.ch  Tue Sep 13 12:02:40 2016
From: daniel.buenzli at erratique.ch (=?utf-8?Q?Daniel_B=C3=BCnzli?=)
Date: Tue, 13 Sep 2016 13:02:40 +0200
Subject: [ocaml-infra] [opam-devel]  expiration SSL certificate
In-Reply-To: <83CBE779258C49CC8002861BC023EB12@erratique.ch>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
 <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
 <609F6373C58A4F25839478881A966439@erratique.ch>
 <CAAWM5Tzw-6tu6Pg2Q4Hw6k5CxiwV1PuWAgMS4RFS_zw2v=a+pQ@mail.gmail.com>
 <83CBE779258C49CC8002861BC023EB12@erratique.ch>
Message-ID: <8F7AA685D45D4EC6872CE9C0D96A9BB7@erratique.ch>

On Tuesday 13 September 2016 at 12:45, Daniel B?nzli wrote:
> On Tuesday 13 September 2016 at 12:34, David Sheets wrote:
> > Could you please elaborate on the design problem?
>  
>  
>  
> http://mjambon.com/yojson.html
>  
> "Note that yojson never checks the encoding of strings."
But maybe if you call your module Safe, it is; Yosjon.Safe.of_string. After all insecurity is only a feeling. It's hilarious.  

Frankly simply don't use the wrong tools; I don't claim there are no bugs in jsonm but at least it doesn't try to be insecure by design. I think that if you are implementing security infrastructure you should be careful about these details; as far as I'm concerned not doing so casts some doubts on your ability to actually implement these things.

Daniel



From sheets at alum.mit.edu  Tue Sep 13 12:09:16 2016
From: sheets at alum.mit.edu (David Sheets)
Date: Tue, 13 Sep 2016 12:09:16 +0100
Subject: [ocaml-infra] [opam-devel]  expiration SSL certificate
In-Reply-To: <8F7AA685D45D4EC6872CE9C0D96A9BB7@erratique.ch>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
 <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
 <609F6373C58A4F25839478881A966439@erratique.ch>
 <CAAWM5Tzw-6tu6Pg2Q4Hw6k5CxiwV1PuWAgMS4RFS_zw2v=a+pQ@mail.gmail.com>
 <83CBE779258C49CC8002861BC023EB12@erratique.ch>
 <8F7AA685D45D4EC6872CE9C0D96A9BB7@erratique.ch>
Message-ID: <CAAWM5Tz0u1Xe9rmVvKdYuWqF2vdjbFVSsYM+cFfhVtevAqCz0w@mail.gmail.com>

On Tue, Sep 13, 2016 at 12:02 PM, Daniel B?nzli
<daniel.buenzli at erratique.ch> wrote:
> Frankly simply don't use the wrong tools; I don't claim there are no bugs in jsonm but at least it doesn't try to be insecure by design.

I still don't think you've demonstrated insecurity (except perhaps your own).

> I think that if you are implementing security infrastructure you should be careful about these details; as far as I'm concerned not doing so casts some doubts on your ability to actually implement these things.

I think the author of the library might like to understand more about
why you think this might be a problem so that they can correct it.
Telling them is certainly more effective (and socially responsible)
than spreading FUD on an unrelated mailing list.

From daniel.buenzli at erratique.ch  Tue Sep 13 12:42:24 2016
From: daniel.buenzli at erratique.ch (=?utf-8?Q?Daniel_B=C3=BCnzli?=)
Date: Tue, 13 Sep 2016 13:42:24 +0200
Subject: [ocaml-infra] [opam-devel] expiration SSL certificate
In-Reply-To: <CAAWM5Tz5Q8PgS-qxDzUipZLf4E-cPmmyKBxxd+by5QcOpfxAVA@mail.gmail.com>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
 <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
 <609F6373C58A4F25839478881A966439@erratique.ch>
 <CAAWM5Tzw-6tu6Pg2Q4Hw6k5CxiwV1PuWAgMS4RFS_zw2v=a+pQ@mail.gmail.com>
 <83CBE779258C49CC8002861BC023EB12@erratique.ch>
 <CAAWM5Tz5Q8PgS-qxDzUipZLf4E-cPmmyKBxxd+by5QcOpfxAVA@mail.gmail.com>
Message-ID: <417EC1A98E0940678B85D3DBB3EC1A37@erratique.ch>

On Tuesday 13 September 2016 at 12:56, David Sheets wrote:
> > "Note that yojson never checks the encoding of strings."
> 
> This refers to the internal string representation.

Please, check your facts.
 
> It's not clear to me why or how this will result in users "being sorry" for using a
> library in order to get a certificate from a (trusted) CA.

Any yojson user might end up being sorry at some point and I have said this for a long time [1]. There are quite a few scenarios where you could be bitten by this behaviour since it invalidates invariants you may think hold about a string that was decoded about a standard compliant JSON parser (like absence of NULL byte in the original string -- note that decoded strings reencoded to UTF-8 may have null bytes because U+0000 is allowed via *escape*). Now store that original string somewhere and think about the fact that most OCaml's system APIs were vulnerable to NULL byte injection until recently (and I'm sure a lot of other C bindings are).

> Telling them is certainly more effective (and socially responsible) than
> spreading FUD on an unrelated mailing list.

I'm not spreading FUD I'm talking about a reality, on mailing list were this project was mentioned to be used. And sorry I don't have time to loose with random people toying in a random, unreleased, github repository.

> I still don't think you've demonstrated insecurity (except perhaps your own).


Security is a mindset. You are showing that you are not having it and I personally feel that neither does an individual that uses insecure libraries to build security infrastructure. Now trust who you want I just happens that I have different expectations about the quality of the code I use.

Best, 

Daniel

[1] http://alan.petitepomme.net/cwn/2012.05.08.html#2

From sheets at alum.mit.edu  Tue Sep 13 13:10:07 2016
From: sheets at alum.mit.edu (David Sheets)
Date: Tue, 13 Sep 2016 13:10:07 +0100
Subject: [ocaml-infra] [opam-devel] expiration SSL certificate
In-Reply-To: <417EC1A98E0940678B85D3DBB3EC1A37@erratique.ch>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
 <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
 <609F6373C58A4F25839478881A966439@erratique.ch>
 <CAAWM5Tzw-6tu6Pg2Q4Hw6k5CxiwV1PuWAgMS4RFS_zw2v=a+pQ@mail.gmail.com>
 <83CBE779258C49CC8002861BC023EB12@erratique.ch>
 <CAAWM5Tz5Q8PgS-qxDzUipZLf4E-cPmmyKBxxd+by5QcOpfxAVA@mail.gmail.com>
 <417EC1A98E0940678B85D3DBB3EC1A37@erratique.ch>
Message-ID: <CAAWM5Twh9UTQCUiW2SQ67Wzs5OSMTjkeNrseuBQbcMPcGt_Z3g@mail.gmail.com>

On Tue, Sep 13, 2016 at 12:42 PM, Daniel B?nzli
<daniel.buenzli at erratique.ch> wrote:
> On Tuesday 13 September 2016 at 12:56, David Sheets wrote:
>> > "Note that yojson never checks the encoding of strings."
>>
>> This refers to the internal string representation.
>
> Please, check your facts.

>From the yojson docs:

Note that yojson never checks the encoding of strings. All
ASCII-compatible encodings including UTF-8 are supported by yojson
readers and writers. Non-ASCII-compatible encodings UTF-16BE,
UTF-16LE, UTF-32BE and UTF-32LE are not supported. "\uXXXX" escape
sequences are converted by the readers into the equivalent UTF-8
multibyte sequences. Characters outside the ASCII range are always
written as is, as permitted by the JSON standard. Bytes that do not
form valid UTF-8 characters are also output as is. It is the user's
responsibility to check for the correctness of UTF-8 data when
appropriate.

>> It's not clear to me why or how this will result in users "being sorry" for using a
>> library in order to get a certificate from a (trusted) CA.
>
> Any yojson user might end up being sorry at some point and I have said this for a long time [1]. There are quite a few scenarios where you could be bitten by this behaviour since it invalidates invariants you may think hold about a string that was decoded about a standard compliant JSON parser (like absence of NULL byte in the original string -- note that decoded strings reencoded to UTF-8 may have null bytes because U+0000 is allowed via *escape*). Now store that original string somewhere and think about the fact that most OCaml's system APIs were vulnerable to NULL byte injection until recently (and I'm sure a lot of other C bindings are).

The attack you are partially describing would be the ACME CA sending
you malicious JSON. This seems fairly unlikely and in violation of the
trust model of the CA system, though, I admit, it is possible. It is
likely that the author of the library is not aware of these facts
which is why I continue to urge you to help them understand the
issues.

>> Telling them is certainly more effective (and socially responsible) than
>> spreading FUD on an unrelated mailing list.
>
> I'm not spreading FUD I'm talking about a reality, on mailing list were this project was mentioned to be used. And sorry I don't have time to loose with random people toying in a random, unreleased, github repository.

You are sending messages containing unsubstantiated security claims
which result in fear (probably overblown), uncertainty (because the
claims have no demonstration), and doubt (about the author's "ability
to actually implement these things"). I find it quite something that
your original messages were vague to the point of useless but now you
have expended far more effort justifying your opinion than would have
been required to help the project.

> Security is a mindset.

Security is also an economic proposition and a community effort. A CA
attacking you is possible but unlikely. Helping others to develop
secure software is beneficial to all the users of that software. We
are talking about a project that is *already written in OCaml* so it
is unlikely that the author is incapable of building excellent
software in the short to medium term.

> You are showing that you are not having it and I personally feel that neither does an individual that uses insecure libraries to build security infrastructure. Now trust who you want I just happens that I have different expectations about the quality of the code I use.

It's interesting that defending against knee-jerk FUD attacks is not
compatible with a "security mindset". I think that a blanket dismissal
of the library (and its author) due to the adoption of a widespread
(though fraught) library is absurd. It is very likely the author does
not know the things you know and does not have the experience with
yojson or the OCaml community that you have. Clearly they are
interested in security and clearly they have produced something of
value even if not perfect (it's unreleased!).

David

From francois.bobot at cea.fr  Tue Sep 13 13:26:36 2016
From: francois.bobot at cea.fr (=?UTF-8?Q?Fran=c3=a7ois_Bobot?=)
Date: Tue, 13 Sep 2016 14:26:36 +0200
Subject: [ocaml-infra] expiration SSL certificate
In-Reply-To: <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
Message-ID: <c980e23f-b176-4965-0b24-779e4fb32da2@cea.fr>

On 13/09/2016 10:51, Anil Madhavapeddy wrote:
> On 10 Sep 2016, at 15:42, Xavier Leroy <Xavier.Leroy at inria.fr> wrote:
>>
>> On 09/07/2016 04:21 PM, Ashish Agarwal wrote:
>>> IIRC, this was particularly relevant for the opam sub-domain, so cc-ing the
>>> opam-devel list. Can any opam dev please confirm. If it is still needed, we
>>> should act quick to update this.
>>
>> I'm positive you need secure connections for lists.ocaml.org as well
>> (to protect the passwords of list administrators and subscribers).
>
> That's correct -- the current Gandi SSL certificate had a few subdomains to
> deal with as well, so all of those need to be renewed.
>
> I've been experimenting with Letsencrypt on a few other domains, and it
> is mostly working fine except that certificates are only issued for 90 days.
> This means that it's essential to implement autorenewal via the Acme API,
> or else domains will expire rather rapidly.
>

The auto-renewal tools that already exists (even if not in ocaml) are working very well, and are 
easy to deploy. On debian testing the package certbot is very straight-forward to use in webroot 
mode with any webserver that can serve files for "http://mydomain.org/.well-known/acme-challenge/*" 
from a directory and that can be reloaded/restarted to take into account the new keys. The cronjob 
is already configured.

-- 
Fran?ois



From daniel.buenzli at erratique.ch  Tue Sep 13 14:37:18 2016
From: daniel.buenzli at erratique.ch (=?utf-8?Q?Daniel_B=C3=BCnzli?=)
Date: Tue, 13 Sep 2016 15:37:18 +0200
Subject: [ocaml-infra] [opam-devel] expiration SSL certificate
In-Reply-To: <CAAWM5Twh9UTQCUiW2SQ67Wzs5OSMTjkeNrseuBQbcMPcGt_Z3g@mail.gmail.com>
References: <bc4bf63c-9214-c8a4-2166-8d032319fffb@inria.fr>
 <5a8d24d1-d4c1-d6b5-cf82-a51d9e5c1602@cea.fr>
 <CAMu2m2JxFed0AOiikNYeWTahfUYUQkhQgrDv3S7=s=Ra3s=Hkw@mail.gmail.com>
 <50d2ad02-70ff-f27f-dde4-64d7c9128572@inria.fr>
 <22773B43-3C30-462D-807A-6979D0442CE9@recoil.org>
 <DAB47DA2C3C54B3D8284A0591C8B2952@erratique.ch>
 <4F20F2DE-09C1-49B7-A4DE-FCF9D7BE9559@recoil.org>
 <DF15DB8D274D4F6ABAD037CC9E74BDE2@erratique.ch>
 <CAAWM5TxQuUvsC4o+9BWS+vc42QRjSQLSOQCzk=cxEgceKrwpyg@mail.gmail.com>
 <609F6373C58A4F25839478881A966439@erratique.ch>
 <CAAWM5Tzw-6tu6Pg2Q4Hw6k5CxiwV1PuWAgMS4RFS_zw2v=a+pQ@mail.gmail.com>
 <83CBE779258C49CC8002861BC023EB12@erratique.ch>
 <CAAWM5Tz5Q8PgS-qxDzUipZLf4E-cPmmyKBxxd+by5QcOpfxAVA@mail.gmail.com>
 <417EC1A98E0940678B85D3DBB3EC1A37@erratique.ch>
 <CAAWM5Twh9UTQCUiW2SQ67Wzs5OSMTjkeNrseuBQbcMPcGt_Z3g@mail.gmail.com>
Message-ID: <DA7497C7F10942ECB2AD57E1FCA08129@erratique.ch>

On Tuesday 13 September 2016 at 14:10, David Sheets wrote:
> From the yojson docs:

[...] 

So precisely: it will decode a lot of things the string production of RFC 7159 would not decode (it's not only about UTF-8 validity, you are not supposed to have control characters in encoded json text). I'm not demonstrating an attack but I precisely think that security is one of these topics were you don't want to "do it like this until proven otherwise". If you like it that way so be it, but stop accusing me of FUD. When you implement a standard that refers to others final correctness is assumed given the other standards being implemented correctly, weakest link bla bla.

> The attack you are partially describing would be the ACME CA sending
> you malicious JSON. 

I'm not describing an attack I'm describing an attack *vector* in any program that uses yojson. It may or may not be exploitable, but I absolutely dont care about this: you have the choice of not having this attack vector at all. Given the current trend of security breaches I expect good and responsible programmers to actually make the right choices. 

> You are sending messages containing unsubstantiated security claims
See above. I'm not sending messages about security claims (I'm absolutely not a security expert and not interested beyond what is needed for me to write dependable software users can trust). I'm sending messages about a security mindset; don't use unsecure libraries that can open attack vectors in your programs.

> I find it quite something that your original messages were vague to the point of useless but now you
> have expended far more effort justifying your opinion than would have been required to help the project.

Well I expected you to be a little more subtle than that and to understand the points without having to go that far in this discussion.

Daniel




From anil at recoil.org  Fri Sep 16 09:53:31 2016
From: anil at recoil.org (Anil Madhavapeddy)
Date: Fri, 16 Sep 2016 09:53:31 +0100
Subject: [ocaml-infra] ocaml-legacy into the ocaml/ github org
Message-ID: <C033DC18-518E-42D8-9F81-2E8835BCD16F@recoil.org>

Dear all,

David Allsopp has been working on getting many historical versions of OCaml compiling on Windows via an OPAM switch -- all the way back to 3.07 in fact!

If there are no objections, I would like to host https://github.com/metastack/ocaml-legacy under the ocaml/ GitHub organisation to assist with upstreaming the various OPAM compiler switches into mainline OPAM repository soon.

regards,
Anil

From Fabrice.Le_fessant at inria.fr  Fri Sep 16 10:51:04 2016
From: Fabrice.Le_fessant at inria.fr (Fabrice Le Fessant)
Date: Fri, 16 Sep 2016 09:51:04 +0000
Subject: [ocaml-infra] ocaml-legacy into the ocaml/ github org
In-Reply-To: <C033DC18-518E-42D8-9F81-2E8835BCD16F@recoil.org>
References: <C033DC18-518E-42D8-9F81-2E8835BCD16F@recoil.org>
Message-ID: <CAHvkLrO3SiQMA8EL=f3zSw=FmaAkbGOEaSOBoz+kcgs=Dw5jOw@mail.gmail.com>

Maybe with a different project name, like `ocaml-windows-legacy` to put
forward the fact that it addresses Windows issues ?


On Fri, Sep 16, 2016 at 10:53 AM Anil Madhavapeddy <anil at recoil.org> wrote:

> Dear all,
>
> David Allsopp has been working on getting many historical versions of
> OCaml compiling on Windows via an OPAM switch -- all the way back to 3.07
> in fact!
>
> If there are no objections, I would like to host
> https://github.com/metastack/ocaml-legacy under the ocaml/ GitHub
> organisation to assist with upstreaming the various OPAM compiler switches
> into mainline OPAM repository soon.
>
> regards,
> Anil
> _______________________________________________
> Infrastructure mailing list
> Infrastructure at lists.ocaml.org
> http://lists.ocaml.org/listinfo/infrastructure
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.ocaml.org/pipermail/infrastructure/attachments/20160916/225f1979/attachment.html>

From anil at recoil.org  Fri Sep 16 11:47:02 2016
From: anil at recoil.org (Anil Madhavapeddy)
Date: Fri, 16 Sep 2016 11:47:02 +0100
Subject: [ocaml-infra] ocaml-legacy into the ocaml/ github org
In-Reply-To: <CAHvkLrO3SiQMA8EL=f3zSw=FmaAkbGOEaSOBoz+kcgs=Dw5jOw@mail.gmail.com>
References: <C033DC18-518E-42D8-9F81-2E8835BCD16F@recoil.org>
 <CAHvkLrO3SiQMA8EL=f3zSw=FmaAkbGOEaSOBoz+kcgs=Dw5jOw@mail.gmail.com>
Message-ID: <AE193235-01FF-4468-B982-B161EF8107A9@recoil.org>

I'd prefer to keep the repository with the more legacy name, in the hope that other operating systems receive contributions eventually for supporting them as well.  It's ironic that Windows is getting such comprehensive support for OPAM switching ahead of the more traditionally well supported platforms :-)

Anil

> On 16 Sep 2016, at 10:51, Fabrice Le Fessant <Fabrice.Le_fessant at inria.fr> wrote:
> 
> Maybe with a different project name, like `ocaml-windows-legacy` to put forward the fact that it addresses Windows issues ?
> 
> 
> On Fri, Sep 16, 2016 at 10:53 AM Anil Madhavapeddy <anil at recoil.org> wrote:
> Dear all,
> 
> David Allsopp has been working on getting many historical versions of OCaml compiling on Windows via an OPAM switch -- all the way back to 3.07 in fact!
> 
> If there are no objections, I would like to host https://github.com/metastack/ocaml-legacy under the ocaml/ GitHub organisation to assist with upstreaming the various OPAM compiler switches into mainline OPAM repository soon.
> 
> regards,
> Anil
> _______________________________________________
> Infrastructure mailing list
> Infrastructure at lists.ocaml.org
> http://lists.ocaml.org/listinfo/infrastructure


From gabriel.scherer at gmail.com  Fri Sep 16 14:01:58 2016
From: gabriel.scherer at gmail.com (Gabriel Scherer)
Date: Fri, 16 Sep 2016 22:01:58 +0900
Subject: [ocaml-infra] ocaml-legacy into the ocaml/ github org
In-Reply-To: <AE193235-01FF-4468-B982-B161EF8107A9@recoil.org>
References: <C033DC18-518E-42D8-9F81-2E8835BCD16F@recoil.org>
 <CAHvkLrO3SiQMA8EL=f3zSw=FmaAkbGOEaSOBoz+kcgs=Dw5jOw@mail.gmail.com>
 <AE193235-01FF-4468-B982-B161EF8107A9@recoil.org>
Message-ID: <CAPFanBHvffPzCbXX4tisn4hN8oEpywDwPwJS2p7MSWhUKjVHVg@mail.gmail.com>

Instead of distributing patches, would it make sense to just merge
these commits in the corresponding version-branches of the upstream
codebase? Then we could either convince Damien to create new tags for
these releases, or just use switch descriptions that use git branch
directly.

(Going back to old release branches to commit patches to build on
newer systems is an idea that has been itching me for a while.)

On Fri, Sep 16, 2016 at 7:47 PM, Anil Madhavapeddy <anil at recoil.org> wrote:
> I'd prefer to keep the repository with the more legacy name, in the hope that other operating systems receive contributions eventually for supporting them as well.  It's ironic that Windows is getting such comprehensive support for OPAM switching ahead of the more traditionally well supported platforms :-)
>
> Anil
>
>> On 16 Sep 2016, at 10:51, Fabrice Le Fessant <Fabrice.Le_fessant at inria.fr> wrote:
>>
>> Maybe with a different project name, like `ocaml-windows-legacy` to put forward the fact that it addresses Windows issues ?
>>
>>
>> On Fri, Sep 16, 2016 at 10:53 AM Anil Madhavapeddy <anil at recoil.org> wrote:
>> Dear all,
>>
>> David Allsopp has been working on getting many historical versions of OCaml compiling on Windows via an OPAM switch -- all the way back to 3.07 in fact!
>>
>> If there are no objections, I would like to host https://github.com/metastack/ocaml-legacy under the ocaml/ GitHub organisation to assist with upstreaming the various OPAM compiler switches into mainline OPAM repository soon.
>>
>> regards,
>> Anil
>> _______________________________________________
>> Infrastructure mailing list
>> Infrastructure at lists.ocaml.org
>> http://lists.ocaml.org/listinfo/infrastructure
>
> _______________________________________________
> Infrastructure mailing list
> Infrastructure at lists.ocaml.org
> http://lists.ocaml.org/listinfo/infrastructure

From anil at recoil.org  Fri Sep 16 14:04:46 2016
From: anil at recoil.org (Anil Madhavapeddy)
Date: Fri, 16 Sep 2016 14:04:46 +0100
Subject: [ocaml-infra] ocaml-legacy into the ocaml/ github org
In-Reply-To: <CAPFanBHvffPzCbXX4tisn4hN8oEpywDwPwJS2p7MSWhUKjVHVg@mail.gmail.com>
References: <C033DC18-518E-42D8-9F81-2E8835BCD16F@recoil.org>
 <CAHvkLrO3SiQMA8EL=f3zSw=FmaAkbGOEaSOBoz+kcgs=Dw5jOw@mail.gmail.com>
 <AE193235-01FF-4468-B982-B161EF8107A9@recoil.org>
 <CAPFanBHvffPzCbXX4tisn4hN8oEpywDwPwJS2p7MSWhUKjVHVg@mail.gmail.com>
Message-ID: <ABB5B260-48E8-4CF3-ADF6-219F933539FB@recoil.org>

This is what I've been doing with the OPAM 1.2 branch (e.g. as source archives change).

Anil

> On 16 Sep 2016, at 14:01, Gabriel Scherer <gabriel.scherer at gmail.com> wrote:
> 
> Instead of distributing patches, would it make sense to just merge
> these commits in the corresponding version-branches of the upstream
> codebase? Then we could either convince Damien to create new tags for
> these releases, or just use switch descriptions that use git branch
> directly.
> 
> (Going back to old release branches to commit patches to build on
> newer systems is an idea that has been itching me for a while.)
> 
> On Fri, Sep 16, 2016 at 7:47 PM, Anil Madhavapeddy <anil at recoil.org> wrote:
>> I'd prefer to keep the repository with the more legacy name, in the hope that other operating systems receive contributions eventually for supporting them as well.  It's ironic that Windows is getting such comprehensive support for OPAM switching ahead of the more traditionally well supported platforms :-)
>> 
>> Anil
>> 
>>> On 16 Sep 2016, at 10:51, Fabrice Le Fessant <Fabrice.Le_fessant at inria.fr> wrote:
>>> 
>>> Maybe with a different project name, like `ocaml-windows-legacy` to put forward the fact that it addresses Windows issues ?
>>> 
>>> 
>>> On Fri, Sep 16, 2016 at 10:53 AM Anil Madhavapeddy <anil at recoil.org> wrote:
>>> Dear all,
>>> 
>>> David Allsopp has been working on getting many historical versions of OCaml compiling on Windows via an OPAM switch -- all the way back to 3.07 in fact!
>>> 
>>> If there are no objections, I would like to host https://github.com/metastack/ocaml-legacy under the ocaml/ GitHub organisation to assist with upstreaming the various OPAM compiler switches into mainline OPAM repository soon.
>>> 
>>> regards,
>>> Anil
>>> _______________________________________________
>>> Infrastructure mailing list
>>> Infrastructure at lists.ocaml.org
>>> http://lists.ocaml.org/listinfo/infrastructure
>> 
>> _______________________________________________
>> Infrastructure mailing list
>> Infrastructure at lists.ocaml.org
>> http://lists.ocaml.org/listinfo/infrastructure
> 


From Xavier.Leroy at inria.fr  Sun Sep 18 11:10:45 2016
From: Xavier.Leroy at inria.fr (Xavier Leroy)
Date: Sun, 18 Sep 2016 12:10:45 +0200
Subject: [ocaml-infra] ocaml-legacy into the ocaml/ github org
In-Reply-To: <CAPFanBHvffPzCbXX4tisn4hN8oEpywDwPwJS2p7MSWhUKjVHVg@mail.gmail.com>
References: <C033DC18-518E-42D8-9F81-2E8835BCD16F@recoil.org>
 <CAHvkLrO3SiQMA8EL=f3zSw=FmaAkbGOEaSOBoz+kcgs=Dw5jOw@mail.gmail.com>
 <AE193235-01FF-4468-B982-B161EF8107A9@recoil.org>
 <CAPFanBHvffPzCbXX4tisn4hN8oEpywDwPwJS2p7MSWhUKjVHVg@mail.gmail.com>
Message-ID: <e9b5ed32-82a4-4082-e021-27c7f78026ce@inria.fr>

On 09/16/2016 03:01 PM, Gabriel Scherer wrote:
> Instead of distributing patches, would it make sense to just merge
> these commits in the corresponding version-branches of the upstream
> codebase? Then we could either convince Damien to create new tags for
> these releases, or just use switch descriptions that use git branch
> directly.
> 
> (Going back to old release branches to commit patches to build on
> newer systems is an idea that has been itching me for a while.)

Is there an identified need?  (Beside your itches.)  So far, we don't
even backport bug fixes to older versions of OCaml.  Why should we
patch those older versions so that they compile (bugs included) on
recent systems?  Is this the best possible use we can make of our
limited collective manpower?

- Xavier

From dra-news at metastack.com  Sun Sep 18 13:59:29 2016
From: dra-news at metastack.com (David Allsopp)
Date: Sun, 18 Sep 2016 12:59:29 +0000
Subject: [ocaml-infra] ocaml-legacy into the ocaml/ github org
In-Reply-To: <e9b5ed32-82a4-4082-e021-27c7f78026ce@inria.fr>
References: <C033DC18-518E-42D8-9F81-2E8835BCD16F@recoil.org>
 <CAHvkLrO3SiQMA8EL=f3zSw=FmaAkbGOEaSOBoz+kcgs=Dw5jOw@mail.gmail.com>
 <AE193235-01FF-4468-B982-B161EF8107A9@recoil.org>
 <CAPFanBHvffPzCbXX4tisn4hN8oEpywDwPwJS2p7MSWhUKjVHVg@mail.gmail.com>
 <e9b5ed32-82a4-4082-e021-27c7f78026ce@inria.fr>
Message-ID: <E51C5B015DBD1348A1D85763337FB6D901351BFE43@Remus.metastack.local>

Xavier Leroy wrote:
> On 09/16/2016 03:01 PM, Gabriel Scherer wrote:
> > Instead of distributing patches, would it make sense to just merge
> > these commits in the corresponding version-branches of the upstream
> > codebase? Then we could either convince Damien to create new tags for
> > these releases, or just use switch descriptions that use git branch
> > directly.
> >
> > (Going back to old release branches to commit patches to build on
> > newer systems is an idea that has been itching me for a while.)
> 
> Is there an identified need?  (Beside your itches.)  So far, we don't even
> backport bug fixes to older versions of OCaml.  Why should we patch those
> older versions so that they compile (bugs included) on recent systems?  Is
> this the best possible use we can make of our limited collective manpower?

I agree - apart from anything else, it is useful (for OPAM) to be applying build-related patches to superseded point releases (e.g. patching 4.00.0 and 4.00.1 - not just the 4.00 branch) and those clearly can't (without a lot of questionable work) go in the OCaml repo.

These patches, to me at any rate, don't feel like they should be "upstream" (i.e. in OCaml) - elsewhere (e.g. RHEL), back-porting is a job for packagers. As an aside, I had recently mused whether the faster release cycle might make an OCaml "LTS" branch an idea, but there similarly doesn't seem to be a need, at least yet...


David

