<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [opam-devel] having an iocamljs for every pull request
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20having%20an%20iocamljs%20for%20every%20pull%20request&In-Reply-To=%3C3E76A4C1-7B1D-49B4-A466-5BF91154FDC8%40recoil.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000725.html">
   <LINK REL="Next"  HREF="000727.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[opam-devel] having an iocamljs for every pull request</H1>
    <B>Anil Madhavapeddy</B> 
    <A HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20having%20an%20iocamljs%20for%20every%20pull%20request&In-Reply-To=%3C3E76A4C1-7B1D-49B4-A466-5BF91154FDC8%40recoil.org%3E"
       TITLE="[opam-devel] having an iocamljs for every pull request">anil at recoil.org
       </A><BR>
    <I>Sun Oct  5 23:21:35 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000725.html">[opam-devel] What metrics for opam-repository ?
</A></li>
        <LI>Next message: <A HREF="000727.html">[opam-devel] opam 1.2 deb/rpm snapshots updated
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#726">[ date ]</a>
              <a href="thread.html#726">[ thread ]</a>
              <a href="subject.html#726">[ subject ]</a>
              <a href="author.html#726">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6 May 2014, at 11:43, Andy Ray &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">andy.ray at ujamjar.com</A>&gt; wrote:

&gt;<i> On Tue, May 6, 2014 at 11:16 AM, Anil Madhavapeddy &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">anil at recoil.org</A>&gt; wrote:
</I>&gt;&gt;<i> Jeremy enquired about what is required to have an iocamljs toplevel available for every new package pull request into OPAM repository.  I believe we actually have many of the mechanics already:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> - Set up an `i.ocaml.org` virtual machine to serve the Cohttp static site for IOCamlJS.  This never runs native code, but does all the URL remapping for the JavaScript frontend to work.  We would need to add virtual hosting support for it, which should be fairly easy.
</I>&gt;<i> 
</I>&gt;<i> As discussed previously there are one or two things to 'harden' in the
</I>&gt;<i> server to make this safe but nothing difficult or time consuming.
</I>&gt;<i> 
</I>&gt;&gt;<i> - Detect if there's a new ocamlfind package in the pull request, which could be done using Thomas' ocamlfind-detection patch.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> - Alter the OPAM-repository Travis scripts to POST to i.ocaml.org with the OPAM repository merge point and the name of the new package(s), and have the VM build the new libraries and make the cmo available.
</I>&gt;<i> 
</I>&gt;<i> Yeah, the only trick is keeping the opam/ocamlfind installation
</I>&gt;<i> working correctly as new packages are installed/updated to the
</I>&gt;<i> universe.
</I>&gt;<i> 
</I>&gt;&gt;<i> - Have the Travis script comment on the original pull request with the URL of the toplevel.
</I>&gt;<i> 
</I>&gt;<i> Using the dynamic loading approach there would only be one generic
</I>&gt;<i> iocamljs kernel (/url) and the packages would be loaded by the user.
</I>&gt;<i> You could I suppose auto generate a notebook with the appropriate
</I>&gt;<i> #require directives though.
</I>
Now that we have `findlib` files in the OPAM repository, I've been
wondering if it's practical to maintain an .ocamlinit that requires
all the installed libraries.  It might well be too slow, but I would
find that quite convenient, and it would also reduce confusion among
new users.

It would also help with the iocamljs use-case, since the list of
installed packages in a switch could be used to generate the directives
in the notebook.

-anil
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000725.html">[opam-devel] What metrics for opam-repository ?
</A></li>
	<LI>Next message: <A HREF="000727.html">[opam-devel] opam 1.2 deb/rpm snapshots updated
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#726">[ date ]</a>
              <a href="thread.html#726">[ thread ]</a>
              <a href="subject.html#726">[ subject ]</a>
              <a href="author.html#726">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/opam-devel">More information about the opam-devel
mailing list</a><br>
</body></html>
