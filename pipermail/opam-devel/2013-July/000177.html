<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [opam-devel] Generating .install file
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Generating%20.install%20file&In-Reply-To=%3CADEB1D45A80340A395267C96C5057FCB%40erratique.ch%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000161.html">
   <LINK REL="Next"  HREF="000156.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[opam-devel] Generating .install file</H1>
    <B>Daniel B&#252;nzli</B> 
    <A HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Generating%20.install%20file&In-Reply-To=%3CADEB1D45A80340A395267C96C5057FCB%40erratique.ch%3E"
       TITLE="[opam-devel] Generating .install file">daniel.buenzli at erratique.ch
       </A><BR>
    <I>Fri Jul 26 02:07:28 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000161.html">[opam-devel] Generating .install file
</A></li>
        <LI>Next message: <A HREF="000156.html">[opam-devel] Github Releases, with excellent timing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#177">[ date ]</a>
              <a href="thread.html#177">[ thread ]</a>
              <a href="subject.html#177">[ subject ]</a>
              <a href="author.html#177">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Le lundi, 8 juillet 2013 &#224; 13:23, Daniel B&#252;nzli a &#233;crit :
&gt;<i> Yes it's hand written, I don't care, at least it's very explicit. It uses the functions of this *trivial* package-independent script:
</I>&gt;<i>  
</I>&gt;<i> <A HREF="https://github.com/dbuenzli/vg/blob/master/pkg/pkg-builder">https://github.com/dbuenzli/vg/blob/master/pkg/pkg-builder</A>
</I>I have improved that script to support all the new opam install sections. It can be found in this git repo:

<A HREF="https://github.com/dbuenzli/pkgopkg/blob/master/pkg/pkg-builder">https://github.com/dbuenzli/pkgopkg/blob/master/pkg/pkg-builder</A>

which aggregates package development/publication tools I used to copy around in my packages. Note that a fun (haha) property of that repo is that it's both an opam repository and an opam package -- this allows me to quickly get my tools in an opam install.

A non trivial (but still pure ocaml) example of usage can be found here:

<A HREF="https://github.com/dbuenzli/webglue/blob/master/pkg/build">https://github.com/dbuenzli/webglue/blob/master/pkg/build</A>

This project has a command line tool, an api, dynamically loaded plugins all build via ocamlbuild. Man pages are defined via cmdliner and the plugins themselves add man pages to the tool. Thus these pages can only be extracted once the tool and the plugin have been built.  

A call to `pkg/build true` builds the project and generates this [1] install file.  

Best,

Daniel

[1]

opam-version: &quot;1&quot;
lib: [
&quot;_build/pkg/META&quot; {&quot;META&quot;}
&quot;_build/src/api/wg.mli&quot; {&quot;wg.mli&quot;}
&quot;_build/src/api/wg.cmi&quot; {&quot;wg.cmi&quot;}
&quot;_build/src/api/wg.cmx&quot; {&quot;wg.cmx&quot;}
&quot;_build/src/api/wg.cmxa&quot; {&quot;wg.cmxa&quot;}
&quot;_build/src/api/wg.cmxs&quot; {&quot;wg.cmxs&quot;}
&quot;_build/src/formats/w_css.cmxs&quot; {&quot;w_css.cmxs&quot;}
&quot;_build/src/formats/w_text.cmxs&quot; {&quot;w_text.cmxs&quot;}
&quot;_build/src/formats/w_files.cmxs&quot; {&quot;w_files.cmxs&quot;}
&quot;_build/src/formats/w_timestamp.cmxs&quot; {&quot;w_timestamp.cmxs&quot;}
&quot;_build/src/formats/w_sitemap.cmxs&quot; {&quot;w_sitemap.cmxs&quot;}
&quot;_build/src/formats/w_xml.cmxs&quot; {&quot;w_xml.cmxs&quot;}
]
bin: [
&quot;_build/src/tool/webglue.native&quot; {&quot;webglue&quot;}
]
toplevel: [
]
share: [
&quot;_build/share/dotemacs&quot; {&quot;dotemacs&quot;}
&quot;_build/share/example/home.map&quot; {&quot;example/home.map&quot;}
&quot;_build/share/example/locale-menus.map&quot; {&quot;example/locale-menus.map&quot;}
&quot;_build/share/example/text.map&quot; {&quot;example/text.map&quot;}
]
doc: [
&quot;_build/README.md&quot; {&quot;README.md&quot;}
&quot;_build/CHANGES.md&quot; {&quot;CHANGES.md&quot;}
]
misc: [
]
stublibs: [
]
man: [
&quot;_build/webglue.1&quot; {&quot;man1/webglue.1&quot;}
&quot;_build/webglue-content.1&quot; {&quot;man1/webglue-content.1&quot;}
&quot;_build/webglue-diagnose.1&quot; {&quot;man1/webglue-diagnose.1&quot;}
&quot;_build/webglue-get.1&quot; {&quot;man1/webglue-get.1&quot;}
&quot;_build/webglue-help.1&quot; {&quot;man1/webglue-help.1&quot;}
&quot;_build/webglue-set.1&quot; {&quot;man1/webglue-set.1&quot;}
&quot;_build/webglue-show.1&quot; {&quot;man1/webglue-show.1&quot;}
&quot;_build/webglue-uriset.1&quot; {&quot;man1/webglue-uriset.1&quot;}
&quot;_build/<A HREF="http://lists.ocaml.org/listinfo/opam-devel">webglue- at -text.7</A>&quot; {&quot;man7/<A HREF="http://lists.ocaml.org/listinfo/opam-devel">webglue- at -text.7</A>&quot;}
&quot;_build/webglue-directives.7&quot; {&quot;man7/webglue-directives.7&quot;}
&quot;_build/webglue-formats.5&quot; {&quot;man5/webglue-formats.5&quot;}
&quot;_build/webglue-s-expressions.5&quot; {&quot;man5/webglue-s-expressions.5&quot;}
&quot;_build/webglue-standard-uris.7&quot; {&quot;man7/webglue-standard-uris.7&quot;}
&quot;_build/w.css.5&quot; {&quot;man5/w.css.5&quot;}
&quot;_build/w.files.5&quot; {&quot;man5/w.files.5&quot;}
&quot;_build/w.map.5&quot; {&quot;man5/w.map.5&quot;}
&quot;_build/w.sitemap.5&quot; {&quot;man5/w.sitemap.5&quot;}
&quot;_build/w.text.5&quot; {&quot;man5/w.text.5&quot;}
&quot;_build/w.timestamp.5&quot; {&quot;man5/w.timestamp.5&quot;}
&quot;_build/w.xml.5&quot; {&quot;man5/w.xml.5&quot;}
]







</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000161.html">[opam-devel] Generating .install file
</A></li>
	<LI>Next message: <A HREF="000156.html">[opam-devel] Github Releases, with excellent timing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#177">[ date ]</a>
              <a href="thread.html#177">[ thread ]</a>
              <a href="subject.html#177">[ subject ]</a>
              <a href="author.html#177">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/opam-devel">More information about the opam-devel
mailing list</a><br>
</body></html>
