<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [opam-devel] Stable archive checksums
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Stable%20archive%20checksums&In-Reply-To=%3CCAP_800qy42wJSp5ea3%2BP4xfsrcNv5F2j5tWGdur1_gJiHqUFoA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000577.html">
   <LINK REL="Next"  HREF="000579.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[opam-devel] Stable archive checksums</H1>
    <B>Markus Mottl</B> 
    <A HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Stable%20archive%20checksums&In-Reply-To=%3CCAP_800qy42wJSp5ea3%2BP4xfsrcNv5F2j5tWGdur1_gJiHqUFoA%40mail.gmail.com%3E"
       TITLE="[opam-devel] Stable archive checksums">markus.mottl at gmail.com
       </A><BR>
    <I>Thu Jun 26 21:35:53 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000577.html">[opam-devel] Stable archive checksums
</A></li>
        <LI>Next message: <A HREF="000579.html">[opam-devel] Stable archive checksums
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#578">[ date ]</a>
              <a href="thread.html#578">[ thread ]</a>
              <a href="subject.html#578">[ subject ]</a>
              <a href="author.html#578">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for pointing me to the GitHub OCaml-bindings, this is likely
going to be helpful for automating releases.

I ran into checksum problems with Mercurial a long time ago when using
version control tags to obtain archives on the fly, which is why I
want to avoid this issue with GitHub.

I think OPAM-contributors should be aware that tool upgrades at GitHub
(e.g. git, tar, gzip) could potentially break checksums across all
versions of all their packages, which would surely cause a lot of
headaches.  Using the &quot;Releases&quot;-feature on GitHub to upload fixed
tarballs may be the only reliable way around this.  It seems only 10
packages are getting this right as of now...

Regards,
Markus

On Thu, Jun 26, 2014 at 3:37 PM, Anil Madhavapeddy &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">anil at recoil.org</A>&gt; wrote:
&gt;<i> GitHub archives are stable in my experience except under one notable change:
</I>&gt;<i> if you do a repo transfer to another organization, the redirect from the old
</I>&gt;<i> one points to releases with a new checksum.  This is a fairly rare event,
</I>&gt;<i> but it's worth keeping in mind.
</I>&gt;<i>
</I>&gt;<i> Markus, have you spotted other cases where checksums change?
</I>&gt;<i>
</I>&gt;<i> -anil
</I>&gt;<i>
</I>&gt;<i> On 26 Jun 2014, at 20:33, Ashish Agarwal &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">agarwal1975 at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> A quick grep through the current 2,383 url files gives me 970 that are
</I>&gt;<i> pointing to github.com. Of that, 810 have &quot;/archive/&quot; in the url, which I
</I>&gt;<i> believe indicates that they are pointing to the tarballs automatically
</I>&gt;<i> generated for a commit. Doesn't this indicate a potential big problem if
</I>&gt;<i> github changes the way they generate tarballs. All of these checksums will
</I>&gt;<i> fail.
</I>&gt;<i>
</I>&gt;<i> Only 10 of the 970 have &quot;/releases/&quot; in their url, which I think indicates a
</I>&gt;<i> fixed binary file.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, Jun 26, 2014 at 3:22 PM, Anil Madhavapeddy &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">anil at recoil.org</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 26 Jun 2014, at 17:58, Markus Mottl &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">markus.mottl at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Hi,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; since a lot of OPAM packagers are using Github, to which I'm
</I>&gt;&gt;<i> &gt; transitioning my projects, I just wondered how you are dealing with
</I>&gt;&gt;<i> &gt; the problem of downloading archives with stable checksums.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; The online information is rather confusing, but it is my impression
</I>&gt;&gt;<i> &gt; that there is no guarantee that downloading an archive from Github
</I>&gt;&gt;<i> &gt; will give you files with equivalent checksums.  Github apparently
</I>&gt;&gt;<i> &gt; doesn't support download pages with fixed files anymore unlike
</I>&gt;&gt;<i> &gt; Bitbucket, which I'm currently using.  AFAIK, Github cleans out
</I>&gt;&gt;<i> &gt; generated archive files if not downloaded again soon enough so there
</I>&gt;&gt;<i> &gt; is some chance that changes to e.g. git, tar, or gzip could screw up
</I>&gt;&gt;<i> &gt; archive checksums.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Any suggestions on how to best interact with Github for downloading
</I>&gt;&gt;<i> &gt; stable packages via OPAM?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> GitHub does support downloadable binary archives, but it's called
</I>&gt;&gt;<i> &quot;Releases&quot;.  See for example:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="https://github.com/ocaml/opam/releases">https://github.com/ocaml/opam/releases</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> for the binary uploads against a tag.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> API is here:
</I>&gt;&gt;<i> <A HREF="https://developer.github.com/v3/repos/releases/">https://developer.github.com/v3/repos/releases/</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> My OCaml GitHub bindings have a little command line utility to upload
</I>&gt;&gt;<i> stuff via the command-line (you can probably do the same with Curl as well).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ```
</I>&gt;&gt;<i> opam install github
</I>&gt;&gt;<i> git-upload-release --help
</I>&gt;&gt;<i> ```
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> cheers,
</I>&gt;&gt;<i> Anil
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> opam-devel mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/opam-devel">opam-devel at lists.ocaml.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/opam-devel">http://lists.ocaml.org/listinfo/opam-devel</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>


-- 
Markus Mottl        <A HREF="http://www.ocaml.info">http://www.ocaml.info</A>        <A HREF="http://lists.ocaml.org/listinfo/opam-devel">markus.mottl at gmail.com</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000577.html">[opam-devel] Stable archive checksums
</A></li>
	<LI>Next message: <A HREF="000579.html">[opam-devel] Stable archive checksums
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#578">[ date ]</a>
              <a href="thread.html#578">[ thread ]</a>
              <a href="subject.html#578">[ subject ]</a>
              <a href="author.html#578">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/opam-devel">More information about the opam-devel
mailing list</a><br>
</body></html>
