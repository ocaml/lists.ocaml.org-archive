<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [opam-devel] Using the new travis containers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Using%20the%20new%20travis%20containers&In-Reply-To=%3CE91762B9-4D7C-466B-AD91-5D52C55F662B%40recoil.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001058.html">
   <LINK REL="Next"  HREF="001060.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[opam-devel] Using the new travis containers</H1>
    <B>Anil Madhavapeddy</B> 
    <A HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Using%20the%20new%20travis%20containers&In-Reply-To=%3CE91762B9-4D7C-466B-AD91-5D52C55F662B%40recoil.org%3E"
       TITLE="[opam-devel] Using the new travis containers">anil at recoil.org
       </A><BR>
    <I>Thu May 14 15:58:37 BST 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001058.html">[opam-devel] Using the new travis containers
</A></li>
        <LI>Next message: <A HREF="001060.html">[opam-devel] Using the new travis containers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1059">[ date ]</a>
              <a href="thread.html#1059">[ thread ]</a>
              <a href="subject.html#1059">[ subject ]</a>
              <a href="author.html#1059">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 14 May 2015, at 13:30, Thomas Leonard &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">talex5 at gmail.com</A>&gt; wrote:
&gt;<i> 
</I>&gt;<i> Travis is currently migrating over to using containers for builds.
</I>&gt;<i> These start much faster than the old full VMs, but they don't give you
</I>&gt;<i> root access. This means that you can't use sudo to install packages
</I>&gt;<i> and should instead list them in your .travis.yml file.
</I>&gt;<i> 
</I>&gt;<i> Here's the confg that CueKeeper uses:
</I>&gt;<i> 
</I>&gt;<i>  <A HREF="https://github.com/talex5/cuekeeper/blob/master/.travis.yml">https://github.com/talex5/cuekeeper/blob/master/.travis.yml</A>
</I>&gt;<i> 
</I>&gt;<i> In summary:
</I>&gt;<i> 
</I>&gt;<i> 1. Add the `avsm` PPA to get an up-to-date OCaml.
</I>&gt;<i> 2. List all debs you need ahead of time.
</I>&gt;<i> 3. Put `FORK_USER=talex5 FORK_BRANCH=containers` in `env` so that it
</I>&gt;<i> uses my branch of ocaml-travisci-skeleton (tracking PR here:
</I>&gt;<i> <A HREF="https://github.com/ocaml/ocaml-travisci-skeleton/pull/41">https://github.com/ocaml/ocaml-travisci-skeleton/pull/41</A>)
</I>&gt;<i> 4. If using mirage, use `PINS=mirage` and use `mirage configure --no-depext`.
</I>
I'm honoured to be whitelisted by Travis :-)

It would be useful to have a command to generate the Travis file with
the full APT list.  What's the OPAM 1.2.x command to generate the depext
recursive list?

   opam pin add hdhcp
   opam install -e ubuntu hdhcp

Shows me no depexts, so is there a new command with &quot;opam list&quot; or similar
that I'm meant to use?


&gt;<i> 
</I>&gt;<i> Notes:
</I>&gt;<i> 
</I>&gt;<i> - All debs and PPAs must be whitelisted by Travis. avsm is whitelisted already.
</I>&gt;<i> 
</I>&gt;<i> - aspcud is not whitelisted (I've requested it here:
</I>&gt;<i> <A HREF="https://github.com/travis-ci/travis-ci/issues/3898">https://github.com/travis-ci/travis-ci/issues/3898</A>), which means that
</I>&gt;<i> the opam deb doesn't work reliably. Instead, my branch gets opam and
</I>&gt;<i> aspcud via 0install.
</I>&gt;<i> 
</I>&gt;<i> - There's no obvious way to specify which version of ocaml you want.
</I>&gt;<i> Perhaps Anil could add e.g. an `ocaml-4.01` with a suitable version
</I>&gt;<i> constraint?
</I>
I publish several PPAs for each combination of OPAM and OCaml:

<A HREF="https://launchpad.net/~avsm">https://launchpad.net/~avsm</A>

Is it possible to select the right PPA repository from this list,
or does this require individual whitelisting from Travis?

-anil
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001058.html">[opam-devel] Using the new travis containers
</A></li>
	<LI>Next message: <A HREF="001060.html">[opam-devel] Using the new travis containers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1059">[ date ]</a>
              <a href="thread.html#1059">[ thread ]</a>
              <a href="subject.html#1059">[ subject ]</a>
              <a href="author.html#1059">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/opam-devel">More information about the opam-devel
mailing list</a><br>
</body></html>
