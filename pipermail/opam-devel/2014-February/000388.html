<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [opam-devel] How to manage a package manager (Was: Re: [opam]	Build clarification (#1149))
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20How%20to%20manage%20a%20package%20manager%20%28Was%3A%20Re%3A%20%5Bopam%5D%0A%09Build%20clarification%20%28%231149%29%29&In-Reply-To=%3C3ABB157F-7343-4D17-AAC3-011CDAC5FC86%40recoil.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000386.html">
   <LINK REL="Next"  HREF="000387.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[opam-devel] How to manage a package manager (Was: Re: [opam]	Build clarification (#1149))</H1>
    <B>Anil Madhavapeddy</B> 
    <A HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20How%20to%20manage%20a%20package%20manager%20%28Was%3A%20Re%3A%20%5Bopam%5D%0A%09Build%20clarification%20%28%231149%29%29&In-Reply-To=%3C3ABB157F-7343-4D17-AAC3-011CDAC5FC86%40recoil.org%3E"
       TITLE="[opam-devel] How to manage a package manager (Was: Re: [opam]	Build clarification (#1149))">anil at recoil.org
       </A><BR>
    <I>Sun Feb  2 15:53:19 GMT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000386.html">[opam-devel] How to manage a package manager (Was: Re: [opam] Build clarification (#1149))
</A></li>
        <LI>Next message: <A HREF="000387.html">[opam-devel] How to manage a package manager (Was: Re: [opam]	Build clarification (#1149))
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#388">[ date ]</a>
              <a href="thread.html#388">[ thread ]</a>
              <a href="subject.html#388">[ subject ]</a>
              <a href="author.html#388">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1 Feb 2014, at 23:31, Daniel B&#252;nzli &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">daniel.buenzli at erratique.ch</A>&gt; wrote:

&gt;<i> Le samedi, 1 f&#233;vrier 2014 &#224; 19:27, Fabrice Le Fessant a &#233;crit :
</I>&gt;&gt;<i> Let's dream a little: in my ideal world, there would be an OPAM
</I>&gt;&gt;<i> _bytecode_ binary in the opam-repository, always the lattest stable
</I>&gt;&gt;<i> version, and able to upgrade whatever version I have of the
</I>&gt;&gt;<i> opam-repository to the lattest version. Everytime I would do &quot;opam
</I>&gt;&gt;<i> update&quot;, OPAM would first check that binary, download it if needed and
</I>&gt;&gt;<i> run it instead of itself (using the same trick as done by ocp-build
</I>&gt;&gt;<i> bytecode to be run on any system), upgrading the repo if needed, and
</I>&gt;&gt;<i> then do the update. The update would be almost completely transparent
</I>&gt;&gt;<i> (maybe OPAM would ask the user to authorize the update, since the user
</I>&gt;&gt;<i> has to trust a binary).
</I>&gt;<i> 
</I>&gt;<i> That seems a little bit overkill no ? And I don't like these binaries.  
</I>&gt;<i> 
</I>&gt;<i> Here's what my naivety says. Why not just have the latest version written in a text file you can GET e.g. at <A HREF="http://opam.ocaml.org/latest-version">http://opam.ocaml.org/latest-version</A> and on `opam update` check that url too. If there's a mismatch between the user's version and the one in <A HREF="http://opam.ocaml.org/latest-version">http://opam.ocaml.org/latest-version</A> propose to automatically upgrade by downloading the latest tarball in /tmp configure build and install (at the same previous location opam used to be).
</I>&gt;<i> 
</I>&gt;<i> That's actually exactly what I do manually these days, except I get the latest version announce from a mailing list rather than from <A HREF="http://opam.ocaml.org/latest-version.">http://opam.ocaml.org/latest-version.</A>  
</I>
We actually have fledgling support for just this, via the `repo` file
in the root of any OPAM remote:

<A HREF="https://github.com/ocaml/opam-repository/blob/master/repo">https://github.com/ocaml/opam-repository/blob/master/repo</A>

What we could do is just add a 'latest-opam-version' field to this
repo file, which would be a hint to the OPAM client to prompt the user
that a newer version is available.

Automating this process would be trickier, since it would corrupt the
checksums that package managers usually maintain if it was initially
installed by that source.  Just seeing the notification would be very
useful, however.

Dangat's point about the multiplicity of package managers reminds me
of a chat I had with the Macports developers a year ago about giving
OPAM a hook into Macports where it could add a hook to run `opam update`
when `ports update` is run.  If someone could investigate if that is
possible on modern package managers, that would be interesting...

-anil
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000386.html">[opam-devel] How to manage a package manager (Was: Re: [opam] Build clarification (#1149))
</A></li>
	<LI>Next message: <A HREF="000387.html">[opam-devel] How to manage a package manager (Was: Re: [opam]	Build clarification (#1149))
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#388">[ date ]</a>
              <a href="thread.html#388">[ thread ]</a>
              <a href="subject.html#388">[ subject ]</a>
              <a href="author.html#388">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/opam-devel">More information about the opam-devel
mailing list</a><br>
</body></html>
