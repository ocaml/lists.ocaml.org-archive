<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Hi&nbsp;opam-devel,&lt;br&gt;&lt;br&gt;&lt;/div&gt;Here&nbsp;is&nbsp;a&nbsp;rather&nbsp;cool&nbsp;bachelor&nbsp;thesis&nbsp;that&nbsp;seems&nbsp;relevant&nbsp;to&nbsp;OPAM&nbsp;repository&nbsp;management:&lt;br&gt;&lt;br&gt; &nbsp;Typosquatting&nbsp;in&nbsp;Programming&nbsp;Language&nbsp;Package&nbsp;Managers&lt;br&gt; &nbsp;Nikolai&nbsp;Philipp&nbsp;Tschacher,&nbsp;March&nbsp;2016&lt;br&gt; &nbsp;&lt;a&nbsp;href=&quot;http://incolumitas.com/2016/06/08/typosquatting-package-managers/&quot;&gt;http://incolumitas.com/2016/06/08/typosquatting-package-managers/&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;The&nbsp;described&nbsp;attack&nbsp;is&nbsp;to&nbsp;propose&nbsp;packages&nbsp;whose&nbsp;names&nbsp;are&nbsp;typo-close&nbsp;to&nbsp;very&nbsp;popular&nbsp;packages.&nbsp;Instead&nbsp;of&nbsp;&quot;opam&nbsp;install&nbsp;omake&quot;&nbsp;I&nbsp;run&nbsp;&quot;opam&nbsp;install&nbsp;omaek&quot;,&nbsp;but&nbsp;&quot;omaek&quot;&nbsp;exists&nbsp;and&nbsp;is&nbsp;attacker-controlled,&nbsp;and&nbsp;its&nbsp;install&nbsp;script&nbsp;wreaks&nbsp;havoc&nbsp;on&nbsp;my&nbsp;machine.&lt;br&gt;&lt;br&gt;&lt;/div&gt;This&nbsp;is&nbsp;interesting&nbsp;because&nbsp;it&nbsp;is&nbsp;a&nbsp;way&nbsp;to&nbsp;subvert&nbsp;a&nbsp;specific&nbsp;package&nbsp;that&nbsp;is&nbsp;immune&nbsp;to&nbsp;the&nbsp;common&nbsp;defenses&nbsp;against&nbsp;impersonation&nbsp;--&nbsp;signing&nbsp;a&nbsp;package&nbsp;with&nbsp;its&nbsp;maintainers&nbsp;keys,&nbsp;etc.&nbsp;The&nbsp;author&nbsp;of&nbsp;the&nbsp;thesis&nbsp;suggests&nbsp;three&nbsp;defense&nbsp;methods:&lt;br&gt;&lt;br&gt;&lt;/div&gt;1.&nbsp;Make&nbsp;package&nbsp;installation&nbsp;sandboxed&nbsp;in&nbsp;such&nbsp;a&nbsp;way&nbsp;that&nbsp;just&nbsp;installing&nbsp;a&nbsp;package&nbsp;is&nbsp;harmless&nbsp;as&nbsp;long&nbsp;as&nbsp;its&nbsp;code&nbsp;is&nbsp;not&nbsp;linked&nbsp;and&nbsp;run.&nbsp;(Of&nbsp;course&nbsp;this&nbsp;code&nbsp;may&nbsp;be&nbsp;linked&nbsp;and&nbsp;run&nbsp;if&nbsp;a&nbsp;developer&nbsp;also&nbsp;makes&nbsp;a&nbsp;typo&nbsp;in&nbsp;its&nbsp;software.)&lt;br&gt;&lt;br&gt;&lt;/div&gt;2.&nbsp;Alert&nbsp;repository&nbsp;administrators&nbsp;when&nbsp;a&nbsp;typo-candidate&nbsp;is&nbsp;proposed&nbsp;for&nbsp;integration.&nbsp;(This&nbsp;is&nbsp;especially&nbsp;relevant&nbsp;for&nbsp;repositories&nbsp;with&nbsp;no&nbsp;human&nbsp;oversight&nbsp;on&nbsp;package&nbsp;addition,&nbsp;but&nbsp;even&nbsp;for&nbsp;OPAM&nbsp;one&nbsp;may&nbsp;consider&nbsp;that&nbsp;the&nbsp;maintainers&nbsp;themselves&nbsp;may&nbsp;be&nbsp;fooled&nbsp;by&nbsp;the&nbsp;typo&nbsp;or&nbsp;not&nbsp;think&nbsp;of&nbsp;the&nbsp;security&nbsp;consequences.)&lt;br&gt;&lt;br&gt;&lt;/div&gt;3.&nbsp;Keep&nbsp;a&nbsp;log&nbsp;of&nbsp;the&nbsp;non-existing&nbsp;packages&nbsp;that&nbsp;users&nbsp;commonly&nbsp;try&nbsp;to&nbsp;install&nbsp;(good&nbsp;candidates&nbsp;for&nbsp;typos)&nbsp;and&nbsp;alert&nbsp;administrators&nbsp;when&nbsp;a&nbsp;matching&nbsp;package&nbsp;is&nbsp;proposed.&lt;br&gt;&lt;br&gt;I&#39;m&nbsp;sure&nbsp;that&nbsp;the&nbsp;systems&nbsp;expert&nbsp;in&nbsp;the&nbsp;room&nbsp;have&nbsp;plans&nbsp;for&nbsp;(1)&nbsp;already.&nbsp;I&nbsp;suspect&nbsp;that&nbsp;opam&#39;s&nbsp;architecture&nbsp;does&nbsp;not&nbsp;let&nbsp;us&nbsp;do&nbsp;(3),&nbsp;but&nbsp;I&nbsp;was&nbsp;interesting&nbsp;in&nbsp;quickly&nbsp;hacking&nbsp;(2)&nbsp;this&nbsp;morning&nbsp;--&nbsp;I&nbsp;suppose&nbsp;I&nbsp;like&nbsp;typo-detection&nbsp;stuff.&lt;br&gt;&lt;/div&gt;&lt;br&gt;My&nbsp;plan&nbsp;was:&nbsp;in&nbsp;`opam&nbsp;lint`,&nbsp;emit&nbsp;a&nbsp;warning&nbsp;if&nbsp;the&nbsp;linted&nbsp;package&nbsp;name&nbsp;is&nbsp;at&nbsp;edit&nbsp;distance&nbsp;2&nbsp;or&nbsp;less&nbsp;(but&nbsp;not&nbsp;0)&nbsp;of&nbsp;an&nbsp;existing&nbsp;package&nbsp;in&nbsp;the&nbsp;repository.&nbsp;But&nbsp;this&nbsp;does&nbsp;not&nbsp;quite&nbsp;work;&nbsp;I&nbsp;quickly&nbsp;looked&nbsp;at&nbsp;the&nbsp;code&nbsp;and&nbsp;it&nbsp;seems&nbsp;that&nbsp;&quot;opam&nbsp;lint&quot;&nbsp;is&nbsp;meant&nbsp;to&nbsp;be&nbsp;run&nbsp;purely&nbsp;locally,&nbsp;it&nbsp;does&nbsp;not&nbsp;have&nbsp;access&nbsp;to&nbsp;a&nbsp;base&nbsp;of&nbsp;packages&nbsp;available&nbsp;in&nbsp;the&nbsp;repository.&lt;br&gt;&lt;br&gt;&lt;/div&gt;So&nbsp;my&nbsp;question:&nbsp;where&nbsp;in&nbsp;the&nbsp;opam-repository&nbsp;QA&nbsp;process&nbsp;should&nbsp;I&nbsp;add&nbsp;a&nbsp;script&nbsp;(preferably&nbsp;written&nbsp;in&nbsp;OCaml&nbsp;rather&nbsp;than&nbsp;shell)&nbsp;that&nbsp;gets&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;packages&nbsp;proposed&nbsp;for&nbsp;inclusion,&nbsp;also&nbsp;has&nbsp;access&nbsp;to&nbsp;the&nbsp;name&nbsp;of&nbsp;existing&nbsp;packages&nbsp;in&nbsp;the&nbsp;repository,&nbsp;and&nbsp;can&nbsp;fail&nbsp;or&nbsp;warn&nbsp;if&nbsp;the&nbsp;proposed&nbsp;one&nbsp;is&nbsp;typo-close&nbsp;to&nbsp;an&nbsp;existing&nbsp;one?&lt;br&gt;&lt;br&gt;&lt;/div&gt;(This&nbsp;test&nbsp;can&nbsp;have&nbsp;false&nbsp;positives,&nbsp;eg.&nbsp;installing&nbsp;lablgtk2&nbsp;when&nbsp;lablgtk&nbsp;exists.&nbsp;It&nbsp;should&nbsp;still&nbsp;fail&nbsp;in&nbsp;a&nbsp;visible&nbsp;way&nbsp;in&nbsp;the&nbsp;UI,&nbsp;but&nbsp;not&nbsp;in&nbsp;a&nbsp;way&nbsp;that&nbsp;prevent&nbsp;other,&nbsp;more&nbsp;advanced&nbsp;tests,&nbsp;such&nbsp;as&nbsp;package&nbsp;installability.)&lt;br&gt;&lt;/div&gt;<br>

</tt>
