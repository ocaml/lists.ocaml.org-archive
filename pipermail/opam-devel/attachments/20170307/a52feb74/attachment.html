<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Dear&nbsp;opam-devel,&lt;br&gt;&lt;br&gt;&lt;/div&gt;As&nbsp;for&nbsp;previous&nbsp;OCaml&nbsp;releases,&nbsp;I&nbsp;am&nbsp;going&nbsp;through&nbsp;existing&nbsp;OCaml&nbsp;package&nbsp;to&nbsp;see&nbsp;what&nbsp;breaks&nbsp;in&nbsp;4.05.0&nbsp;to&nbsp;understand&nbsp;which&nbsp;parts&nbsp;of&nbsp;the&nbsp;ecosystem&nbsp;have&nbsp;to&nbsp;be&nbsp;upgraded&nbsp;early&nbsp;to&nbsp;provide&nbsp;a&nbsp;good&nbsp;user-experience&nbsp;at&nbsp;release&nbsp;time,&nbsp;and&nbsp;to&nbsp;find&nbsp;regressions&nbsp;in&nbsp;the&nbsp;compiler&nbsp;distribution.&nbsp;As&nbsp;I&nbsp;go&nbsp;over&nbsp;the&nbsp;invaluable&nbsp;opam-builder&nbsp;output&nbsp;(&nbsp;&lt;a&nbsp;href=&quot;http://opam.ocamlpro.com/builder/html/report-full.html&quot;&gt;http://opam.ocamlpro.com/builder/html/report-full.html&lt;/a&gt;&nbsp;),&nbsp;I&nbsp;often&nbsp;find&nbsp;packages&nbsp;that&nbsp;have&nbsp;incorrect&nbsp;metadata,&nbsp;independently&nbsp;of&nbsp;4.05.0,&nbsp;and&nbsp;I&nbsp;try&nbsp;to&nbsp;fix&nbsp;those&nbsp;when&nbsp;possible.&nbsp;Ideally,&nbsp;I&nbsp;think&nbsp;we&nbsp;should&nbsp;have&nbsp;no&nbsp;broken&nbsp;build&nbsp;in&nbsp;opam-builder&nbsp;all&nbsp;--&nbsp;for&nbsp;example,&nbsp;broken&nbsp;packages&nbsp;create&nbsp;more&nbsp;work&nbsp;for&nbsp;me&nbsp;when&nbsp;triaging&nbsp;the&nbsp;build&nbsp;outputs&nbsp;of&nbsp;a&nbsp;new&nbsp;ocamlbuild&nbsp;version.&lt;br&gt;&lt;br&gt;&lt;/div&gt;I&nbsp;find&nbsp;that&nbsp;*surprisingly&nbsp;many*&nbsp;opam&nbsp;packages&nbsp;have&nbsp;incorrect&nbsp;dependencies&nbsp;specified:&nbsp;they&nbsp;miss&nbsp;a&nbsp;lot&nbsp;of&nbsp;dependencies&nbsp;in&nbsp;the&nbsp;opam&nbsp;file.&lt;br&gt;&lt;br&gt;&lt;/div&gt;In&nbsp;retrospect,&nbsp;this&nbsp;is&nbsp;not&nbsp;very&nbsp;surprising:&nbsp;programmers&nbsp;test&nbsp;their&nbsp;software&nbsp;in&nbsp;their&nbsp;working&nbsp;OPAM&nbsp;switches,&nbsp;which&nbsp;already&nbsp;have&nbsp;these&nbsp;dependencies&nbsp;installed&nbsp;(obviously&nbsp;to&nbsp;work&nbsp;on&nbsp;the&nbsp;software&nbsp;itself,&nbsp;but&nbsp;also&nbsp;because&nbsp;they&nbsp;tend&nbsp;to&nbsp;work&nbsp;with&nbsp;other&nbsp;projects&nbsp;that&nbsp;already&nbsp;depend&nbsp;on&nbsp;those;&nbsp;so&nbsp;asking&nbsp;a&nbsp;colleague&nbsp;to&nbsp;install&nbsp;the&nbsp;software&nbsp;on&nbsp;their&nbsp;own&nbsp;machine,&nbsp;for&nbsp;example,&nbsp;will&nbsp;not&nbsp;catch&nbsp;these&nbsp;missing&nbsp;dependencies&nbsp;as&nbsp;colleagues&nbsp;have&nbsp;correlated&nbsp;installed&nbsp;package&nbsp;sets).&lt;br&gt;&lt;br&gt;&lt;/div&gt;It&nbsp;would&nbsp;be&nbsp;very&nbsp;nice&nbsp;if&nbsp;it&nbsp;was&nbsp;easy&nbsp;to&nbsp;ask&nbsp;opam&nbsp;to&nbsp;build&nbsp;a&nbsp;given&nbsp;local&nbsp;package&nbsp;/&nbsp;pin&nbsp;in&nbsp;a&nbsp;fresh,&nbsp;local,&nbsp;empty&nbsp;opam&nbsp;root.&nbsp;This&nbsp;would&nbsp;immediately&nbsp;catch&nbsp;these&nbsp;missing-dependencies&nbsp;problem,&nbsp;and&nbsp;it&nbsp;could&nbsp;be&nbsp;something&nbsp;we&nbsp;encourage&nbsp;packager&nbsp;to&nbsp;do&nbsp;after&nbsp;&quot;opam&nbsp;lint&quot;&nbsp;has&nbsp;succeeded.&lt;br&gt;&lt;br&gt;&lt;/div&gt;(This&nbsp;does&nbsp;not&nbsp;necessarily&nbsp;need&nbsp;to&nbsp;be&nbsp;a&nbsp;hardcoded&nbsp;opam&nbsp;feature,&nbsp;a&nbsp;simple&nbsp;script&nbsp;may&nbsp;do.&nbsp;I&nbsp;suppose&nbsp;that&nbsp;the&nbsp;way&nbsp;to&nbsp;do&nbsp;this&nbsp;also&nbsp;differs&nbsp;on&nbsp;opam&nbsp;1.x&nbsp;and&nbsp;opam&nbsp;2.x).&lt;br&gt;&lt;br&gt;&lt;/div&gt;Relatedly,&nbsp;I&nbsp;think&nbsp;that&nbsp;this&nbsp;phenomenon&nbsp;of&nbsp;correlated-dependencies&nbsp;can&nbsp;explain&nbsp;why&nbsp;certain&nbsp;kinds&nbsp;of&nbsp;Continuous&nbsp;Integration&nbsp;are&nbsp;more&nbsp;effective&nbsp;than&nbsp;others&nbsp;at&nbsp;catching&nbsp;those:&nbsp;opam-builder&nbsp;is&nbsp;very&nbsp;good&nbsp;at&nbsp;this,&nbsp;as&nbsp;it&nbsp;always&nbsp;build&nbsp;packages&nbsp;in&nbsp;an&nbsp;empty&nbsp;environment&nbsp;(this&nbsp;is&nbsp;made&nbsp;by&nbsp;cleverly&nbsp;caching&nbsp;builds&nbsp;to&nbsp;avoid&nbsp;rebuilding&nbsp;dependencies&nbsp;in&nbsp;that&nbsp;case),&nbsp;while&nbsp;the&nbsp;datakit&nbsp;CI&nbsp;on&nbsp;the&nbsp;opam-repository&nbsp;is&nbsp;not&nbsp;doing&nbsp;such&nbsp;a&nbsp;good&nbsp;job&nbsp;at&nbsp;detecting&nbsp;this&nbsp;specific&nbsp;issue,&nbsp;because&nbsp;it&nbsp;tends&nbsp;to&nbsp;test&nbsp;packages&nbsp;changes&nbsp;by&nbsp;update&nbsp;actions&nbsp;on&nbsp;top&nbsp;of&nbsp;an&nbsp;existing&nbsp;repository&nbsp;--&nbsp;this&nbsp;difference&nbsp;is&nbsp;good&nbsp;as&nbsp;it&nbsp;means&nbsp;that&nbsp;datakit&nbsp;will&nbsp;exercise&nbsp;other&nbsp;update&nbsp;paths&nbsp;and&nbsp;scenarios,&nbsp;and&nbsp;catch&nbsp;other&nbsp;kind&nbsp;of&nbsp;issues.&lt;br&gt;&lt;/div&gt;<br>

</tt>
