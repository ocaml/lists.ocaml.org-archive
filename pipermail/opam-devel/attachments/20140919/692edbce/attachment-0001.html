<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0//EN&quot;&nbsp;&quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;<br>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;name=&quot;qrichtext&quot;&nbsp;content=&quot;1&quot;&nbsp;/&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;<br>
p,&nbsp;li&nbsp;{&nbsp;white-space:&nbsp;pre-wrap;&nbsp;}<br>
&lt;/style&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;&nbsp;font-family:'Monospace';&nbsp;font-size:8pt;&nbsp;font-weight:400;&nbsp;font-style:normal;&quot;&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;Hi&nbsp;all,&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;As&nbsp;you&nbsp;may&nbsp;know,&nbsp;the&nbsp;1.2.0&nbsp;RC2&nbsp;has&nbsp;just&nbsp;been&nbsp;tagged&nbsp;[1].&nbsp;However,&nbsp;as&nbsp;discussed&nbsp;at&nbsp;[2],&nbsp;planning&nbsp;the&nbsp;migration&nbsp;of&nbsp;the&nbsp;repository&nbsp;is&nbsp;quite&nbsp;a&nbsp;delicate&nbsp;matter&nbsp;;&nbsp;this&nbsp;doesn't&nbsp;have&nbsp;to&nbsp;be&nbsp;done&nbsp;at&nbsp;the&nbsp;same&nbsp;time&nbsp;as&nbsp;the&nbsp;release&nbsp;itself,&nbsp;but&nbsp;some&nbsp;confusion&nbsp;may&nbsp;arise&nbsp;if&nbsp;we&nbsp;advertise&nbsp;a&nbsp;new&nbsp;workflow&nbsp;that&nbsp;leads&nbsp;to&nbsp;packages&nbsp;that&nbsp;get&nbsp;refused&nbsp;from&nbsp;the&nbsp;main&nbsp;repo&nbsp;because&nbsp;they're&nbsp;not&nbsp;1.1&nbsp;compatible.&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;We&nbsp;tried&nbsp;to&nbsp;improve&nbsp;compatibility&nbsp;for&nbsp;the&nbsp;next&nbsp;release,&nbsp;but&nbsp;for&nbsp;1.2&nbsp;there&nbsp;are&nbsp;just&nbsp;too&nbsp;many&nbsp;changes&nbsp;and&nbsp;opam&nbsp;1.1&nbsp;_won't_&nbsp;nicely&nbsp;handle&nbsp;them.&nbsp;So&nbsp;here&nbsp;is&nbsp;how&nbsp;I&nbsp;have&nbsp;been&nbsp;preparing:&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;-&nbsp;a&nbsp;batch&nbsp;conversion&nbsp;of&nbsp;the&nbsp;existing&nbsp;repo&nbsp;[7]:&nbsp;not&nbsp;required&nbsp;but&nbsp;useful&nbsp;for&nbsp;1.2&nbsp;(adding&nbsp;dev&nbsp;repos&nbsp;for&nbsp;archives&nbsp;held&nbsp;on&nbsp;github,&nbsp;setting&nbsp;ocamlfind&nbsp;deps&nbsp;as&nbsp;build-only,&nbsp;turning&nbsp;depopts&nbsp;constraints&nbsp;to&nbsp;conflicts&nbsp;[3]...).&nbsp;This&nbsp;is&nbsp;useful&nbsp;as&nbsp;a&nbsp;starting&nbsp;point&nbsp;for&nbsp;repo&nbsp;extension&nbsp;and&nbsp;example,&nbsp;and&nbsp;done&nbsp;using&nbsp;scripts&nbsp;in&nbsp;`admin-scripts/`&nbsp;[4]&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;-&nbsp;a&nbsp;`admin-scripts/to_1_1.ml`&nbsp;script&nbsp;in&nbsp;opam&nbsp;[5]&nbsp;that&nbsp;can&nbsp;convert&nbsp;a&nbsp;package&nbsp;back&nbsp;to&nbsp;1.1&nbsp;format.&nbsp;I&nbsp;successfully&nbsp;tested&nbsp;it&nbsp;on&nbsp;the&nbsp;above&nbsp;repo&nbsp;and&nbsp;with&nbsp;opam&nbsp;1.1&nbsp;;&nbsp;there&nbsp;may&nbsp;be&nbsp;corner&nbsp;cases&nbsp;on&nbsp;new&nbsp;1.2&nbsp;opam&nbsp;files&nbsp;that&nbsp;this&nbsp;didn't&nbsp;get&nbsp;into,&nbsp;but&nbsp;these&nbsp;can&nbsp;be&nbsp;caught&nbsp;by&nbsp;Travis&nbsp;before&nbsp;they&nbsp;break.&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;-&nbsp;updated&nbsp;admin&nbsp;scripts&nbsp;on&nbsp;the&nbsp;11-bridge&nbsp;branch&nbsp;of&nbsp;opam.ocaml.org&nbsp;[6].&nbsp;The&nbsp;new&nbsp;scripts&nbsp;create&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;repo&nbsp;at&nbsp;opam.ocaml.org/1.1/,&nbsp;branch&nbsp;version-triggered&nbsp;redirects&nbsp;between&nbsp;the&nbsp;two,&nbsp;and&nbsp;apply&nbsp;the&nbsp;above&nbsp;script&nbsp;to&nbsp;the&nbsp;1.1&nbsp;repo&nbsp;mirror&nbsp;at&nbsp;every&nbsp;update.&nbsp;This&nbsp;should&nbsp;make&nbsp;it&nbsp;transparent&nbsp;whichever&nbsp;opam&nbsp;version&nbsp;is&nbsp;used.&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;-&nbsp;tested&nbsp;the&nbsp;opam.ocaml.org&nbsp;scripts&nbsp;on&nbsp;a&nbsp;local&nbsp;mirror&nbsp;I&nbsp;set&nbsp;up,&nbsp;and&nbsp;they&nbsp;seem&nbsp;to&nbsp;work&nbsp;fine&nbsp;(after&nbsp;_a&nbsp;lot_&nbsp;of&nbsp;tweaking)&nbsp;;&nbsp;note&nbsp;that&nbsp;these&nbsp;can&nbsp;be&nbsp;pushed&nbsp;live&nbsp;beforehand,&nbsp;they'll&nbsp;set&nbsp;up&nbsp;the&nbsp;redirects&nbsp;but&nbsp;the&nbsp;translation&nbsp;script&nbsp;doesn't&nbsp;change&nbsp;opam&nbsp;files&nbsp;with&nbsp;`opam-version`&nbsp;&lt;&nbsp;&quot;1.2&quot;&nbsp;so&nbsp;it&nbsp;won't&nbsp;cause&nbsp;any&nbsp;user-visible&nbsp;changes&nbsp;until&nbsp;we&nbsp;actually&nbsp;accept&nbsp;1.2&nbsp;opam&nbsp;files&nbsp;in&nbsp;the&nbsp;repo&nbsp;(except&nbsp;for&nbsp;the&nbsp;&quot;permanently&nbsp;redirected&quot;&nbsp;message)&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;What&nbsp;remains&nbsp;to&nbsp;do:&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;-&nbsp;setup&nbsp;the&nbsp;opam-repository&nbsp;travis&nbsp;scripts&nbsp;to&nbsp;apply&nbsp;the&nbsp;1.1&nbsp;rewrite&nbsp;before&nbsp;testing,&nbsp;for&nbsp;opam&nbsp;versions&nbsp;&lt;&nbsp;1.2.&nbsp;Only&nbsp;tricky&nbsp;part&nbsp;is&nbsp;to&nbsp;get&nbsp;hold&nbsp;of&nbsp;a&nbsp;recent&nbsp;enough&nbsp;opam-lib&nbsp;to&nbsp;run&nbsp;the&nbsp;script&nbsp;(maybe&nbsp;we&nbsp;could&nbsp;cheat&nbsp;and&nbsp;put&nbsp;a&nbsp;standalone&nbsp;bytecode&nbsp;exe&nbsp;on&nbsp;opam-repository&nbsp;for&nbsp;that&nbsp;;&nbsp;well&nbsp;one&nbsp;for&nbsp;4.01&nbsp;and&nbsp;one&nbsp;for&nbsp;4.02&nbsp;since&nbsp;the&nbsp;format&nbsp;changed...).&nbsp;This&nbsp;way&nbsp;PRs&nbsp;to&nbsp;opam-repo&nbsp;containing&nbsp;1.2&nbsp;opam&nbsp;files&nbsp;will&nbsp;be&nbsp;correctly&nbsp;tested,&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;rewrite.&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;-&nbsp;release&nbsp;!&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;Finally,&nbsp;note&nbsp;that&nbsp;I'll&nbsp;be&nbsp;moving&nbsp;across&nbsp;the&nbsp;globe&nbsp;next&nbsp;week,&nbsp;and&nbsp;won't&nbsp;be&nbsp;available&nbsp;for&nbsp;two&nbsp;weeks&nbsp;or&nbsp;so.&nbsp;Everything&nbsp;should&nbsp;be&nbsp;ready&nbsp;to&nbsp;release&nbsp;as&nbsp;soon&nbsp;as&nbsp;I&nbsp;get&nbsp;back.&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;Cheers,&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;Louis&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;[1]&nbsp;https://github.com/ocaml/opam/releases/tag/1.2.0-rc2&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;[2]&nbsp;https://github.com/ocaml/opam/issues/1662&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;[3]&nbsp;https://github.com/ocaml/opam/pull/1325&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;[4]&nbsp;https://github.com/ocaml/opam/tree/master/admin-scripts&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;[5]&nbsp;https://github.com/ocaml/opam/pull/1743&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;[6]&nbsp;https://github.com/ocaml/opam.ocaml.org/tree/11-bridge&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;[7]&nbsp;https://github.com/ocaml/opam-repository/tree/1.2-test&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;PS:&nbsp;during&nbsp;the&nbsp;course&nbsp;of&nbsp;these&nbsp;tests,&nbsp;I&nbsp;sadly&nbsp;found&nbsp;out&nbsp;that&nbsp;repo&nbsp;redirect&nbsp;handling&nbsp;in&nbsp;1.1&nbsp;wasn't&nbsp;that&nbsp;good:&nbsp;it&nbsp;works&nbsp;at&nbsp;update&nbsp;but&nbsp;not&nbsp;straight-away&nbsp;at&nbsp;init.&nbsp;See&nbsp;comment&nbsp;at&nbsp;https://github.com/ocaml/opam/pull/1744&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
