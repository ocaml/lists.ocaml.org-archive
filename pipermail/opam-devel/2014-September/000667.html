<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [opam-devel] Travis CI failures
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Travis%20CI%20failures&In-Reply-To=%3C95EC1B02-B66F-4590-B7D9-FE2AF29F52AE%40cam.ac.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000666.html">
   <LINK REL="Next"  HREF="000668.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[opam-devel] Travis CI failures</H1>
    <B>Amir Chaudhry</B> 
    <A HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Travis%20CI%20failures&In-Reply-To=%3C95EC1B02-B66F-4590-B7D9-FE2AF29F52AE%40cam.ac.uk%3E"
       TITLE="[opam-devel] Travis CI failures">amc79 at cam.ac.uk
       </A><BR>
    <I>Mon Sep 29 17:47:19 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000666.html">[opam-devel] Travis CI failures
</A></li>
        <LI>Next message: <A HREF="000668.html">[opam-devel] Travis CI failures
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#667">[ date ]</a>
              <a href="thread.html#667">[ thread ]</a>
              <a href="subject.html#667">[ subject ]</a>
              <a href="author.html#667">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 29 Sep 2014, at 17:36, Ashish Agarwal &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">agarwal1975 at gmail.com</A>&gt; wrote:

&gt;<i> Are the travis scripts for opam public? Where are they? Maybe I can learn from them.
</I>
Do you mean the files in the opam repo [1]? You can see the travis outputs online too [2], though I note that the build matrix doesn't include 4.02.0, (though the script does).

[1] <A HREF="https://github.com/ocaml/opam/blob/master/.travis-ci.sh">https://github.com/ocaml/opam/blob/master/.travis-ci.sh</A>
[2] <A HREF="https://travis-ci.org/ocaml/opam">https://travis-ci.org/ocaml/opam</A> 

AC

&gt;<i> 
</I>&gt;<i> In my own repos, I haven't managed to use the system compiler. I'm forced to do `opam switch --comp=4.02.0`, which causes me to compile ocaml every time. Here are the problems I have with the binary system compilers:
</I>&gt;<i> 
</I>&gt;<i> On Ubuntu
</I>&gt;<i> I use Anil's PPAs, and successfully do:
</I>&gt;<i> 
</I>&gt;<i> apt-get install ocaml opam camlp4
</I>&gt;<i> 
</I>&gt;<i> However, I then request to install a bunch of opam packges and am told that:
</I>&gt;<i> 
</I>&gt;<i> The following actions will be performed:
</I>&gt;<i> 
</I>&gt;<i>  - install   camlp4.4.02.0+system                  [required by variantslib, tyxml, type_conv, sexplib, pgocaml, pa_ounit, optcomp, ocamlscript, js_of_ocaml, fieldslib, enumerate, custom_printf, core_kernel, comparelib, bitstring, async_unix, async_extra, async, async_kernel, bin_prot, camomile, core, cudf, dyntype, extlib, herelib, lwt, ocp-build, pa_bench, pa_test, pipebang, textutils, typerep, ulex]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> And then installation of camlp4 fails with:
</I>&gt;<i> 
</I>&gt;<i> ./check-camlp4.sh: 3: ./check-camlp4.sh: camlp4orf: not found
</I>&gt;<i> 
</I>&gt;<i> Indeed camlp4orf is not installed.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On CentOS
</I>&gt;<i> I follow the instructions here, successfully do `yum install ocaml opam` (it seems there is no camlp4 binary provided). I then request to install a bunch of opam packages, and many fail with:
</I>&gt;<i> 
</I>&gt;<i> Cannot find external tool 'ocamldoc'
</I>&gt;<i> 
</I>&gt;<i> Indeed ocamldoc is not installed.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> If I can get the correct procedure to follow, I'll be happy to update ocaml.org's Install page.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Mon, Sep 29, 2014 at 9:24 AM, Anil Madhavapeddy &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">anil at recoil.org</A>&gt; wrote:
</I>&gt;<i> None of the time is spent installing OCaml on the basic Linux install, since I've been compiling up a set of binary Debs/RPMs of the matrix of OCaml and OPAM versions (e.g. see <A HREF="https://launchpad.net/~avsm">https://launchpad.net/~avsm</A>).  We only compile from source on the Mac, which is optional.
</I>&gt;<i> 
</I>&gt;<i> If someone is interested in proposing official OCaml support, a good template for anyone wishing to OCaml support in Travis is the pull request to add Rust support here:
</I>&gt;<i> <A HREF="https://github.com/travis-ci/travis-build/pull/264/files">https://github.com/travis-ci/travis-build/pull/264/files</A>
</I>&gt;<i> 
</I>&gt;<i> -anil
</I>&gt;<i> 
</I>&gt;<i> On 29 Sep 2014, at 14:20, Ashish Agarwal &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">agarwal1975 at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> About 10 - 20 minutes out of the 50 get used up installing OCaml and basic libraries every time. Has anyone looked into getting OCaml as one of the natively supported languages by Travis? I'm not sure how it works, but ideally we could have preinstalled images with various versions of OCaml, opam, and several of the main libraries pre-installed.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On Sun, Sep 28, 2014 at 4:03 PM, Anil Madhavapeddy &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">anil at recoil.org</A>&gt; wrote:
</I>&gt;&gt;<i> On 28 Sep 2014, at 16:38, Thomas Gazagnaire &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">thomas at gazagnaire.org</A>&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> &gt; Hi all,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Recently I saw Travis CI to be quite unreliable. It took sometimes hours to start and very often I need to manually re-lauch some tests because of connectivity errors. I don't complain too loudly because it's a free (and very useful) service, but I am wondering if we should not upgrade to something a bit more reliable.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Looking at <A HREF="https://travis-ci.com/plans">https://travis-ci.com/plans</A> they seem to have few paying offer which might be interesting, although I am not sure to understand if this will solve the current issues. And it looks a little bit expensive, but we rely on the free service a lot already.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Also, ideally we should use Travis CI to only coordinate the build on the Rackspace VMs but we don't have that infrastructure in place yet, so  maybe we should switch to a paying service for few months.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> My understanding is that the paid Travis service doesn't entirely help with the existing issues, which are infrastructure overload on their part.  The paid service increases the number of parallel builds, but still (e.g.) enforces the per-job 50 minute limit.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I'll prioritise the Rackspace VM work to let us unlock more builds.  We're seeing an increasing number of repository failures due to the lack of reverse-transitive checking of builds, and that should be very easy to do in parallel on VM infrastructure.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> (I may be wrong about the latest in paid Travis -- if anyone wants to enquire with them, please do let me know.  I'm happy to pay for the service if it would solve any problems.)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> -anil
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> opam-devel mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/opam-devel">opam-devel at lists.ocaml.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/opam-devel">http://lists.ocaml.org/listinfo/opam-devel</A>
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> opam-devel mailing list
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/opam-devel">opam-devel at lists.ocaml.org</A>
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/opam-devel">http://lists.ocaml.org/listinfo/opam-devel</A>
</I>
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000666.html">[opam-devel] Travis CI failures
</A></li>
	<LI>Next message: <A HREF="000668.html">[opam-devel] Travis CI failures
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#667">[ date ]</a>
              <a href="thread.html#667">[ thread ]</a>
              <a href="subject.html#667">[ subject ]</a>
              <a href="author.html#667">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/opam-devel">More information about the opam-devel
mailing list</a><br>
</body></html>
