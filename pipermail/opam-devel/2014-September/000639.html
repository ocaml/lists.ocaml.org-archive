<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [opam-devel] Opam 1.2 breaks emacs on the mac sortof
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Opam%201.2%20breaks%20emacs%20on%20the%20mac%20sortof&In-Reply-To=%3CCADKNfh%2B2H1J9yg6YJ3j5z8XbTw2NnE90mct7aY6NeR8Gr9pysw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000638.html">
   <LINK REL="Next"  HREF="000640.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[opam-devel] Opam 1.2 breaks emacs on the mac sortof</H1>
    <B>Yaron Minsky</B> 
    <A HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Opam%201.2%20breaks%20emacs%20on%20the%20mac%20sortof&In-Reply-To=%3CCADKNfh%2B2H1J9yg6YJ3j5z8XbTw2NnE90mct7aY6NeR8Gr9pysw%40mail.gmail.com%3E"
       TITLE="[opam-devel] Opam 1.2 breaks emacs on the mac sortof">yminsky at gmail.com
       </A><BR>
    <I>Tue Sep  9 15:37:48 BST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000638.html">[opam-devel] Opam 1.2 breaks emacs on the mac sortof
</A></li>
        <LI>Next message: <A HREF="000640.html">[opam-devel] Opam 1.2 breaks emacs on the mac sortof
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#639">[ date ]</a>
              <a href="thread.html#639">[ thread ]</a>
              <a href="subject.html#639">[ subject ]</a>
              <a href="author.html#639">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hmm.  I just tried your elisp code, and it doesn't quite get me there.
In particular, compilation now looks fine, but utop and merlin no
longer work, because emacs can no longer find them.  In particular, by
not extending exec-path, you lose the ability to directly invoke those
commands.  Also, a shell buffer (created with M-x shell) has the wrong
path, i.e., the path without opam putting its stuff in.  Maybe I
should put the opam stuff in the .bashrc.

Do those things work properly for you?

y

On Tue, Sep 9, 2014 at 8:21 AM, Daniel B&#252;nzli
&lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">daniel.buenzli at erratique.ch</A>&gt; wrote:
&gt;<i> Le mardi, 9 septembre 2014 &#224; 13:11, Yaron Minsky a &#233;crit :
</I>&gt;&gt;<i> Can someone confirm that the change in how &quot;opam config env&quot; really
</I>&gt;&gt;<i> happened between 1.1.2 and 1.2?
</I>&gt;<i>
</I>&gt;<i> Could you exhibit a sample invocation showing the problem ? I do use the
</I>&gt;<i>
</I>&gt;<i> (setq shell-command-switch &quot;-lc&quot;)
</I>&gt;<i>
</I>&gt;<i> trick. But none of the other things except a
</I>&gt;<i>
</I>&gt;<i> (add-to-list 'load-path
</I>&gt;<i>  (concat
</I>&gt;<i>   (replace-regexp-in-string &quot;\n$&quot; &quot;&quot;
</I>&gt;<i>   (shell-command-to-string &quot;opam config var share&quot;))
</I>&gt;<i>   &quot;/emacs/site-lisp&quot;))
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> and things don't break here, at least in compilation mode.
</I>&gt;<i>
</I>&gt;<i> If I switch and try an `ocamlc -version` I get the correct ocamlc invoked. I suspect you should drop that `opam config env &#8212;sexp` thing aswell as updating the exec-path. These things are only going to be invoked once and thus will not adapt to the current switch (as won't the above addition to 'load-path).
</I>&gt;<i>
</I>&gt;<i> Best,
</I>&gt;<i>
</I>&gt;<i> Daniel
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> opam-devel mailing list
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/opam-devel">opam-devel at lists.ocaml.org</A>
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/opam-devel">http://lists.ocaml.org/listinfo/opam-devel</A>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000638.html">[opam-devel] Opam 1.2 breaks emacs on the mac sortof
</A></li>
	<LI>Next message: <A HREF="000640.html">[opam-devel] Opam 1.2 breaks emacs on the mac sortof
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#639">[ date ]</a>
              <a href="thread.html#639">[ thread ]</a>
              <a href="subject.html#639">[ subject ]</a>
              <a href="author.html#639">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/opam-devel">More information about the opam-devel
mailing list</a><br>
</body></html>
