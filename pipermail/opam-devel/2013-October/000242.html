<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [opam-devel] opam binary snapshot
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20opam%20binary%20snapshot&In-Reply-To=%3C52725A12.4010202%40eu.citrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000240.html">
   <LINK REL="Next"  HREF="000244.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[opam-devel] opam binary snapshot</H1>
    <B>Jon Ludlam</B> 
    <A HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20opam%20binary%20snapshot&In-Reply-To=%3C52725A12.4010202%40eu.citrix.com%3E"
       TITLE="[opam-devel] opam binary snapshot">jonathan.ludlam at eu.citrix.com
       </A><BR>
    <I>Thu Oct 31 13:24:34 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000240.html">[opam-devel] opam binary snapshot
</A></li>
        <LI>Next message: <A HREF="000244.html">[opam-devel] opam binary snapshot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#242">[ date ]</a>
              <a href="thread.html#242">[ thread ]</a>
              <a href="subject.html#242">[ subject ]</a>
              <a href="author.html#242">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 31/10/13 12:40, Anil Madhavapeddy wrote:
&gt;<i> On 15 Oct 2013, at 00:36, Mika Illouz &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">mika at illouz.net</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Our current system involves packaging up OCaml stuff as
</I>&gt;&gt;<i> debian packages, and distributing them to ubuntu clients in binary
</I>&gt;&gt;<i> form via a internal debian repo.  This gets the ocaml dependencies
</I>&gt;&gt;<i> necessary to build stuff, even to those don't develop in ocaml, with
</I>&gt;&gt;<i> minimal cognitive overload.  
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Some of my colleagues think that distributing ocaml dependencies in
</I>&gt;&gt;<i> binary form is ultimately more stable.  I am wondering whether I can
</I>&gt;&gt;<i> satisfy them, with a solution that somehow exports as binary snapshot
</I>&gt;&gt;<i> of everything under ~/.opam/4.01/  .  One idea is to define a debian
</I>&gt;&gt;<i> package for a blessed ~/.opam/4.01/ , and export it via our internal
</I>&gt;&gt;<i> debian repo.  Another idea is just export it to clients via rsync, or
</I>&gt;&gt;<i> some other shared global storage. 
</I>&gt;<i> [Ccing opam-devel and also Citrix/Rackspace folk, as this came up
</I>&gt;<i> last week in XenSummit).
</I>&gt;<i>
</I>&gt;<i> In general, I'd like to figure out how to use OPAM to build RPMs and
</I>&gt;<i> Debs just as easily as it can currently do ocamlfind installations.
</I>&gt;<i> In the short-term, I suspect that if you use a system compiler and
</I>&gt;<i> have enough external dependency information in the OPAM repository,
</I>&gt;<i> we could get away with quite a lot by tarring up the .opam directory.
</I>&gt;<i>
</I>&gt;<i> This has also been a frequent request for teaching purposes, so I'd
</I>&gt;<i> like to experiment with version controlling .opam -- this would just
</I>&gt;<i> require hooks when adding/creating files in the subdirectory hierarchy,
</I>&gt;<i> although it would probably be too slow to shell out every time
</I>&gt;<i> (Thomas' cagit OCaml library may come in useful here).
</I>&gt;<i>
</I>&gt;<i> Dave/Jon/John, any thoughts on this?
</I>&gt;<i>
</I>&gt;<i> -anil
</I>
RPMs/debs would definitely be nice. There would be a problem doing this
right now as you'd have to do some sort of two pass thing to get the
list of files installed by the package, which is required for both RPMs
and debs.

One slightly odd thing about tarring up the .opam directory is that it's
usually something that lives in a user's home directory. I wonder if any
of the packages might have hard-coded paths in there which would mean
having to install it into exactly the same place - so requiring the same
user. I guess a quick grep through the .opam dir would tell you this.

Jon


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000240.html">[opam-devel] opam binary snapshot
</A></li>
	<LI>Next message: <A HREF="000244.html">[opam-devel] opam binary snapshot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#242">[ date ]</a>
              <a href="thread.html#242">[ thread ]</a>
              <a href="subject.html#242">[ subject ]</a>
              <a href="author.html#242">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/opam-devel">More information about the opam-devel
mailing list</a><br>
</body></html>
