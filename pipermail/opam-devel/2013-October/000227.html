<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [opam-devel] Ideas from Node.js
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Ideas%20from%20Node.js&In-Reply-To=%3CCAOCAUGMwkPgQnmr%3D-zeNE278bBrXCoqnj01Rajijh%2B7sWW0hMw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000225.html">
   <LINK REL="Next"  HREF="000228.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[opam-devel] Ideas from Node.js</H1>
    <B>Sylvain Le Gall</B> 
    <A HREF="mailto:opam-devel%40lists.ocaml.org?Subject=Re%3A%20%5Bopam-devel%5D%20Ideas%20from%20Node.js&In-Reply-To=%3CCAOCAUGMwkPgQnmr%3D-zeNE278bBrXCoqnj01Rajijh%2B7sWW0hMw%40mail.gmail.com%3E"
       TITLE="[opam-devel] Ideas from Node.js">sylvain+ocaml at le-gall.net
       </A><BR>
    <I>Sat Oct 12 11:01:02 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000225.html">[opam-devel] Ideas from Node.js
</A></li>
        <LI>Next message: <A HREF="000228.html">[opam-devel] Ideas from Node.js
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#227">[ date ]</a>
              <a href="thread.html#227">[ thread ]</a>
              <a href="subject.html#227">[ subject ]</a>
              <a href="author.html#227">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2013/10/12 Anil Madhavapeddy &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">anil at recoil.org</A>&gt;:
&gt;<i>
</I>&gt;<i> On 11 Oct 2013, at 23:00, Sylvain Le Gall &lt;<A HREF="http://lists.ocaml.org/listinfo/opam-devel">sylvain+ocaml at le-gall.net</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is something already somehow do-able with OASIS: just embed an
</I>&gt;&gt;<i> _oasis (more rfc822 than JSON) and use oasis2opam to convert the
</I>&gt;&gt;<i> _oasis to OPAM required files.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://oasis.forge.ocamlcore.org">http://oasis.forge.ocamlcore.org</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If OPAM dev would integrate a little more with OASIS (i.e. get rid of
</I>&gt;&gt;<i> oasis2opam to directly read data from _oasis distributed with upstream
</I>&gt;&gt;<i> package) and allow override using classic OPAM files, it will be super
</I>&gt;&gt;<i> easy to release OASIS package directly in OPAM.
</I>&gt;<i>
</I>&gt;<i> This has the same problem that Malcolm just explained -- you tie the
</I>&gt;<i> metadata to some file *inside* the package, which requires distribution
</I>&gt;<i> patches if you want to override it.
</I>&gt;<i>
</I>&gt;<i> What's wrong with oasis2opam that can't be fixed with a shell script
</I>&gt;<i> wrapper `opam-mk-oasis-package` or something similar?
</I>&gt;<i>
</I>
I agree on the need of separation of package metadata (because they
often need patching for distribution) with the rest of the package. As
said, I think the current design is fine.

What would be nice is to have this opam-mk-oasis-package integrated
inside OPAM worflow. This would allow to remove one step when
publishing package on OPAM.

Here is the process I would like to see:
- enter a the URL of your tarball in a box on opam.ocamlpro.com
- download the tarball
- if the tarball/_oasis is fine, just create all required files using
oasis2opam and publish opam/packages/X.V/{opam,url,descr} (no install
of oasis2opam, no github fork, no pull request on client side, maybe
some on server side)
- if later you have to patch files, patch directly the generated
opam|url|descr (normal process)

Advantage:
- you can bootstrap package metadata from upstream description (thanks
to oasis2opam)
- the full process is very close to a normal OPAM publishing workflow,
changes needed to OPAM can be almost 0

The goal is to have just a single step to upload an OPAM package from
upstream sources in best case, if the _oasis coming along the upstream
package is fine.

Let say the issue is more about integration than design (I think we
have all piece to create this process and now the question is: does it
make sense to integrate it inside OPAM directly).

Are my explanation clear?

Side note, this process is inspired by the one I have on OASIS-DB (and
also by the missing feature I have there). If OPAM upstream agree on
this plan, I can do a demo on OASIS-DB before having it running on
<A HREF="http://opam.ocamlpro.com.">http://opam.ocamlpro.com.</A> It will take a little bit of time, because I
am an OPAM dev beginner.

Regards
Sylvain
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000225.html">[opam-devel] Ideas from Node.js
</A></li>
	<LI>Next message: <A HREF="000228.html">[opam-devel] Ideas from Node.js
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#227">[ date ]</a>
              <a href="thread.html#227">[ thread ]</a>
              <a href="subject.html#227">[ subject ]</a>
              <a href="author.html#227">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/opam-devel">More information about the opam-devel
mailing list</a><br>
</body></html>
