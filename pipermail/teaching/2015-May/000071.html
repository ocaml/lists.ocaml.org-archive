<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Teaching] Backtraces in toplevel
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:teaching%40lists.ocaml.org?Subject=Re%3A%20%5BTeaching%5D%20Backtraces%20in%20toplevel&In-Reply-To=%3CCAPFanBFGLzJiNDdf2dgFqAg%2BDSWRwOHKLy%2B7yLf7TnGHCE8VVA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000070.html">
   <LINK REL="Next"  HREF="000072.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Teaching] Backtraces in toplevel</H1>
    <B>Gabriel Scherer</B> 
    <A HREF="mailto:teaching%40lists.ocaml.org?Subject=Re%3A%20%5BTeaching%5D%20Backtraces%20in%20toplevel&In-Reply-To=%3CCAPFanBFGLzJiNDdf2dgFqAg%2BDSWRwOHKLy%2B7yLf7TnGHCE8VVA%40mail.gmail.com%3E"
       TITLE="[Teaching] Backtraces in toplevel">gabriel.scherer at gmail.com
       </A><BR>
    <I>Tue May 12 12:46:56 BST 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="000070.html">[Teaching] Backtraces in toplevel
</A></li>
        <LI>Next message: <A HREF="000072.html">[Teaching] Backtraces in toplevel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71">[ date ]</a>
              <a href="thread.html#71">[ thread ]</a>
              <a href="subject.html#71">[ subject ]</a>
              <a href="author.html#71">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I don't think you need the toplevel itself to be compiled with -g to get
stack traces (that would be true of stack traces raised by exception inside
the toplevel implementation, but those correspond to OCaml implementation
bugs, not to bugs in your student's programs). However, in existing
released versions of OCaml I suspect that stack traces are not available
for code defined from the toplevel (I think it works for libraries compiled
outside the toplevel and linked/loaded from the toplevel, but not for
functions defined directly by sending phrases to the toplevel). This was
the topic of the issue report PR#6468 (
<A HREF="http://caml.inria.fr/mantis/view.php?id=6468">http://caml.inria.fr/mantis/view.php?id=6468</A> ), and Peter Zotov developed a
patch to implement that feature. It will be available in the next *major*
release of the OCaml distribution (around autumn/winter), but if you
already maintain a fork you could try to backport it.



On Tue, May 12, 2015 at 10:48 AM, Yann Salmon &lt;<A HREF="http://lists.ocaml.org/listinfo/teaching">yann.salmon at prepas.org</A>&gt;
wrote:

&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I have recently started using Arthur Chargu&#233;raud's experimental OCaml
</I>&gt;<i> compiler and top-level with improved type error messages. This is great
</I>&gt;<i> and the students are now able to gain better autonomy in programming. I
</I>&gt;<i> modified the OCaml source code to enable easy-type-errors by default.
</I>&gt;<i>
</I>&gt;<i> However, Arthur's patch cannot improve runtime error messages, like the
</I>&gt;<i> frequent Out-of-bound access exception. For this, I would like the OCaml
</I>&gt;<i> toplevel to automatically print a backtrace.
</I>&gt;<i>
</I>&gt;<i> I understand that I should do two things :
</I>&gt;<i>  1. compile the toplevel with -g
</I>&gt;<i>  2. run the toplevel with OCAMLRUNPARAM set to B.
</I>&gt;<i>
</I>&gt;<i> I do not understand however what I should change in the makefiles to
</I>&gt;<i> pass the -g option correctly (my attempts were not successful), and I am
</I>&gt;<i> not sure what parts of the OCaml source code I should change to get de
</I>&gt;<i> backtrace printing behaviour enabled by default.
</I>&gt;<i>
</I>&gt;<i> Can somebody help ?
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Cordialement,
</I>&gt;<i> Yann Salmon
</I>&gt;<i>
</I>&gt;<i> Informatique
</I>&gt;<i> MPSI, PCSI, MP*, PC*
</I>&gt;<i> Descartes - Tours
</I>&gt;<i>
</I>&gt;<i> &lt;<A HREF="http://pro.yannsalmon.fr/">http://pro.yannsalmon.fr/</A>&gt;
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Teaching mailing list
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/teaching">Teaching at lists.ocaml.org</A>
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/teaching">http://lists.ocaml.org/listinfo/teaching</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ocaml.org/pipermail/teaching/attachments/20150512/6ce99704/attachment.html">http://lists.ocaml.org/pipermail/teaching/attachments/20150512/6ce99704/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000070.html">[Teaching] Backtraces in toplevel
</A></li>
	<LI>Next message: <A HREF="000072.html">[Teaching] Backtraces in toplevel
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71">[ date ]</a>
              <a href="thread.html#71">[ thread ]</a>
              <a href="subject.html#71">[ subject ]</a>
              <a href="author.html#71">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/teaching">More information about the Teaching
mailing list</a><br>
</body></html>
