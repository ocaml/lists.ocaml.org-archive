<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ocaml-platform] Unique file names
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:platform%40lists.ocaml.org?Subject=Re%3A%20%5Bocaml-platform%5D%20Unique%20file%20names&In-Reply-To=%3CCACLX4jT4C_Fh2_T_b1WSdXJJK2Jar%3DqaAvH6xrU%2BgVkpUmQQGw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000234.html">
   <LINK REL="Next"  HREF="000236.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ocaml-platform] Unique file names</H1>
    <B>Yaron Minsky</B> 
    <A HREF="mailto:platform%40lists.ocaml.org?Subject=Re%3A%20%5Bocaml-platform%5D%20Unique%20file%20names&In-Reply-To=%3CCACLX4jT4C_Fh2_T_b1WSdXJJK2Jar%3DqaAvH6xrU%2BgVkpUmQQGw%40mail.gmail.com%3E"
       TITLE="[ocaml-platform] Unique file names">yminsky at janestreet.com
       </A><BR>
    <I>Tue Mar  5 17:36:07 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000234.html">[ocaml-platform] Unique file names
</A></li>
        <LI>Next message: <A HREF="000236.html">[ocaml-platform] Unique file names
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#235">[ date ]</a>
              <a href="thread.html#235">[ thread ]</a>
              <a href="subject.html#235">[ subject ]</a>
              <a href="author.html#235">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Mar 5, 2013 at 11:07 AM, Alain Frisch &lt;<A HREF="http://lists.ocaml.org/listinfo/platform">alain.frisch at lexifi.com</A>&gt; wrote:
&gt;<i> On 03/05/2013 03:06 PM, Yaron Minsky wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Tue, Mar 5, 2013 at 5:10 AM, Alain Frisch &lt;<A HREF="http://lists.ocaml.org/listinfo/platform">alain.frisch at lexifi.com</A>&gt;
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>   - You need to adapt all tools (ocamldep, ocamldoc and also third party
</I>&gt;&gt;&gt;<i> tools), and this might change their interface (e.g. for ocamldoc, you
</I>&gt;&gt;&gt;<i> will
</I>&gt;&gt;&gt;<i> need to specify for each source file what's its implicit prefix).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I agree that this would have to be solved, though I think this is
</I>&gt;&gt;<i> worth doing.  You'd need some kind of lookup from the easy to find
</I>&gt;&gt;<i> file (e.g., core_list.cmi) to the hard-to-find file (list.ml).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Do you agree that this requires not only a lookup algorithm, but
</I>&gt;<i> also a way to specify to ocamldoc, file per file on its
</I>&gt;<i> command-line, which &quot;prefix&quot; to use?  At least this is required if
</I>&gt;<i> you want to allow using ocamldoc to generate a single documentation
</I>&gt;<i> for module spanning several &quot;namespaces&quot; at once.
</I>
I would think you'd need to get the information to ocamldoc, I'm not
really sure how.  I'm actually quite fond of your proposal for
ocamldoc, which is to have ocamldoc information come not from the
source but from annotations of the files that are generated by the
compilation tools.  That would presumably make this question largely
go away, since you would have named those files (cmo,cmx,cmi) uniquely
anyway.

&gt;&gt;<i> This doesn't seem like much of an issue, since you can feel free to
</I>&gt;&gt;<i> simply use unique file-names if you'd like to.  This is merely an
</I>&gt;&gt;<i> option for developers who want to organize things in this way.  In the
</I>&gt;&gt;<i> end, I think it won't matter most of the time, because I hope that as
</I>&gt;&gt;<i> we develop better build tools, they will handle this stuff
</I>&gt;&gt;<i> automatically.
</I>&gt;<i>
</I>&gt;&gt;<i> But if people want, they can name things uniquely and use simple
</I>&gt;&gt;<i> Makefiles.
</I>&gt;<i>
</I>&gt;<i> Again, I'm going to illustrate that we do crazy and non-standard stuffs
</I>&gt;<i> here, but the way we integrate third-party libraries into our project is to
</I>&gt;<i> take their source files and create an very simple OMakefile (usually 2 or 3
</I>&gt;<i> lines) to integrate them in our global tree.
</I>
Us too!

&gt;<i> I understand this is a rather uncommon scenario, but it is a useful
</I>&gt;<i> one, at least in our context because
</I>&gt;<i> (i) we want everything to be under the control of our revision system so
</I>&gt;<i> that we can very simply extract a full source tree corresponding to a
</I>&gt;<i> distributed version of our application; (ii) we regularly rebuild the whole
</I>&gt;<i> tree (e.g. as soon as we do a release, we recompile everything from sources)
</I>&gt;<i> and being able to benefit from global parallel build is nice; (iii) released
</I>&gt;<i> build specifications don't always work nicely under Windows and/or don't
</I>&gt;<i> allow to inject custom compilation flags (e.g. to enable new warnings); (iv)
</I>&gt;<i> having everything under the control of the same build system makes it easy
</I>&gt;<i> to insert debug statement in the middle of a library and recompile (only)
</I>&gt;<i> the necessary dependencies; (v) we don't use ocamlfind but recreated
</I>&gt;<i> something similar within omake, but this assumes that everything is under
</I>&gt;<i> the control of omake.
</I>
Indeed, all the same reasons apply here for us.

&gt;<i> Anyway, I'm not trying to convince anyone else that this is a good strategy,
</I>&gt;<i> only that it is currently in use in a least one non-trivial code base.  So
</I>&gt;<i> the assumption that the choice of filenames for source code is purely on the
</I>&gt;<i> developer side does not completely hold (I admit it will not be very
</I>&gt;<i> difficult to rename files upon import if we need to).
</I>
Right, and that's exactly what I would propose you would do if that's
how you want to deploy.  From my perspective, I'd like to keep the
ability to have short filenames (and therefore filename clashes), but
entirely within the kind of solution you describe.

&gt;&gt;&gt;<i>   - You can deploy compiled files for several libraries in the same
</I>&gt;&gt;&gt;<i> directory, but not the corresponding .mli files (for documentation
</I>&gt;&gt;&gt;<i> purpose).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I think this is fairly poor practice.  Directory structures are useful
</I>&gt;&gt;<i> anyway, and one might as well encourage their use.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm not claiming this is good practice in general (and I don't think we do
</I>&gt;<i> that, specifically), but people should realize that some proposals will put
</I>&gt;<i> pressure on many tools and will disallow some usage scenario currently in
</I>&gt;<i> use and which they are not even aware of.
</I>
But, if people who demand this use-case simply rename files to
explicitly include the namespace as a prefix, then aren't we
guaranteeing they can continue as they were?  The only real issue is
that they may have a little more work to import external libraries,
which seems a smallish price to pay.

&gt;<i> Just as an example, we have developed a simple IDE for OCaml code to
</I>&gt;<i> be embedded in our application; it assumes that ocamldoc has been
</I>&gt;<i> applied at once to all distributed libraries and that all the
</I>&gt;<i> resulting HTML files are in a single directory.  I guess this is a
</I>&gt;<i> rather non-standard use of ocamldoc, but it works quite well for us.
</I>&gt;<i> We will update our IDE and our use of ocamldoc if required, but when
</I>&gt;<i> evaluating the respective pros and cons of various proposals, the
</I>&gt;<i> cost of adapting all existing tools / usage scenarios should not be
</I>&gt;<i> neglected (and people have little way to know about the amount of
</I>&gt;<i> work required for those adaptations).
</I>
Again, I think my proposal allows what you want without forcing the
entire world to use painfully long filenames.

y
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000234.html">[ocaml-platform] Unique file names
</A></li>
	<LI>Next message: <A HREF="000236.html">[ocaml-platform] Unique file names
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#235">[ date ]</a>
              <a href="thread.html#235">[ thread ]</a>
              <a href="subject.html#235">[ subject ]</a>
              <a href="author.html#235">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/platform">More information about the Platform
mailing list</a><br>
</body></html>
