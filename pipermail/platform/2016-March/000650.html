<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ocaml-platform] [Caml-list] Package compilation and debug mode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:platform%40lists.ocaml.org?Subject=Re%3A%20%5Bocaml-platform%5D%20%5BCaml-list%5D%20Package%20compilation%20and%20debug%20mode&In-Reply-To=%3CCAPFanBFVZ45oKswNq-Zd%2BgzRN6n_KHv50Wjp0u%3DPTyJnFVdrXw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000649.html">
   <LINK REL="Next"  HREF="000651.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ocaml-platform] [Caml-list] Package compilation and debug mode</H1>
    <B>Gabriel Scherer</B> 
    <A HREF="mailto:platform%40lists.ocaml.org?Subject=Re%3A%20%5Bocaml-platform%5D%20%5BCaml-list%5D%20Package%20compilation%20and%20debug%20mode&In-Reply-To=%3CCAPFanBFVZ45oKswNq-Zd%2BgzRN6n_KHv50Wjp0u%3DPTyJnFVdrXw%40mail.gmail.com%3E"
       TITLE="[ocaml-platform] [Caml-list] Package compilation and debug mode">gabriel.scherer at gmail.com
       </A><BR>
    <I>Wed Mar 23 10:12:50 GMT 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="000649.html">[ocaml-platform] [Caml-list] Package compilation and debug mode
</A></li>
        <LI>Next message: <A HREF="000651.html">[ocaml-platform] [Caml-list] Package compilation and debug mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#650">[ date ]</a>
              <a href="thread.html#650">[ thread ]</a>
              <a href="subject.html#650">[ subject ]</a>
              <a href="author.html#650">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The new (4.03)
  ocaml_compiler_internal_params
mechanism might be of use here:
  OCAMLPARAM option passed using a configuration file
  <A HREF="https://github.com/ocaml/ocaml/pull/428">https://github.com/ocaml/ocaml/pull/428</A>

Note that as a software packager I would be fine fetching a %{debug}%
variable and adapt my configure/build chain to handle it. I already
have specific logic for ocaml-native and ocaml-native-tools. But I
wonder whether this approach scales to other preferences one may want
to set globally. (OCAMLPARAM is a kludge, but duplicating it inside
OPAM may not be much better.)

On Wed, Mar 23, 2016 at 11:02 AM, Thomas Gazagnaire
&lt;<A HREF="http://lists.ocaml.org/listinfo/platform">thomas at gazagnaire.org</A>&gt; wrote:
&gt;&gt;<i> By default all my packages are released with -g disabled. It seems easy enough to have an opam switch (even the official one) that automatically enables the flag.
</I>&gt;<i>
</I>&gt;<i> How do you envision such a global debug flag? As far as I know, there is no configuration-time option to enable that option in the compiler (which would be the cleaner option IMHO). I'd rather avoid using OCAMLPARAM for this. A new opam variable can be created and used in the opam file to pass the debug command (or not) explicitly to the build system, but this will require adapting all the build systems (and ideally a new release of opam, but we can work-around that by setting OPAMVAR_debug in the .comp file).
</I>&gt;<i>
</I>&gt;&gt;<i> So I think OCaml's opam repository should have a policy here. The answer should also take system package managers into account since those pull directly from the tarballs (if this document [3] is still in use for debian it seems they do require compilation with debug mode).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Personally I don't have an opinion about it, I'm rather seeking an answer here.
</I>&gt;<i>
</I>&gt;<i> I don't have a strong opinion either. I like when packages come with -g by default, but I can understand that the (small) runtime cost can be a problem for deployment scenarios.
</I>&gt;<i>
</I>&gt;<i> Thomas
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Platform mailing list
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/platform">Platform at lists.ocaml.org</A>
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/platform">http://lists.ocaml.org/listinfo/platform</A>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000649.html">[ocaml-platform] [Caml-list] Package compilation and debug mode
</A></li>
	<LI>Next message: <A HREF="000651.html">[ocaml-platform] [Caml-list] Package compilation and debug mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#650">[ date ]</a>
              <a href="thread.html#650">[ thread ]</a>
              <a href="subject.html#650">[ subject ]</a>
              <a href="author.html#650">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/platform">More information about the Platform
mailing list</a><br>
</body></html>
