<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ocaml-platform] Caching the opam repository
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:platform%40lists.ocaml.org?Subject=Re%3A%20%5Bocaml-platform%5D%20Caching%20the%20opam%20repository&In-Reply-To=%3C3295518.v8QhiaqsbM%40agaric%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000700.html">
   <LINK REL="Next"  HREF="000702.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ocaml-platform] Caching the opam repository</H1>
    <B>Louis Gesbert</B> 
    <A HREF="mailto:platform%40lists.ocaml.org?Subject=Re%3A%20%5Bocaml-platform%5D%20Caching%20the%20opam%20repository&In-Reply-To=%3C3295518.v8QhiaqsbM%40agaric%3E"
       TITLE="[ocaml-platform] Caching the opam repository">louis.gesbert at ocamlpro.com
       </A><BR>
    <I>Wed Jul  6 09:04:27 BST 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="000700.html">[ocaml-platform] Caching the opam repository
</A></li>
        <LI>Next message: <A HREF="000702.html">[ocaml-platform] Caching the opam repository
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#701">[ date ]</a>
              <a href="thread.html#701">[ thread ]</a>
              <a href="subject.html#701">[ subject ]</a>
              <a href="author.html#701">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>There is no built-in way to do this, but setting an http proxy and the proper curl/wget configuration to go through it in opam shouldn't be too difficult. Has anyone successfully set something similar up already ? If so, directions or a tutorial could be added to (or linked from) our doc pages.

Passing the option to e.g. curl could be done by setting the proper command (with the `--proxy` option) in ~/.opam/config, field `download-command:`. This would allow to have the set up proxy be used only by opam, without exporting `http_proxy`.

Then it boils down to setting a caching proxy to keep the archives. One limitation of this approach is that it won't reuse the file digests that opam already has ; while archives very rarely change, it has happened (and required an update to the hash stored in the opam repository)





&gt;<i> - Yann Salmon, 05/07/2016 20:49 -
</I>&gt;<i> Bonjour,
</I>&gt;<i> 
</I>&gt;<i> we are going to install opam and OCaml on many computers and I would
</I>&gt;<i> like to do so with as few internet downloads as possible as our
</I>&gt;<i> connection is rather slow.
</I>&gt;<i> 
</I>&gt;<i> We would also like to avoid building a whole mirror of the opam
</I>&gt;<i> repository, or even mirroring a predefined subset of it.
</I>&gt;<i> 
</I>&gt;<i> Has somebody managed to set up a solution similar to apt-cache and co ?
</I>&gt;<i> That is : the mirror expands and updates itself when a package is
</I>&gt;<i> requested from it but it cannot provide it directly.
</I>&gt;<i> 
</I>&gt;<i> 
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000700.html">[ocaml-platform] Caching the opam repository
</A></li>
	<LI>Next message: <A HREF="000702.html">[ocaml-platform] Caching the opam repository
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#701">[ date ]</a>
              <a href="thread.html#701">[ thread ]</a>
              <a href="subject.html#701">[ subject ]</a>
              <a href="author.html#701">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/platform">More information about the Platform
mailing list</a><br>
</body></html>
