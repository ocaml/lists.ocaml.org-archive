<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [wg-windows] Improving the state of OCaml on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:wg-windows%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-windows%5D%20Improving%20the%20state%20of%20OCaml%20on%20Windows&In-Reply-To=%3C556D62E6.4080805%40lexifi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000015.html">
   <LINK REL="Next"  HREF="000017.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[wg-windows] Improving the state of OCaml on Windows</H1>
    <B>Alain Frisch</B> 
    <A HREF="mailto:wg-windows%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-windows%5D%20Improving%20the%20state%20of%20OCaml%20on%20Windows&In-Reply-To=%3C556D62E6.4080805%40lexifi.com%3E"
       TITLE="[wg-windows] Improving the state of OCaml on Windows">alain.frisch at lexifi.com
       </A><BR>
    <I>Tue Jun  2 09:01:42 BST 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="000015.html">[wg-windows] Improving the state of OCaml on Windows
</A></li>
        <LI>Next message: <A HREF="000017.html">[wg-windows] Improving the state of OCaml on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16">[ date ]</a>
              <a href="thread.html#16">[ thread ]</a>
              <a href="subject.html#16">[ subject ]</a>
              <a href="author.html#16">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 06/01/2015 08:32 PM, Adrien Nader wrote:
&gt;<i> Yes, the best case would be an ocaml tool (ocamlbuild, assemblage,
</I>&gt;<i> omake, that's not the question) that does everything without relying on
</I>&gt;<i> the host posixness.
</I>&gt;<i>
</I>&gt;<i> However I do not expect this to be doable for all the cases, current or
</I>&gt;<i> future. If the build system runs mt (control magnetic tape drive
</I>&gt;<i> operation: autoconf sometimes check for it :)) through a direct command
</I>&gt;<i> invocation, then it will need a posix host. My 'mt' example was a bit
</I>&gt;<i> silly but it's very very common to see shell scripts used in build
</I>&gt;<i> system hooks. Such things will always happen. For these we will always
</I>&gt;<i> need a posix environment.
</I>
I completely agree.  But in my experience, using omake (as a native 
non-cywin application) works well even if it needs to call cygwin tools 
(e.g. &quot;zip&quot;) -- perhaps because it relies on relative paths -- and I 
expect something similar to be achievable by ocamlbuild.  I understand 
your point that jumping from cygwin realm to &quot;native&quot; back and forth is 
not ideal, but providing Cygwin + native versions of all build tools 
would also be confusing.

Do you see concrete cases where using a cygwin ocamlbuild.exe to drive 
the compilation with a native port of OCaml would be useful?


&gt;<i> As for relative paths and ocamlbuild, I'm not even sure about that but
</I>&gt;<i> paths are only a small part of the issue; maybe we could avoid that but
</I>&gt;<i> it's a never-ending fight. I would rather tell people: &quot;If it uses
</I>&gt;<i> ocamlbuild, omake, assemblage or jenga, you can build it directly;
</I>&gt;<i> otherwise you need Cygwin.&quot; and have builds for cygwin easy to setup.
</I>
Even with omake, of course it depends on what rules do.  For ocamlbuild, 
one could at least try to enforce this property when there is no custom 
myocamlbuild.ml in the project.


&gt;<i> This applies to cmd.exe but the use of cmd.exe should be banned
</I>&gt;<i> altogether. Calls to Sys.command are done with a POSIX shell in mind.
</I>&gt;<i> This is precisely why ocamlbuild depends on bash.exe from cygwin or
</I>&gt;<i> msys: to interpret posix shell command-line and escapes. Noone will
</I>&gt;<i> learn and apply the syntax rules of cmd.exe: the only solution is to
</I>&gt;<i> have APIs based on string array at the OCaml level and implement the
</I>&gt;<i> escape rules properly (Windows' CreateProcess() takes a string argument,
</I>&gt;<i> not a string array one: it's needed if not using cmd.exe).
</I>
Does one need a new API, or fix Unix.create_process and co?

Do you know why ocamlbuild uses bash instead of Unix to run external 
commands?


Alain
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000015.html">[wg-windows] Improving the state of OCaml on Windows
</A></li>
	<LI>Next message: <A HREF="000017.html">[wg-windows] Improving the state of OCaml on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16">[ date ]</a>
              <a href="thread.html#16">[ thread ]</a>
              <a href="subject.html#16">[ subject ]</a>
              <a href="author.html#16">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/wg-windows">More information about the wg-windows
mailing list</a><br>
</body></html>
