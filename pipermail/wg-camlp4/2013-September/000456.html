<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [wg-camlp4] Keeping attributes in .cmi files?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Keeping%20attributes%20in%20.cmi%20files%3F&In-Reply-To=%3C52397389.9070402%40lexifi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000455.html">
   <LINK REL="Next"  HREF="000457.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[wg-camlp4] Keeping attributes in .cmi files?</H1>
    <B>Alain Frisch</B> 
    <A HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Keeping%20attributes%20in%20.cmi%20files%3F&In-Reply-To=%3C52397389.9070402%40lexifi.com%3E"
       TITLE="[wg-camlp4] Keeping attributes in .cmi files?">alain.frisch at lexifi.com
       </A><BR>
    <I>Wed Sep 18 10:34:01 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000455.html">[wg-camlp4] parse_with_ppx [was: My no-use of camlp4 syntax extensions for Otags]
</A></li>
        <LI>Next message: <A HREF="000457.html">[wg-camlp4] [Caml-devel] Keeping attributes in .cmi files?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#456">[ date ]</a>
              <a href="thread.html#456">[ thread ]</a>
              <a href="subject.html#456">[ subject ]</a>
              <a href="author.html#456">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear all,

Attributes are currently kept in .cmt and .cmti files, which are dumps 
of the Typedtree counterparts of .ml and .mli files.  This allows 
external tools to access those attributes together with the output of 
the type-checker.  But this does not easily allow the compiler itself 
(which doesn't parse the .cmti file) to see attributes from external units.

If we keep attributes also in the internal structure of the 
type-checker, which is dumped in the .cmi file, we can make the compiler 
aware, for instance, of attributes put on value declarations.

As an example, see the following discussion about having the compiler 
report a warning when a value marked as deprecated is being used:

<A HREF="http://caml.inria.fr/mantis/view.php?id=5854">http://caml.inria.fr/mantis/view.php?id=5854</A>

Attributes give a natural way to mark values as deprecated, and as I 
suggest in the discussion, the simplest way to use this information is 
to keep it in the Types.value_description record (and thus in .cmi files).

If we start having the compiler understand some specific attributes, it 
makes sense, in my opinion, to keep them even in .cmi files (at least 
for attributes on &quot;declarations&quot;, not necessarily on type expressions). 
  Do you agree?  Would anyone object to the patch I proposed on the 
ticket above?


Alain
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000455.html">[wg-camlp4] parse_with_ppx [was: My no-use of camlp4 syntax extensions for Otags]
</A></li>
	<LI>Next message: <A HREF="000457.html">[wg-camlp4] [Caml-devel] Keeping attributes in .cmi files?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#456">[ date ]</a>
              <a href="thread.html#456">[ thread ]</a>
              <a href="subject.html#456">[ subject ]</a>
              <a href="author.html#456">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/wg-camlp4">More information about the wg-camlp4
mailing list</a><br>
</body></html>
