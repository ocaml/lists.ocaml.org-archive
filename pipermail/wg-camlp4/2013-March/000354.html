<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [wg-camlp4] Changes to the parsetree
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Changes%20to%20the%20parsetree&In-Reply-To=%3C9A9E5F6A-A828-457F-9030-4AAA88B2B8C7%40ocamlpro.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000353.html">
   <LINK REL="Next"  HREF="000355.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[wg-camlp4] Changes to the parsetree</H1>
    <B>Thomas Gazagnaire</B> 
    <A HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Changes%20to%20the%20parsetree&In-Reply-To=%3C9A9E5F6A-A828-457F-9030-4AAA88B2B8C7%40ocamlpro.com%3E"
       TITLE="[wg-camlp4] Changes to the parsetree">thomas at ocamlpro.com
       </A><BR>
    <I>Tue Mar 26 12:49:06 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000353.html">[wg-camlp4] Changes to the parsetree
</A></li>
        <LI>Next message: <A HREF="000355.html">[wg-camlp4] Changes to the parsetree
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#354">[ date ]</a>
              <a href="thread.html#354">[ thread ]</a>
              <a href="subject.html#354">[ subject ]</a>
              <a href="author.html#354">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;&gt;<i> * is the distinction between top-level items and other items really
</I>&gt;&gt;<i> necessary (eg, @ vs. @@) ? This seems to be the only &quot;complex&quot; thing
</I>&gt;&gt;<i> to explain, as the other parts of the design nicely sounds rather
</I>&gt;&gt;<i> simple.
</I>&gt;<i> 
</I>&gt;<i> Consider:
</I>&gt;<i> 
</I>&gt;<i> type t = Foo of int [@xxx]
</I>&gt;<i> 
</I>&gt;<i> val x: int [@xxx]
</I>&gt;<i> 
</I>&gt;<i> module X : S [@xxx]
</I>&gt;<i> 
</I>&gt;<i> These are attributes on (module) type expressions.  If we want to support such attributes in addition to attributes on the corresponding &quot;items&quot; (type, value, module declarations), we need a different syntax.
</I>
ok.

&gt;<i> &gt; Also I'm not sure to understand why you need/want to annotate
</I>&gt;&gt;<i> individual structure items in a recursive type declaration.
</I>&gt;<i> 
</I>&gt;<i> type t = X | Y
</I>&gt;<i>  [@@sexp]
</I>&gt;<i>  [@@doc &quot;This is the type [t], supporting s-exp.&quot;]
</I>&gt;<i> 
</I>&gt;<i> and s = A | B
</I>&gt;<i>  [@@xml]
</I>&gt;<i>  [@@doc &quot;This is the type [s], supporting xml.&quot;]
</I>
For the @@sexp and @@xml parts, you won't see that in real-codebases. Usually, all the types in a given module/file have their associated generators. But ok for the documentation.

&gt;<i> Concerning the syntax, I tend to write ocamldoc comments *after* signature items.  Since the comments often refers to parts of the definition (function parameters, constructors, etc), it makes sense to do so.  This seems to be the convention adopted in the stdlib, for instance.
</I>
A lot of existing code doesn't follow this convention (JS' core for instance). Personally, I found clearer to read what the function/type/module does in a comment, before reading its signature. 

&gt;<i> When using ocamldoc to generate doc based on implementations, not interfaces, it would indeed be more natural to put the description before the function definition.  But I don't think that ocamldoc is really used like that.  Or is it an important use case for you?
</I>
I never use ocamldoc on .ml files, so no, it's not important for me.

Thomas


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000353.html">[wg-camlp4] Changes to the parsetree
</A></li>
	<LI>Next message: <A HREF="000355.html">[wg-camlp4] Changes to the parsetree
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#354">[ date ]</a>
              <a href="thread.html#354">[ thread ]</a>
              <a href="subject.html#354">[ subject ]</a>
              <a href="author.html#354">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/wg-camlp4">More information about the wg-camlp4
mailing list</a><br>
</body></html>
