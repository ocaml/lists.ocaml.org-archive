<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [wg-camlp4] About 'a loc in the Parsetree
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20About%20%27a%20loc%20in%20the%20Parsetree&In-Reply-To=%3C515D78ED.2040705%40lexifi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000402.html">
   <LINK REL="Next"  HREF="000385.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[wg-camlp4] About 'a loc in the Parsetree</H1>
    <B>Alain Frisch</B> 
    <A HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20About%20%27a%20loc%20in%20the%20Parsetree&In-Reply-To=%3C515D78ED.2040705%40lexifi.com%3E"
       TITLE="[wg-camlp4] About 'a loc in the Parsetree">alain.frisch at lexifi.com
       </A><BR>
    <I>Thu Apr  4 13:58:21 BST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000402.html">[wg-camlp4] Extension developers: we need you!
</A></li>
        <LI>Next message: <A HREF="000385.html">[wg-camlp4] About 'a loc in the Parsetree
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#384">[ date ]</a>
              <a href="thread.html#384">[ thread ]</a>
              <a href="subject.html#384">[ subject ]</a>
              <a href="author.html#384">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear all (caml-devel + wg-camlp4),

I'd like to discuss the use of the 'a loc type (string loc and 
Longident.loc) in the definition of the Parsetree.  I think this type 
was introduced as part of the &quot;binannot&quot; project, in order to keep more 
location information in the Typedtree, to be used by external tools 
reading .cmt files.

First, some &quot;unlocated&quot; identifiers remain in the Parsetree
(cf Ptyp_var, Ptyp_alias, Ptyp_poly, Pfield, Pexp_send, Pexp_newtype, 
Pctf_val, Pctf_virt, Pctf_meth, Pcf_inher).  I assume this is simply an 
oversight. Or is there any deeper reason for keeping locations for some 
identifiers but not all of them?

Second, some locations are redundant for constructions whose syntax is 
just the identifier (Ppat_var, Pexp_ident, Pmty_ident, Pmod_ident).  The 
same location is store in the 'a loc record and in pexp_loc/ppat_loc/etc 
field.  I guess that the rationale is that some imaginary alternative 
concrete syntax for the language would use a different representation 
for those constructions.  Another argument is uniformity of 
representation.  But those redundant location introduce some overhead 
when building and deconstructing very common fragments of Parsetrees. 
For building fragments, this can be largely accommodated by the use of 
constructor functions, but for pattern matching on AST, there is no such 
easy solution.  One could consider getting rid of those redundant &quot;'a 
loc&quot; wrappers.  Any opinion on this topic?


Alain

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000402.html">[wg-camlp4] Extension developers: we need you!
</A></li>
	<LI>Next message: <A HREF="000385.html">[wg-camlp4] About 'a loc in the Parsetree
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#384">[ date ]</a>
              <a href="thread.html#384">[ thread ]</a>
              <a href="subject.html#384">[ subject ]</a>
              <a href="author.html#384">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/wg-camlp4">More information about the wg-camlp4
mailing list</a><br>
</body></html>
