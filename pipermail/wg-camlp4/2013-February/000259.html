<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [wg-camlp4] Pending issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Pending%20issues&In-Reply-To=%3C20130213131541.4e88a9a5%40ocamlpro.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000258.html">
   <LINK REL="Next"  HREF="000261.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[wg-camlp4] Pending issues</H1>
    <B>Pierre Chambart</B> 
    <A HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Pending%20issues&In-Reply-To=%3C20130213131541.4e88a9a5%40ocamlpro.com%3E"
       TITLE="[wg-camlp4] Pending issues">pierre.chambart at ocamlpro.com
       </A><BR>
    <I>Wed Feb 13 12:15:41 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000258.html">[wg-camlp4] Pending issues
</A></li>
        <LI>Next message: <A HREF="000261.html">[wg-camlp4] Pending issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#259">[ date ]</a>
              <a href="thread.html#259">[ thread ]</a>
              <a href="subject.html#259">[ subject ]</a>
              <a href="author.html#259">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Le 13 Feb 2013 12:06:12 +0000,
Leo White &lt;<A HREF="http://lists.ocaml.org/listinfo/wg-camlp4">lpw25 at cam.ac.uk</A>&gt; a &#233;crit :

&gt;<i> &gt;&gt; A related question is related to the current work on runtime
</I>&gt;<i> &gt;&gt; types. Attributes on type declarations could be kept in the
</I>&gt;<i> &gt;&gt; runtime representation of the declarations, allowing libraries to
</I>&gt;<i> &gt;&gt; interpret them as they want.  (LexiFi's version of OCaml has been
</I>&gt;<i> &gt;&gt; extended with attributes on type declarations precisely to do
</I>&gt;<i> &gt;&gt; that.)  Having attributes defined as general expressions, however,
</I>&gt;<i> &gt;&gt; means that those libraries would need to link with compiler-libs,
</I>&gt;<i> &gt;&gt; or at least be compiled against some of its .cmi, in order to be
</I>&gt;<i> &gt;&gt; able to analyze the Parsetree. I don't see it is as a big problem,
</I>&gt;<i> &gt;&gt; and it would also be possible to restrict which expressions are
</I>&gt;<i> &gt;&gt; reflected in runtime types (e.g. to structured constants).
</I>&gt;<i> &gt;&gt; Comments are welcome!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;I think it is usualy a bad idea to need to link against
</I>&gt;<i> &gt;compiler-libs. Doing so almost certainly prevent you from being able
</I>&gt;<i> &gt;to compile against different version of the compiler. This ast
</I>&gt;<i> &gt;should be fixed once and be provided in the stdlib. I would also
</I>&gt;<i> &gt;prefer to restrict that kind of annotation to a small subset of the
</I>&gt;<i> &gt;expression language avoiding as much as possible duplication. This
</I>&gt;<i> &gt;would simplify the code using those annotations. Maybe only list,
</I>&gt;<i> &gt;Variant, record and string literals/identifiers would be sufficient.
</I>&gt;<i> &gt;Maybe also let in ?
</I>&gt;<i> 
</I>&gt;<i> I agree that we should avoid making people link against compiler-libs
</I>&gt;<i> where possible. However, I think that having a fixed AST and only
</I>&gt;<i> supporting a subset is too restrictive.
</I>&gt;<i> 
</I>&gt;<i> An alternative would be to provide a standard library module that
</I>&gt;<i> could be used to handle simple ASTs, but still support using
</I>&gt;<i> Parsetree directly for more complicated AST handling.
</I>&gt;<i> 
</I>&gt;<i> For example the &quot;Ast&quot; module might provide functions like:
</I>&gt;<i> 
</I>&gt;<i> getIdent: Ast.expression -&gt; string option
</I>&gt;<i> 
</I>&gt;<i> which would return a string of an identifier if the expression was a
</I>&gt;<i> simple identifier.
</I>&gt;<i> 
</I>&gt;<i> This way we don't restrict changes to Parsetree, or the possible 
</I>&gt;<i> expressions within an attribute, but we do allow people to get basic 
</I>&gt;<i> information out of an expression without linking against
</I>&gt;<i> compiler-libs.
</I>
I understand the need for accessing annotation at runtime, but why
whould anyone reasonnable want something else than simple declarative
informations, for which a simple substet is enouth. And restricting
as much as possible this make the usage far easier: this kind of value
won't be manipulated by 'experts' writing syntax extensions, but by
classical users. Moreover, if the ast you are manipulating is the full
ocaml one, it will be impossible to write exhaustive pattern matching
without breaking at each new ocaml release.

-- 
Pierre
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.ocaml.org/pipermail/wg-camlp4/attachments/20130213/e70ed3d6/attachment.sig">http://lists.ocaml.org/pipermail/wg-camlp4/attachments/20130213/e70ed3d6/attachment.sig</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000258.html">[wg-camlp4] Pending issues
</A></li>
	<LI>Next message: <A HREF="000261.html">[wg-camlp4] Pending issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#259">[ date ]</a>
              <a href="thread.html#259">[ thread ]</a>
              <a href="subject.html#259">[ subject ]</a>
              <a href="author.html#259">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/wg-camlp4">More information about the wg-camlp4
mailing list</a><br>
</body></html>
