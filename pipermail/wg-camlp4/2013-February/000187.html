<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [wg-camlp4] Structured comments,	shallow embeddings and deep quasiquotations
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Structured%20comments%2C%0A%09shallow%20embeddings%20and%20deep%20quasiquotations&In-Reply-To=%3CPrayer.1.3.5.1302021925001.337%40hermes-1.csi.cam.ac.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000186.html">
   <LINK REL="Next"  HREF="000188.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[wg-camlp4] Structured comments,	shallow embeddings and deep quasiquotations</H1>
    <B>Leo White</B> 
    <A HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Structured%20comments%2C%0A%09shallow%20embeddings%20and%20deep%20quasiquotations&In-Reply-To=%3CPrayer.1.3.5.1302021925001.337%40hermes-1.csi.cam.ac.uk%3E"
       TITLE="[wg-camlp4] Structured comments,	shallow embeddings and deep quasiquotations">lpw25 at cam.ac.uk
       </A><BR>
    <I>Sat Feb  2 19:25:00 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000186.html">[wg-camlp4] Structured comments,	shallow embeddings and deep quasiquotations
</A></li>
        <LI>Next message: <A HREF="000188.html">[wg-camlp4] Structured comments,	shallow embeddings and deep quasiquotations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#187">[ date ]</a>
              <a href="thread.html#187">[ thread ]</a>
              <a href="subject.html#187">[ subject ]</a>
              <a href="author.html#187">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>   (@deriving [&quot;sexp&quot;; &quot;json&quot;])
</I>&gt;<i>   type t = F of int | G of s
</I>&gt;<i>    and s = H of (t * t)
</I>&gt;<i>
</I>&gt;<i>or
</I>&gt;<i>
</I>&gt;<i>    (@perform)
</I>&gt;<i>       (x &lt;-- m;
</I>&gt;<i>        y &lt;-- n;
</I>&gt;<i>        return (x y))
</I>&gt;<i>
</I>&gt;<i>In order for this to be valid code, 'deriving' and 'perform' should
</I>&gt;<i>resolve to functions of appropriate types:
</I>&gt;<i>
</I>&gt;<i>    val deriving : string list -&gt; Parsetree.structure_item -&gt;
</I>&gt;<i>Parsetree.structure_item
</I>&gt;<i>
</I>&gt;<i>    val perform : Parsetree.expression -&gt; Parsetree.expression
</I>&gt;<i>
</I>
I have a broader proposal that is along these lines, which is intended to 
be the second part of my earlier blog post. There are in general some 
difficulties with just calling functions during parsing, but I think the 
general idea of declared extensions is the right way to do things.

The reason I haven't mentioned this proposal yet, is that it is a more long 
term proposal. We can easily implement the changes needed to support ppx 
before the next OCaml release. Whereas full support for declared extensions 
will require more time, and probably a lot more debate before it can be 
included.

Since moving an extension from ppx to some kind of declared mechanism would 
require only minimal work, I see no harm in promoting ppx in the 
short/medium term, while also developing a more complete solution.

In particular I think that the extension/template syntaxes ( &quot;(: lid 
expr)&quot;, &quot;{: lid { string }}&quot;, etc.) that have been discussed so far will be 
a very good match for a declaration based mechanism. It is also another 
argument for forcing extensions to have names.

I will try to put my own proposals in that blog post early next week.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000186.html">[wg-camlp4] Structured comments,	shallow embeddings and deep quasiquotations
</A></li>
	<LI>Next message: <A HREF="000188.html">[wg-camlp4] Structured comments,	shallow embeddings and deep quasiquotations
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#187">[ date ]</a>
              <a href="thread.html#187">[ thread ]</a>
              <a href="subject.html#187">[ subject ]</a>
              <a href="author.html#187">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/wg-camlp4">More information about the wg-camlp4
mailing list</a><br>
</body></html>
