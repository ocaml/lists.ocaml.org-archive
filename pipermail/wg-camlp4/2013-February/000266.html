<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [wg-camlp4] Pending issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Pending%20issues&In-Reply-To=%3CCANcqPu4LeQaebtnm2V4iunGajVSgpigLkUa29cq4bw8UK6DQ6w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000265.html">
   <LINK REL="Next"  HREF="000267.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[wg-camlp4] Pending issues</H1>
    <B>Hongbo Zhang</B> 
    <A HREF="mailto:wg-camlp4%40lists.ocaml.org?Subject=Re%3A%20%5Bwg-camlp4%5D%20Pending%20issues&In-Reply-To=%3CCANcqPu4LeQaebtnm2V4iunGajVSgpigLkUa29cq4bw8UK6DQ6w%40mail.gmail.com%3E"
       TITLE="[wg-camlp4] Pending issues">hongboz at seas.upenn.edu
       </A><BR>
    <I>Thu Feb 14 13:50:27 GMT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000265.html">[wg-camlp4] Pending issues
</A></li>
        <LI>Next message: <A HREF="000267.html">[wg-camlp4] My no-use of camlp4 syntax extensions for Otags
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#266">[ date ]</a>
              <a href="thread.html#266">[ thread ]</a>
              <a href="subject.html#266">[ subject ]</a>
              <a href="author.html#266">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Feb 14, 2013 at 6:48 AM, Wojciech Meyer &lt;<A HREF="http://lists.ocaml.org/listinfo/wg-camlp4">wojciech.meyer at gmail.com</A>&gt;wrote:

&gt;<i> Another way of providing these simple asts would be to treat any
</I>&gt;<i> flavor of variants uniformly and then in the end transform it back to
</I>&gt;<i> what was expected (only if it's needed).
</I>&gt;<i>
</I>&gt;<i> (I don't know if that what wasn't originally proposed by Pierre).
</I>&gt;<i>
</I>&gt;<i> So regardless if it's a polymorphic variant, GADT, or plain data type,
</I>&gt;<i> we would have one AST - the common denominator and what matters of
</I>&gt;<i> these is usually the tag name and general signature. Once we have that
</I>&gt;<i> we will match from that simple AST our type driven plugin that will
</I>&gt;<i> generate JSON, XML, visitors. etc The idea is to have something that
</I>&gt;<i> is good enough and reflects general structure to get rid of
</I>&gt;<i> complicated parse tree or/and quotations on the LHS and/or factor out
</I>&gt;<i> the common pattern matchers using some meta object.
</I>&gt;<i>
</I>&gt;<i> We could go even further and generate all the bolier plate pattern
</I>&gt;<i> matchers via visitor pattern by default, of course it needs to be
</I>&gt;<i> thought - but the idea is to not look at types at all - now it turns
</I>&gt;<i> to be it's already a meta-meta programming.
</I>&gt;<i>
</I>&gt;<i> That's how ast works in Fan, constructor names are not associated with
</I>type at
all.
So, suppose you have a function
sem_of_list, it works for all syntax categories, in Camlp4 you need to
write sem_of_list_ctyp, sem_of_list_expr,.....

Second, no dependency, in Fan, you can write tons of libraries for Fan
without depending on Fan, since Fan adopts polymorphic variants, you don't
have to fix its type in the first place. There is a nice application here:
reflection or runtime types generated by Fan. For each compilation unit,
for example, a.ml, Fan can inject a value in the module A, called
repr_of_a, which stores the ast as a runtime value(there is a subtle
difference here, it's a runtime value), which means you can program it in
vanilla ocaml without marshalling or demarshalling

Third, subtyping, you can pick a subset of the ast you want to process,
while reuse most of existing Fan's utilities. The contract is detected at
compile time.




&gt;<i> On Wed, Feb 13, 2013 at 5:56 PM, Leo White &lt;<A HREF="http://lists.ocaml.org/listinfo/wg-camlp4">lpw25 at cam.ac.uk</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; What I was thinking of whas that a ppx rewriter could get whatever
</I>&gt;<i> &gt;&gt; expression as attributes, but what remains after applying all rewriters
</I>&gt;<i> &gt;&gt; must be included in a subset that could map to a type like (maybe a bit
</I>&gt;<i> &gt;&gt; too restricitve)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; type expr =
</I>&gt;<i> &gt;&gt;  | List of expr list
</I>&gt;<i> &gt;&gt;  | Sum of string * expr
</I>&gt;<i> &gt;&gt;  | Cst of string
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This interface can be provided by:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ------
</I>&gt;<i> &gt;  (* Ast.mli *)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  type expr
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  type simple_expr =  | List of expr list
</I>&gt;<i> &gt;  | Sum of string * simple_expr
</I>&gt;<i> &gt;  | Cst of string
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  val simplify_expr: expr -&gt; simple_expr
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ------
</I>&gt;<i> &gt;  (* Ast.ml *)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  type expr = Parsetree.expression
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  type simple_expr =
</I>&gt;<i> &gt;  | List of expr list
</I>&gt;<i> &gt;  | Sum of string * simple_expr
</I>&gt;<i> &gt;  | Cst of string
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  let simplify_expr expr = ...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ------
</I>&gt;<i> &gt;  (* Parsetree.mli *)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  type expression = ...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  val of_ast_expr: Ast.expr -&gt; expression
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ------
</I>&gt;<i> &gt;  (* Parsetree.ml *)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  type expression = ...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  external of_ast_expr: Ast.expr -&gt; expression = &quot;%identity&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ------
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This would allow users to use the fixed simple interface, or the full
</I>&gt;<i> &gt; parsetree interface.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; wg-camlp4 mailing list
</I>&gt;<i> &gt; <A HREF="http://lists.ocaml.org/listinfo/wg-camlp4">wg-camlp4 at lists.ocaml.org</A>
</I>&gt;<i> &gt; <A HREF="http://lists.ocaml.org/listinfo/wg-camlp4">http://lists.ocaml.org/listinfo/wg-camlp4</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> wg-camlp4 mailing list
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/wg-camlp4">wg-camlp4 at lists.ocaml.org</A>
</I>&gt;<i> <A HREF="http://lists.ocaml.org/listinfo/wg-camlp4">http://lists.ocaml.org/listinfo/wg-camlp4</A>
</I>&gt;<i>
</I>


-- 
-- Regards, Hongbo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.ocaml.org/pipermail/wg-camlp4/attachments/20130214/29ea98d2/attachment.html">http://lists.ocaml.org/pipermail/wg-camlp4/attachments/20130214/29ea98d2/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000265.html">[wg-camlp4] Pending issues
</A></li>
	<LI>Next message: <A HREF="000267.html">[wg-camlp4] My no-use of camlp4 syntax extensions for Otags
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#266">[ date ]</a>
              <a href="thread.html#266">[ thread ]</a>
              <a href="subject.html#266">[ subject ]</a>
              <a href="author.html#266">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ocaml.org/listinfo/wg-camlp4">More information about the wg-camlp4
mailing list</a><br>
</body></html>
