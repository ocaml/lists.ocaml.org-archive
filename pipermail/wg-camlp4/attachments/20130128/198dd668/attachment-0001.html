<tt>
3&nbsp;parsers&nbsp;actually.&lt;div&gt;The&nbsp;original&nbsp;parser,&nbsp;the&nbsp;parser&nbsp;to&nbsp;patt,&nbsp;the&nbsp;parser&nbsp;to&nbsp;expr.&lt;/div&gt;&lt;div&gt;Besides,&nbsp;every&nbsp;user&nbsp;has&nbsp;to&nbsp;maintain&nbsp;3&nbsp;parsers&nbsp;if&nbsp;they&nbsp;want&nbsp;to&nbsp;use&nbsp;the&nbsp;quotation,&nbsp;not&nbsp;only&nbsp;the&nbsp;compiler&nbsp;maintainer. &lt;/div&gt;&lt;div&gt;I&nbsp;would&nbsp;be&nbsp;happy&nbsp;to&nbsp;see&nbsp;a&nbsp;prototype&nbsp;work&nbsp;before&nbsp;other&nbsp;changes&lt;br&gt;<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Jan&nbsp;28,&nbsp;2013&nbsp;at&nbsp;1:25&nbsp;PM,&nbsp;Leo&nbsp;White&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:lpw25@cam.ac.uk&quot;&nbsp;target=&quot;_blank&quot;&gt;lpw25@cam.ac.uk&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
I&nbsp;suggest&nbsp;that&nbsp;you&nbsp;might&nbsp;think&nbsp;twice&nbsp;before&nbsp;you&nbsp;think&nbsp;it&#39;s&nbsp;a&nbsp;viable&nbsp;option&lt;br&gt;<br>
---------------------------&lt;br&gt;&lt;/div&gt;<br>
2.&nbsp;*Copy&nbsp;and&nbsp;paste,&nbsp;creating&nbsp;two&nbsp;new&nbsp;versions&nbsp;of&nbsp;the&nbsp;parser.&nbsp;*One&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
version&nbsp;will&nbsp;directly&nbsp;return&nbsp;Haskell&nbsp;abstract&nbsp;syntax&nbsp;for&nbsp;a&nbsp;Haskell&lt;br&gt;<br>
pattern,&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;return&nbsp;Haskell&nbsp;abstract&nbsp;syntax&nbsp;for&nbsp;an&lt;br&gt;<br>
expression.&lt;br&gt;&lt;/div&gt;<br>
*This&nbsp;is&nbsp;potentially&nbsp;a&nbsp;maintenance&nbsp;nightmare.*&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
This&nbsp;part&nbsp;is&nbsp;referring&nbsp;to&nbsp;needing&nbsp;two&nbsp;parsing&nbsp;functions:&nbsp;one&nbsp;for&nbsp;the&nbsp;when&nbsp;the&nbsp;quotation&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;pattern&nbsp;and&nbsp;one&nbsp;for&nbsp;when&nbsp;it&nbsp;is&nbsp;used&nbsp;as&nbsp;an&nbsp;expression.&nbsp;I&nbsp;don&#39;t&nbsp;think&nbsp;that&nbsp;needing&nbsp;two&nbsp;parsing&nbsp;functions&nbsp;is&nbsp;really&nbsp;a&nbsp;&quot;maintenance&nbsp;nightmare&quot;.&nbsp;Also,&nbsp;with&nbsp;GADTs&nbsp;they&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;two&nbsp;separate&nbsp;functions&nbsp;anyway.&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Furthermore,&nbsp;we&nbsp;lose&nbsp;a&nbsp;lot&nbsp;of&nbsp;the&nbsp;beneﬁts&nbsp;of&nbsp;the&nbsp;type&nbsp;checker:&lt;br&gt;<br>
a&nbsp;value&nbsp;of&nbsp;type&nbsp;TH.ExpQ&nbsp;is&nbsp;Haskell&nbsp;abstract&nbsp;syntax&nbsp;for&nbsp;an&lt;br&gt;<br>
expression,&nbsp;but&nbsp;knowing&nbsp;this&nbsp;tells&nbsp;us&nbsp;nothing&nbsp;about&nbsp;the&nbsp;type&nbsp;of&lt;br&gt;<br>
the&nbsp;Haskell&nbsp;expression&nbsp;represented&nbsp;by&nbsp;the&nbsp;abstract&nbsp;syntax.&nbsp;This&lt;br&gt;<br>
expression&nbsp;could&nbsp;be&nbsp;an&nbsp;Integer,&nbsp;a&nbsp;String&nbsp;or&nbsp;have&nbsp;any&nbsp;other&lt;br&gt;<br>
type—we&nbsp;know&nbsp;only&nbsp;that&nbsp;it&nbsp;is&nbsp;syntactically&nbsp;correct,&nbsp;not&nbsp;that&nbsp;it&nbsp;is&lt;br&gt;<br>
type&nbsp;correct.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
This&nbsp;is&nbsp;a&nbsp;fair&nbsp;criticism:&nbsp;parsing&nbsp;to&nbsp;a&nbsp;value&nbsp;and&nbsp;then&nbsp;converting&nbsp;that&nbsp;into&nbsp;an&nbsp;AST&nbsp;fragment&nbsp;may&nbsp;catch&nbsp;some&nbsp;potential&nbsp;errors&nbsp;in&nbsp;a&nbsp;parser.&nbsp;However,&nbsp;this&nbsp;safety&nbsp;could&nbsp;also&nbsp;be&nbsp;obtained&nbsp;by&nbsp;creating&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;AST&nbsp;in&nbsp;parallel,&nbsp;and&nbsp;simply&nbsp;discarding&nbsp;the&nbsp;data&nbsp;structure&nbsp;when&nbsp;parsing&nbsp;is&nbsp;finished.&nbsp;This&nbsp;may&nbsp;not&nbsp;be&nbsp;as&nbsp;&quot;neat&quot;&nbsp;as&nbsp;deriving&nbsp;the&nbsp;AST&nbsp;from&nbsp;the&nbsp;value,&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;requires&nbsp;no&nbsp;special&nbsp;support.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;--&nbsp;Regards,&nbsp;Hongbo<br>
&lt;/div&gt;<br>

</tt>
